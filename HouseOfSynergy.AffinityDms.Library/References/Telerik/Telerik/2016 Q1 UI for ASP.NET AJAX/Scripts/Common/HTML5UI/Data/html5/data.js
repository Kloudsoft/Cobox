(function(b,a,e){var d=window.jQuery,c=window.$;
window.$=window.jQuery=a;
(function(g,f,j){var i=window.jQuery,h=window.$;
window.$=window.jQuery=f;
(function(l,k){k("kendo.data",["kendo.core","kendo.data.odata","kendo.data.xml"],l);
}(function(){var k={id:"data",name:"Data source",category:"framework",description:"Powerful component for using local and remote data.Fully supports CRUD, Sorting, Paging, Filtering, Grouping, and Aggregates.",depends:["core"],features:[{id:"data-odata",name:"OData",description:"Support for accessing Open Data Protocol (OData) services.",depends:["data.odata"]},{id:"data-signalr",name:"SignalR",description:"Support for binding to SignalR hubs.",depends:["data.signalr"]},{id:"data-XML",name:"XML",description:"Support for binding to XML.",depends:["data.xml"]}]};
(function(l,ba){var N=l.extend,aM=l.proxy,al=l.isPlainObject,ai=l.isEmptyObject,ag=l.isArray,W=l.grep,m=l.ajax,aq,I=l.each,ax=l.noop,an=window.kendo,aj=an.isFunction,aE=an.Observable,s=an.Class,a4="string",R="function",A="create",aQ="read",bc="update",H="destroy",r="change",a6="sync",T="get",L="error",aX="requestStart",aL="progress",aW="requestEnd",B=[A,aQ,bc,H],Z=function(bf){return bf;
},V=an.getter,a5=an.stringify,ar=Math,aN=[].push,am=[].join,aK=[].pop,a1=[].splice,aZ=[].shift,a0=[].slice,bb=[].unshift,a8={}.toString,a3=an.support.stableSort,F=/^\/Date\((.*?)\)\/$/,av=/(\r+|\n+)/g,aP=/(?=['\\])/g;
var aF=aE.extend({init:function(bf,bh){var bg=this;
bg.type=bh||aG;
aE.fn.init.call(bg);
bg.length=bf.length;
bg.wrapAll(bf,bg);
},at:function(bf){return this[bf];
},toJSON:function(){var bf,bh=this.length,bi,bg=new Array(bh);
for(bf=0;
bf<bh;
bf++){bi=this[bf];
if(bi instanceof aG){bi=bi.toJSON();
}bg[bf]=bi;
}return bg;
},parent:ax,wrapAll:function(bi,bj){var bk=this,bf,bg,bh=function(){return bk;
};
bj=bj||[];
for(bf=0,bg=bi.length;
bf<bg;
bf++){bj[bf]=bk.wrap(bi[bf],bh);
}return bj;
},wrap:function(bf,bh){var bi=this,bg;
if(bf!==null&&a8.call(bf)==="[object Object]"){bg=bf instanceof bi.type||bf instanceof au;
if(!bg){bf=bf instanceof aG?bf.toJSON():bf;
bf=new bi.type(bf);
}bf.parent=bh;
bf.bind(r,function(bj){bi.trigger(r,{field:bj.field,node:bj.node,index:bj.index,items:bj.items||[this],action:bj.node?bj.action||"itemloaded":"itemchange"});
});
}return bf;
},push:function(){var bf=this.length,bg=this.wrapAll(arguments),bh;
bh=aN.apply(this,bg);
this.trigger(r,{action:"add",index:bf,items:bg});
return bh;
},slice:a0,sort:[].sort,join:am,pop:function(){var bf=this.length,bg=aK.apply(this);
if(bf){this.trigger(r,{action:"remove",index:bf-1,items:[bg]});
}return bg;
},splice:function(bh,bf,bi){var bj=this.wrapAll(a0.call(arguments,2)),bl,bg,bk;
bl=a1.apply(this,[bh,bf].concat(bj));
if(bl.length){this.trigger(r,{action:"remove",index:bh,items:bl});
for(bg=0,bk=bl.length;
bg<bk;
bg++){if(bl[bg]&&bl[bg].children){bl[bg].unbind(r);
}}}if(bi){this.trigger(r,{action:"add",index:bh,items:bj});
}return bl;
},shift:function(){var bf=this.length,bg=aZ.apply(this);
if(bf){this.trigger(r,{action:"remove",index:0,items:[bg]});
}return bg;
},unshift:function(){var bf=this.wrapAll(arguments),bg;
bg=bb.apply(this,bf);
this.trigger(r,{action:"add",index:0,items:bf});
return bg;
},indexOf:function(bg){var bi=this,bf,bh;
for(bf=0,bh=bi.length;
bf<bh;
bf++){if(bi[bf]===bg){return bf;
}}return -1;
},forEach:function(bf){var bg=0,bh=this.length;
for(;
bg<bh;
bg++){bf(this[bg],bg,this);
}},map:function(bf){var bg=0,bi=[],bh=this.length;
for(;
bg<bh;
bg++){bi[bg]=bf(this[bg],bg,this);
}return bi;
},reduce:function(bf){var bg=0,bi,bh=this.length;
if(arguments.length==2){bi=arguments[1];
}else{if(bg<bh){bi=this[bg++];
}}for(;
bg<bh;
bg++){bi=bf(bi,this[bg],bg,this);
}return bi;
},reduceRight:function(bf){var bg=this.length-1,bh;
if(arguments.length==2){bh=arguments[1];
}else{if(bg>0){bh=this[bg--];
}}for(;
bg>=0;
bg--){bh=bf(bh,this[bg],bg,this);
}return bh;
},filter:function(bf){var bg=0,bj=[],bh,bi=this.length;
for(;
bg<bi;
bg++){bh=this[bg];
if(bf(bh,bg,this)){bj[bj.length]=bh;
}}return bj;
},find:function(bf){var bg=0,bh,bi=this.length;
for(;
bg<bi;
bg++){bh=this[bg];
if(bf(bh,bg,this)){return bh;
}}},every:function(bf){var bg=0,bh,bi=this.length;
for(;
bg<bi;
bg++){bh=this[bg];
if(!bf(bh,bg,this)){return false;
}}return true;
},some:function(bf){var bg=0,bh,bi=this.length;
for(;
bg<bi;
bg++){bh=this[bg];
if(bf(bh,bg,this)){return true;
}}return false;
},remove:function(bg){var bf=this.indexOf(bg);
if(bf!==-1){this.splice(bf,1);
}},empty:function(){this.splice(0,this.length);
}});
var ao=aF.extend({init:function(bf,bh){aE.fn.init.call(this);
this.type=bh||aG;
for(var bg=0;
bg<bf.length;
bg++){this[bg]=bf[bg];
}this.length=bg;
this._parent=aM(function(){return this;
},this);
},at:function(bf){var bg=this[bf];
if(!(bg instanceof this.type)){bg=this[bf]=this.wrap(bg,this._parent);
}else{bg.parent=this._parent;
}return bg;
}});
function M(bf,bi,bg,bh){return function(bj){var bk={},bl;
for(bl in bj){bk[bl]=bj[bl];
}if(bh){bk.field=bg+"."+bj.field;
}else{bk.field=bg;
}if(bi==r&&bf._notifyChange){bf._notifyChange(bk);
}bf.trigger(bi,bk);
};
}var aG=aE.extend({init:function(bj){var bi=this,bg,bf,bh=function(){return bi;
};
aE.fn.init.call(this);
this._handlers={};
for(bf in bj){bg=bj[bf];
if(typeof bg==="object"&&bg&&!bg.getTime&&bf.charAt(0)!="_"){bg=bi.wrap(bg,bf,bh);
}bi[bf]=bg;
}bi.uid=an.guid();
},shouldSerialize:function(bf){return this.hasOwnProperty(bf)&&bf!=="_handlers"&&bf!=="_events"&&typeof this[bf]!==R&&bf!=="uid";
},forEach:function(bf){for(var bg in this){if(this.shouldSerialize(bg)){bf(this[bg],bg);
}}},toJSON:function(){var bg={},bh,bf;
for(bf in this){if(this.shouldSerialize(bf)){bh=this[bf];
if(bh instanceof aG||bh instanceof aF){bh=bh.toJSON();
}bg[bf]=bh;
}}return bg;
},get:function(bf){var bh=this,bg;
bh.trigger(T,{field:bf});
if(bf==="this"){bg=bh;
}else{bg=an.getter(bf,true)(bh);
}return bg;
},_set:function(bg,bl){var bk=this;
var bf=bg.indexOf(".")>=0;
if(bf){var bj=bg.split("."),bi="";
while(bj.length>1){bi+=bj.shift();
var bh=an.getter(bi,true)(bk);
if(bh instanceof aG){bh.set(bj.join("."),bl);
return bf;
}bi+=".";
}}an.setter(bg)(bk,bl);
return bf;
},set:function(bh,bk){var bj=this,bi=false,bf=bh.indexOf(".")>=0,bg=an.getter(bh,true)(bj);
if(bg!==bk){if(bg instanceof aE&&this._handlers[bh]){if(this._handlers[bh].get){bg.unbind(T,this._handlers[bh].get);
}bg.unbind(r,this._handlers[bh].change);
}bi=bj.trigger("set",{field:bh,value:bk});
if(!bi){if(!bf){bk=bj.wrap(bk,bh,function(){return bj;
});
}if(!bj._set(bh,bk)||bh.indexOf("(")>=0||bh.indexOf("[")>=0){bj.trigger(r,{field:bh});
}}}return bi;
},parent:ax,wrap:function(bk,bg,bl){var bm=this;
var bh;
var bf;
var bn=a8.call(bk);
if(bk!=null&&(bn==="[object Object]"||bn==="[object Array]")){var bj=bk instanceof aF;
var bi=bk instanceof E;
if(bn==="[object Object]"&&!bi&&!bj){if(!(bk instanceof aG)){bk=new aG(bk);
}bh=M(bm,T,bg,true);
bk.bind(T,bh);
bf=M(bm,r,bg,true);
bk.bind(r,bf);
bm._handlers[bg]={get:bh,change:bf};
}else{if(bn==="[object Array]"||bj||bi){if(!bj&&!bi){bk=new aF(bk);
}bf=M(bm,r,bg,false);
bk.bind(r,bf);
bm._handlers[bg]={change:bf};
}}bk.parent=bl;
}return bk;
}});
function K(bg,bi){if(bg===bi){return true;
}var bh=l.type(bg),bj=l.type(bi),bf;
if(bh!==bj){return false;
}if(bh==="date"){return bg.getTime()===bi.getTime();
}if(bh!=="object"&&bh!=="array"){return false;
}for(bf in bg){if(!K(bg[bf],bi[bf])){return false;
}}return true;
}var aJ={number:function(bf){return an.parseFloat(bf);
},date:function(bf){return an.parseDate(bf);
},"boolean":function(bf){if(typeof bf===a4){return bf.toLowerCase()==="true";
}return bf!=null?!!bf:bf;
},string:function(bf){return bf!=null?bf+"":bf;
},"default":function(bf){return bf;
}};
var G={string:"",number:0,date:new Date(),"boolean":false,"default":""};
function U(bi,bh){var bf,bg;
for(bg in bi){bf=bi[bg];
if(al(bf)&&bf.field&&bf.field===bh){return bf;
}else{if(bf===bh){return bf;
}}}return null;
}var au=aG.extend({init:function(bf){var bi=this;
if(!bf||l.isEmptyObject(bf)){bf=l.extend({},bi.defaults,bf);
if(bi._initializers){for(var bg=0;
bg<bi._initializers.length;
bg++){var bh=bi._initializers[bg];
bf[bh]=bi.defaults[bh]();
}}}aG.fn.init.call(bi,bf);
bi.dirty=false;
if(bi.idField){bi.id=bi.get(bi.idField);
if(bi.id===ba){bi.id=bi._defaultId;
}}},shouldSerialize:function(bf){return aG.fn.shouldSerialize.call(this,bf)&&bf!=="uid"&&!(this.idField!=="id"&&bf==="id")&&bf!=="dirty"&&bf!=="_accessors";
},_parse:function(bf,bk){var bj=this,bg=bf,bh=bj.fields||{},bi;
bf=bh[bf];
if(!bf){bf=U(bh,bg);
}if(bf){bi=bf.parse;
if(!bi&&bf.type){bi=aJ[bf.type.toLowerCase()];
}}return bi?bi(bk):bk;
},_notifyChange:function(bg){var bf=bg.action;
if(bf=="add"||bf=="remove"){this.dirty=true;
}},editable:function(bf){bf=(this.fields||{})[bf];
return bf?bf.editable!==false:true;
},set:function(bg,bj,bh){var bi=this;
var bf=bi.dirty;
if(bi.editable(bg)){bj=bi._parse(bg,bj);
if(!K(bj,bi.get(bg))){bi.dirty=true;
if(aG.fn.set.call(bi,bg,bj,bh)&&!bf){bi.dirty=bf;
}}}},accept:function(bf){var bi=this,bh=function(){return bi;
},bg;
for(bg in bf){var bj=bf[bg];
if(bg.charAt(0)!="_"){bj=bi.wrap(bf[bg],bg,bh);
}bi._set(bg,bj);
}if(bi.idField){bi.id=bi.get(bi.idField);
}bi.dirty=false;
},isNew:function(){return this.id===this._defaultId;
}});
au.define=function(bf,bo){if(bo===ba){bo=bf;
bf=au;
}var bm,bq=N({defaults:{}},bo),bn,bg,br,bs,bk,bl,bh={},bp,bj=bq.id,bi=[];
if(bj){bq.idField=bj;
}if(bq.id){delete bq.id;
}if(bj){bq.defaults[bj]=bq._defaultId="";
}if(a8.call(bq.fields)==="[object Array]"){for(bk=0,bl=bq.fields.length;
bk<bl;
bk++){bg=bq.fields[bk];
if(typeof bg===a4){bh[bg]={};
}else{if(bg.field){bh[bg.field]=bg;
}}}bq.fields=bh;
}for(bn in bq.fields){bg=bq.fields[bn];
br=bg.type||"default";
bs=null;
bp=bn;
bn=typeof bg.field===a4?bg.field:bn;
if(!bg.nullable){bs=bq.defaults[bp!==bn?bp:bn]=bg.defaultValue!==ba?bg.defaultValue:G[br.toLowerCase()];
if(typeof bs==="function"){bi.push(bn);
}}if(bo.id===bn){bq._defaultId=bs;
}bq.defaults[bp!==bn?bp:bn]=bs;
bg.parse=bg.parse||aJ[br];
}if(bi.length>0){bq._initializers=bi;
}bm=bf.extend(bq);
bm.define=function(bt){return au.define(bm,bt);
};
if(bq.fields){bm.fields=bq.fields;
bm.idField=bq.idField;
}return bm;
};
var v={selector:function(bf){return aj(bf)?bf:V(bf);
},compare:function(bf){var bg=this.selector(bf);
return function(bh,bi){bh=bg(bh);
bi=bg(bi);
if(bh==null&&bi==null){return 0;
}if(bh==null){return -1;
}if(bi==null){return 1;
}if(bh.localeCompare){return bh.localeCompare(bi);
}return bh>bi?1:bh<bi?-1:0;
};
},create:function(bg){var bf=bg.compare||this.compare(bg.field);
if(bg.dir=="desc"){return function(bh,bi){return bf(bi,bh,true);
};
}return bf;
},combine:function(bf){return function(bg,bh){var bk=bf[0](bg,bh),bi,bj;
for(bi=1,bj=bf.length;
bi<bj;
bi++){bk=bk||bf[bi](bg,bh);
}return bk;
};
}};
var a2=N({},v,{asc:function(bf){var bg=this.selector(bf);
return function(bh,bi){var bj=bg(bh);
var bk=bg(bi);
if(bj&&bj.getTime&&bk&&bk.getTime){bj=bj.getTime();
bk=bk.getTime();
}if(bj===bk){return bh.__position-bi.__position;
}if(bj==null){return -1;
}if(bk==null){return 1;
}if(bj.localeCompare){return bj.localeCompare(bk);
}return bj>bk?1:-1;
};
},desc:function(bf){var bg=this.selector(bf);
return function(bh,bi){var bj=bg(bh);
var bk=bg(bi);
if(bj&&bj.getTime&&bk&&bk.getTime){bj=bj.getTime();
bk=bk.getTime();
}if(bj===bk){return bh.__position-bi.__position;
}if(bj==null){return 1;
}if(bk==null){return -1;
}if(bk.localeCompare){return bk.localeCompare(bj);
}return bj<bk?1:-1;
};
},create:function(bf){return this[bf.dir](bf.field);
}});
aq=function(bf,bg){var bh,bi=bf.length,bj=new Array(bi);
for(bh=0;
bh<bi;
bh++){bj[bh]=bg(bf[bh],bh,bf);
}return bj;
};
var aI=function(){function bg(bh){return bh.replace(aP,"\\").replace(av,"");
}function bf(bl,bh,bi,bk){var bj;
if(bi!=null){if(typeof bi===a4){bi=bg(bi);
bj=F.exec(bi);
if(bj){bi=new Date(+bj[1]);
}else{if(bk){bi="'"+bi.toLowerCase()+"'";
bh="(("+bh+" || '')+'').toLowerCase()";
}else{bi="'"+bi+"'";
}}}if(bi.getTime){bh="("+bh+"&&"+bh+".getTime?"+bh+".getTime():"+bh+")";
bi=bi.getTime();
}}return bh+" "+bl+" "+bi;
}return{quote:function(bh){if(bh&&bh.getTime){return"new Date("+bh.getTime()+")";
}if(typeof bh=="string"){return"'"+bg(bh)+"'";
}return""+bh;
},eq:function(bh,bi,bj){return bf("==",bh,bi,bj);
},neq:function(bh,bi,bj){return bf("!=",bh,bi,bj);
},gt:function(bh,bi,bj){return bf(">",bh,bi,bj);
},gte:function(bh,bi,bj){return bf(">=",bh,bi,bj);
},lt:function(bh,bi,bj){return bf("<",bh,bi,bj);
},lte:function(bh,bi,bj){return bf("<=",bh,bi,bj);
},startswith:function(bh,bi,bj){if(bj){bh="("+bh+" || '').toLowerCase()";
if(bi){bi=bi.toLowerCase();
}}if(bi){bi=bg(bi);
}return bh+".lastIndexOf('"+bi+"', 0) == 0";
},doesnotstartwith:function(bh,bi,bj){if(bj){bh="("+bh+" || '').toLowerCase()";
if(bi){bi=bi.toLowerCase();
}}if(bi){bi=bg(bi);
}return bh+".lastIndexOf('"+bi+"', 0) == -1";
},endswith:function(bh,bi,bj){if(bj){bh="("+bh+" || '').toLowerCase()";
if(bi){bi=bi.toLowerCase();
}}if(bi){bi=bg(bi);
}return bh+".indexOf('"+bi+"', "+bh+".length - "+(bi||"").length+") >= 0";
},doesnotendwith:function(bh,bi,bj){if(bj){bh="("+bh+" || '').toLowerCase()";
if(bi){bi=bi.toLowerCase();
}}if(bi){bi=bg(bi);
}return bh+".indexOf('"+bi+"', "+bh+".length - "+(bi||"").length+") < 0";
},contains:function(bh,bi,bj){if(bj){bh="("+bh+" || '').toLowerCase()";
if(bi){bi=bi.toLowerCase();
}}if(bi){bi=bg(bi);
}return bh+".indexOf('"+bi+"') >= 0";
},doesnotcontain:function(bh,bi,bj){if(bj){bh="("+bh+" || '').toLowerCase()";
if(bi){bi=bi.toLowerCase();
}}if(bi){bi=bg(bi);
}return bh+".indexOf('"+bi+"') == -1";
},isempty:function(bh){return bh+" === ''";
},isnotempty:function(bh){return bh+" !== ''";
},isnull:function(bh){return bh+" === null || "+bh+" === undefined";
},isnotnull:function(bh){return bh+" !== null && "+bh+" !== undefined";
}};
}();
function aO(bf){this.data=bf||[];
}aO.filterExpr=function(bg){var bh=[],bo={and:" && ",or:" || "},bm,bn,bk,bf,bj=[],bq=[],bi,bp,bl=bg.filters;
for(bm=0,bn=bl.length;
bm<bn;
bm++){bk=bl[bm];
bi=bk.field;
bp=bk.operator;
if(bk.filters){bf=aO.filterExpr(bk);
bk=bf.expression.replace(/__o\[(\d+)\]/g,function(bs,br){br=+br;
return"__o["+(bq.length+br)+"]";
}).replace(/__f\[(\d+)\]/g,function(bs,br){br=+br;
return"__f["+(bj.length+br)+"]";
});
bq.push.apply(bq,bf.operators);
bj.push.apply(bj,bf.fields);
}else{if(typeof bi===R){bf="__f["+bj.length+"](d)";
bj.push(bi);
}else{bf=an.expr(bi);
}if(typeof bp===R){bk="__o["+bq.length+"]("+bf+", "+aI.quote(bk.value)+")";
bq.push(bp);
}else{bk=aI[(bp||"eq").toLowerCase()](bf,bk.value,bk.ignoreCase!==ba?bk.ignoreCase:true);
}}bh.push(bk);
}return{expression:"("+bh.join(bo[bg.logic])+")",fields:bj,operators:bq};
};
function aD(bi,bh){if(bi){var bf=typeof bi===a4?{field:bi,dir:bh}:bi,bg=ag(bf)?bf:bf!==ba?[bf]:[];
return W(bg,function(bj){return !!bj.dir;
});
}}var aH={"==":"eq",equals:"eq",isequalto:"eq",equalto:"eq",equal:"eq","!=":"neq",ne:"neq",notequals:"neq",isnotequalto:"neq",notequalto:"neq",notequal:"neq","<":"lt",islessthan:"lt",lessthan:"lt",less:"lt","<=":"lte",le:"lte",islessthanorequalto:"lte",lessthanequal:"lte",">":"gt",isgreaterthan:"gt",greaterthan:"gt",greater:"gt",">=":"gte",isgreaterthanorequalto:"gte",greaterthanequal:"gte",ge:"gte",notsubstringof:"doesnotcontain",isnull:"isnull",isempty:"isempty",isnotempty:"isnotempty"};
function aC(bf){var bi,bj,bg,bk,bh=bf.filters;
if(bh){for(bi=0,bj=bh.length;
bi<bj;
bi++){bg=bh[bi];
bk=bg.operator;
if(bk&&typeof bk===a4){bg.operator=aH[bk.toLowerCase()]||bk;
}aC(bg);
}}}function aA(bf){if(bf&&!ai(bf)){if(ag(bf)||!bf.filters){bf={logic:"and",filters:ag(bf)?bf:[bf]};
}aC(bf);
return bf;
}}aO.normalizeFilter=aA;
function t(bf,bg){if(bf.logic||bg.logic){return false;
}return bf.field===bg.field&&bf.value===bg.value&&bf.operator===bg.operator;
}function az(bf){bf=bf||{};
if(ai(bf)){return{logic:"and",filters:[]};
}return aA(bf);
}function O(bf,bg){if(bg.logic||bf.field>bg.field){return 1;
}else{if(bf.field<bg.field){return -1;
}else{return 0;
}}}function u(bf,bg){bf=az(bf);
bg=az(bg);
if(bf.logic!==bg.logic){return false;
}var bh,bi;
var bj=(bf.filters||[]).slice();
var bk=(bg.filters||[]).slice();
if(bj.length!==bk.length){return false;
}bj=bj.sort(O);
bk=bk.sort(O);
for(var bl=0;
bl<bj.length;
bl++){bh=bj[bl];
bi=bk[bl];
if(bh.logic&&bi.logic){if(!u(bh,bi)){return false;
}}else{if(!t(bh,bi)){return false;
}}}return true;
}aO.compareFilters=u;
function ay(bf){return ag(bf)?bf:[bf];
}function aB(bi,bh){var bf=typeof bi===a4?{field:bi,dir:bh}:bi,bg=ag(bf)?bf:bf!==ba?[bf]:[];
return aq(bg,function(bj){return{field:bj.field,dir:bj.dir||"asc",aggregates:bj.aggregates};
});
}aO.prototype={toArray:function(){return this.data;
},range:function(bg,bf){return new aO(this.data.slice(bg,bg+bf));
},skip:function(bf){return new aO(this.data.slice(bf));
},take:function(bf){return new aO(this.data.slice(0,bf));
},select:function(bf){return new aO(aq(this.data,bf));
},order:function(bg,bf){var bh={dir:bf};
if(bg){if(bg.compare){bh.compare=bg.compare;
}else{bh.field=bg;
}}return new aO(this.data.slice(0).sort(v.create(bh)));
},orderBy:function(bf){return this.order(bf,"asc");
},orderByDescending:function(bf){return this.order(bf,"desc");
},sort:function(bj,bi,bf){var bk,bl,bh=aD(bj,bi),bg=[];
bf=bf||v;
if(bh.length){for(bk=0,bl=bh.length;
bk<bl;
bk++){bg.push(bf.create(bh[bk]));
}return this.orderBy({compare:bf.combine(bg)});
}return this;
},filter:function(bi){var bl,bg,bm,bf,bo,bh=this.data,bj,bn,bp=[],bk;
bi=aA(bi);
if(!bi||bi.filters.length===0){return this;
}bf=aO.filterExpr(bi);
bj=bf.fields;
bn=bf.operators;
bo=bk=new Function("d, __f, __o","return "+bf.expression);
if(bj.length||bn.length){bk=function(bq){return bo(bq,bj,bn);
};
}for(bl=0,bm=bh.length;
bl<bm;
bl++){bg=bh[bl];
if(bk(bg)){bp.push(bg);
}}return new aO(bp);
},group:function(bh,bf){bh=aB(bh||[]);
bf=bf||this.data;
var bj=this,bi=new aO(bj.data),bg;
if(bh.length>0){bg=bh[0];
bi=bi.groupBy(bg).select(function(bl){var bk=new aO(bf).filter([{field:bl.field,operator:"eq",value:bl.value,ignoreCase:false}]);
return{field:bl.field,value:bl.value,items:bh.length>1?new aO(bl.items).group(bh.slice(1),bk.toArray()).toArray():bl.items,hasSubgroups:bh.length>1,aggregates:bk.aggregate(bg.aggregates)};
});
}return bi;
},groupBy:function(bh){if(ai(bh)||!this.data.length){return new aO([]);
}var bi=bh.field,bp=this._sortForGrouping(bi,bh.dir||"asc"),bf=an.accessor(bi),bm,bk=bf.get(bp[0],bi),bj={field:bi,value:bk,items:[]},bg,bl,bn,bo=[bj];
for(bl=0,bn=bp.length;
bl<bn;
bl++){bm=bp[bl];
bg=bf.get(bm,bi);
if(!X(bk,bg)){bk=bg;
bj={field:bi,value:bk,items:[]};
bo.push(bj);
}bj.items.push(bm);
}return new aO(bo);
},_sortForGrouping:function(bh,bg){var bi,bj,bf=this.data;
if(!a3){for(bi=0,bj=bf.length;
bi<bj;
bi++){bf[bi].__position=bi;
}bf=new aO(bf).sort(bh,bg,a2).toArray();
for(bi=0,bj=bf.length;
bi<bj;
bi++){delete bf[bi].__position;
}return bf;
}return this.sort(bh,bg).toArray();
},aggregate:function(bf){var bg,bh,bi={},bj={};
if(bf&&bf.length){for(bg=0,bh=this.data.length;
bg<bh;
bg++){q(bi,bf,this.data[bg],bg,bh,bj);
}}return bi;
}};
function X(bf,bg){if(bf&&bf.getTime&&bg&&bg.getTime){return bf.getTime()===bg.getTime();
}return bf===bg;
}function q(bf,bh,bm,bl,bo,bp){bh=bh||[];
var bk,bg,bj,bn=bh.length;
for(bk=0;
bk<bn;
bk++){bg=bh[bk];
bj=bg.aggregate;
var bi=bg.field;
bf[bi]=bf[bi]||{};
bp[bi]=bp[bi]||{};
bp[bi][bj]=bp[bi][bj]||{};
bf[bi][bj]=S[bj.toLowerCase()](bf[bi][bj],bm,an.accessor(bi),bl,bo,bp[bi][bj]);
}}var S={sum:function(bg,bh,bf){var bi=bf.get(bh);
if(!ak(bg)){bg=bi;
}else{if(ak(bi)){bg+=bi;
}}return bg;
},count:function(bf){return(bf||0)+1;
},average:function(bg,bi,bf,bh,bj,bk){var bl=bf.get(bi);
if(bk.count===ba){bk.count=0;
}if(!ak(bg)){bg=bl;
}else{if(ak(bl)){bg+=bl;
}}if(ak(bl)){bk.count++;
}if(bh==bj-1&&ak(bg)){bg=bg/bk.count;
}return bg;
},max:function(bg,bh,bf){var bi=bf.get(bh);
if(!ak(bg)&&!ah(bg)){bg=bi;
}if(bg<bi&&(ak(bi)||ah(bi))){bg=bi;
}return bg;
},min:function(bg,bh,bf){var bi=bf.get(bh);
if(!ak(bg)&&!ah(bg)){bg=bi;
}if(bg>bi&&(ak(bi)||ah(bi))){bg=bi;
}return bg;
}};
function ak(bf){return typeof bf==="number"&&!isNaN(bf);
}function ah(bf){return bf&&bf.getTime;
}function a7(bf){var bg,bh=bf.length,bi=new Array(bh);
for(bg=0;
bg<bh;
bg++){bi[bg]=bf[bg].toJSON();
}return bi;
}aO.process=function(bf,bj){bj=bj||{};
var bk=new aO(bf),bi=bj.group,bm=aB(bi||[]).concat(aD(bj.sort||[])),bo,bh=bj.filterCallback,bg=bj.filter,bl=bj.skip,bn=bj.take;
if(bg){bk=bk.filter(bg);
if(bh){bk=bh(bk);
}bo=bk.toArray().length;
}if(bm){bk=bk.sort(bm);
if(bi){bf=bk.toArray();
}}if(bl!==ba&&bn!==ba){bk=bk.range(bl,bn);
}if(bi){bk=bk.group(bi,bf);
}return{total:bo,data:bk.toArray()};
};
var ap=s.extend({init:function(bf){this.data=bf.data;
},read:function(bf){bf.success(this.data);
},update:function(bf){bf.success(bf.data);
},create:function(bf){bf.success(bf.data);
},destroy:function(bf){bf.success(bf.data);
}});
var aR=s.extend({init:function(bf){var bh=this,bg;
bf=bh.options=N({},bh.options,bf);
I(B,function(bi,bj){if(typeof bf[bj]===a4){bf[bj]={url:bf[bj]};
}});
bh.cache=bf.cache?p.create(bf.cache):{find:ax,add:ax};
bg=bf.parameterMap;
if(aj(bf.push)){bh.push=bf.push;
}if(!bh.push){bh.push=Z;
}bh.parameterMap=aj(bg)?bg:function(bi){var bj={};
I(bi,function(bk,bl){if(bk in bg){bk=bg[bk];
if(al(bk)){bl=bk.value(bl);
bk=bk.key;
}}bj[bk]=bl;
});
return bj;
};
},options:{parameterMap:Z},create:function(bf){return m(this.setup(bf,A));
},read:function(bh){var bk=this,bj,bg,bi,bf=bk.cache;
bh=bk.setup(bh,aQ);
bj=bh.success||ax;
bg=bh.error||ax;
bi=bf.find(bh.data);
if(bi!==ba){bj(bi);
}else{bh.success=function(bl){bf.add(bh.data,bl);
bj(bl);
};
l.ajax(bh);
}},update:function(bf){return m(this.setup(bf,bc));
},destroy:function(bf){return m(this.setup(bf,H));
},setup:function(bh,bk){bh=bh||{};
var bj=this,bi,bg=bj.options[bk],bf=aj(bg.data)?bg.data(bh.data):bg.data;
bh=N(true,{},bg,bh);
bi=N(true,{},bf,bh.data);
bh.data=bj.parameterMap(bi,bk);
if(aj(bh.url)){bh.url=bh.url(bi);
}return bh;
}});
var p=s.extend({init:function(){this._store={};
},add:function(bg,bf){if(bg!==ba){this._store[a5(bg)]=bf;
}},find:function(bf){return this._store[a5(bf)];
},clear:function(){this._store={};
},remove:function(bf){delete this._store[a5(bf)];
}});
p.create=function(bf){var bg={inmemory:function(){return new p();
}};
if(al(bf)&&aj(bf.find)){return bf;
}if(bf===true){return new p();
}return bg[bf]();
};
function aY(bf,bi,bl,bm,bg){var bo,bh,bn,bj,bp={},bk;
for(bj=0,bk=bf.length;
bj<bk;
bj++){bo=bf[bj];
for(bh in bi){bn=bg[bh];
if(bn&&bn!==bh){if(!bp[bn]){bp[bn]=an.setter(bn);
}bp[bn](bo,bi[bh](bo));
delete bo[bh];
}}}}function z(bf,bi,bl,bm,bg){var bo,bh,bn,bj,bk;
for(bj=0,bk=bf.length;
bj<bk;
bj++){bo=bf[bj];
for(bh in bi){bo[bh]=bl._parse(bh,bi[bh](bo));
bn=bg[bh];
if(bn&&bn!==bh){delete bo[bn];
}}}}function y(bf,bi,bl,bm,bh){var bn,bj,bg,bk;
for(bj=0,bk=bf.length;
bj<bk;
bj++){bn=bf[bj];
bg=bm[bn.field];
if(bg&&bg!=bn.field){bn.field=bg;
}bn.value=bl._parse(bn.field,bn.value);
if(bn.hasSubgroups){y(bn.items,bi,bl,bm,bh);
}else{z(bn.items,bi,bl,bm,bh);
}}}function bd(bk,bi,bf,bh,bj,bg){return function(bl){bl=bk(bl);
if(bl&&!ai(bh)){if(a8.call(bl)!=="[object Array]"&&!(bl instanceof aF)){bl=[bl];
}bf(bl,bh,new bi(),bj,bg);
}return bl||[];
};
}var D=s.extend({init:function(bp){var bt=this,bm,bj,bn,bf;
bp=bp||{};
for(bm in bp){bj=bp[bm];
bt[bm]=typeof bj===a4?V(bj):bj;
}bf=bp.modelBase||au;
if(al(bt.model)){bt.model=bn=bf.define(bt.model);
}var bg=aM(bt.data,bt);
bt._dataAccessFunction=bg;
if(bt.model){var bl=aM(bt.groups,bt),bq=aM(bt.serialize,bt),bo={},bk={},br={},bi={},bs=false,bh;
bn=bt.model;
if(bn.fields){I(bn.fields,function(bu,bw){var bv;
bh=bu;
if(al(bw)&&bw.field){bh=bw.field;
}else{if(typeof bw===a4){bh=bw;
}}if(al(bw)&&bw.from){bv=bw.from;
}bs=bs||bv&&bv!==bu||bh!==bu;
bk[bu]=V(bv||bh);
br[bu]=V(bu);
bo[bv||bh]=bu;
bi[bu]=bv||bh;
});
if(!bp.serialize&&bs){bt.serialize=bd(bq,bn,aY,br,bo,bi);
}}bt._dataAccessFunction=bg;
bt.data=bd(bg,bn,z,bk,bo,bi);
bt.groups=bd(bl,bn,y,bk,bo,bi);
}},errors:function(bf){return bf?bf.errors:null;
},parse:Z,data:Z,total:function(bf){return bf.length;
},groups:Z,aggregates:function(){return{};
},serialize:function(bf){return bf;
}});
function at(bm,bf,bk,bl){var bg,bh=0,bi;
while(bf.length&&bl){bg=bf[bh];
bi=bg.items;
var bj=bi.length;
if(bm&&bm.field===bg.field&&bm.value===bg.value){if(bm.hasSubgroups&&bm.items.length){at(bm.items[bm.items.length-1],bg.items,bk,bl);
}else{bi=bi.slice(bk,bk+bl);
bm.items=bm.items.concat(bi);
}bf.splice(bh--,1);
}else{if(bg.hasSubgroups&&bi.length){at(bg,bi,bk,bl);
if(!bg.items.length){bf.splice(bh--,1);
}}else{bi=bi.slice(bk,bk+bl);
bg.items=bi;
if(!bg.items.length){bf.splice(bh--,1);
}}}if(bi.length===0){bk-=bj;
}else{bk=0;
bl-=bi.length;
}if(++bh>=bf.length){break;
}}if(bh<bf.length){bf.splice(bh,bf.length-bh);
}}function Q(bf){var bh,bl=[],bk,bj,bi;
for(bh=0,bk=bf.length;
bh<bk;
bh++){var bg=bf.at(bh);
if(bg.hasSubgroups){bl=bl.concat(Q(bg.items));
}else{bj=bg.items;
for(bi=0;
bi<bj.length;
bi++){bl.push(bj.at(bi));
}}}return bl;
}function be(bf,bj){var bh,bi,bg;
if(bj){for(bh=0,bi=bf.length;
bh<bi;
bh++){bg=bf.at(bh);
if(bg.hasSubgroups){be(bg.items,bj);
}else{bg.items=new ao(bg.items,bj);
}}}}function J(bf,bg){for(var bh=0,bi=bf.length;
bh<bi;
bh++){if(bf[bh].hasSubgroups){if(J(bf[bh].items,bg)){return true;
}}else{if(bg(bf[bh].items,bf[bh])){return true;
}}}}function aU(bj,bf,bh,bi){for(var bg=0;
bg<bj.length;
bg++){if(bj[bg].data===bf){break;
}if(aT(bj[bg].data,bh,bi)){break;
}}}function aT(bh,bg,bj){for(var bf=0,bi=bh.length;
bf<bi;
bf++){if(bh[bf]&&bh[bf].hasSubgroups){return aT(bh[bf].items,bg,bj);
}else{if(bh[bf]===bg||bh[bf]===bj){bh[bf]=bj;
return true;
}}}}function aV(bm,bf,bj,bl,bk){for(var bn=0,bi=bm.length;
bn<bi;
bn++){var bh=bm[bn];
if(!bh||bh instanceof bl){continue;
}if(bh.hasSubgroups!==ba&&!bk){aV(bh.items,bf,bj,bl,bk);
}else{for(var bg=0;
bg<bf.length;
bg++){if(bf[bg]===bh){bm[bn]=bf.at(bg);
aU(bj,bf,bh,bm[bn]);
break;
}}}}}function aS(bf,bj){var bh,bi;
for(bh=0,bi=bf.length;
bh<bi;
bh++){var bg=bf.at(bh);
if(bg.uid==bj.uid){bf.splice(bh,1);
return bg;
}}}function ac(bf,bg){if(bg){return aa(bf,function(bh){return bh.uid&&bh.uid==bg.uid||bh[bg.idField]===bg.id&&bg.id!==bg._defaultId;
});
}return -1;
}function ab(bf,bg){if(bg){return aa(bf,function(bh){return bh.uid==bg.uid;
});
}return -1;
}function aa(bg,bf){var bh,bi;
for(bh=0,bi=bg.length;
bh<bi;
bh++){if(bf(bg[bh])){return bh;
}}return -1;
}function P(bh,bi){if(bh&&!ai(bh)){var bf=bh[bi];
var bg;
if(al(bf)){bg=bf.from||bf.field||bi;
}else{bg=bh[bi]||bi;
}if(aj(bg)){return bi;
}return bg;
}return bi;
}function x(bf,bj){var bh,bi,bk={};
for(var bg in bf){if(bg!=="filters"){bk[bg]=bf[bg];
}}if(bf.filters){bk.filters=[];
for(bh=0,bi=bf.filters.length;
bh<bi;
bh++){bk.filters[bh]=x(bf.filters[bh],bj);
}}else{bk.field=P(bj.fields,bk.field);
}return bk;
}function w(bg,bk){var bi,bj,bl=[],bm,bf;
for(bi=0,bj=bg.length;
bi<bj;
bi++){bm={};
bf=bg[bi];
for(var bh in bf){bm[bh]=bf[bh];
}bm.field=P(bk.fields,bm.field);
if(bm.aggregates&&ag(bm.aggregates)){bm.aggregates=w(bm.aggregates,bk);
}bl.push(bm);
}return bl;
}var E=aE.extend({init:function(bi){var bj=this,bh,bf;
if(bi){bf=bi.data;
}bi=bj.options=N({},bj.options,bi);
bj._map={};
bj._prefetch={};
bj._data=[];
bj._pristineData=[];
bj._ranges=[];
bj._view=[];
bj._pristineTotal=0;
bj._destroyed=[];
bj._pageSize=bi.pageSize;
bj._page=bi.page||(bi.pageSize?1:ba);
bj._sort=aD(bi.sort);
bj._filter=aA(bi.filter);
bj._group=aB(bi.group);
bj._aggregate=bi.aggregate;
bj._total=bi.total;
bj._shouldDetachObservableParents=true;
aE.fn.init.call(bj);
bj.transport=a9.create(bi,bf,bj);
if(aj(bj.transport.push)){bj.transport.push({pushCreate:aM(bj._pushCreate,bj),pushUpdate:aM(bj._pushUpdate,bj),pushDestroy:aM(bj._pushDestroy,bj)});
}if(bi.offlineStorage!=null){if(typeof bi.offlineStorage=="string"){var bg=bi.offlineStorage;
bj._storage={getItem:function(){return JSON.parse(localStorage.getItem(bg));
},setItem:function(bk){localStorage.setItem(bg,a5(bj.reader.serialize(bk)));
}};
}else{bj._storage=bi.offlineStorage;
}}bj.reader=new an.data.readers[bi.schema.type||"json"](bi.schema);
bh=bj.reader.model||{};
bj._detachObservableParents();
bj._data=bj._observe(bj._data);
bj._online=true;
bj.bind(["push",L,r,aX,a6,aW,aL],bi);
},options:{data:null,schema:{modelBase:au},offlineStorage:null,serverSorting:false,serverPaging:false,serverFiltering:false,serverGrouping:false,serverAggregates:false,batch:false},clone:function(){return this;
},online:function(bf){if(bf!==ba){if(this._online!=bf){this._online=bf;
if(bf){return this.sync();
}}return l.Deferred().resolve().promise();
}else{return this._online;
}},offlineData:function(bf){if(this.options.offlineStorage==null){return null;
}if(bf!==ba){return this._storage.setItem(bf);
}return this._storage.getItem()||[];
},_isServerGrouped:function(){var bf=this.group()||[];
return this.options.serverGrouping&&bf.length;
},_pushCreate:function(bf){this._push(bf,"pushCreate");
},_pushUpdate:function(bf){this._push(bf,"pushUpdate");
},_pushDestroy:function(bf){this._push(bf,"pushDestroy");
},_push:function(bh,bg){var bf=this._readData(bh);
if(!bf){bf=bh;
}this[bg](bf);
},_flatData:function(bf,bh){if(bf){if(this._isServerGrouped()){return Q(bf);
}if(!bh){for(var bg=0;
bg<bf.length;
bg++){bf.at(bg);
}}}return bf;
},parent:ax,get:function(bg){var bh,bi,bf=this._flatData(this._data);
for(bh=0,bi=bf.length;
bh<bi;
bh++){if(bf[bh].id==bg){return bf[bh];
}}},getByUid:function(bg){var bh,bi,bf=this._flatData(this._data);
if(!bf){return;
}for(bh=0,bi=bf.length;
bh<bi;
bh++){if(bf[bh].uid==bg){return bf[bh];
}}},indexOf:function(bf){return ab(this._data,bf);
},at:function(bf){return this._data.at(bf);
},data:function(bh){var bg=this;
if(bh!==ba){bg._detachObservableParents();
bg._data=this._observe(bh);
bg._pristineData=bh.slice(0);
bg._storeData();
bg._ranges=[];
bg.trigger("reset");
bg._addRange(bg._data);
bg._total=bg._data.length;
bg._pristineTotal=bg._total;
bg._process(bg._data);
}else{if(bg._data){for(var bf=0;
bf<bg._data.length;
bf++){bg._data.at(bf);
}}return bg._data;
}},view:function(bf){if(bf===ba){return this._view;
}else{this._view=this._observeView(bf);
}},_observeView:function(bf){var bg=this;
aV(bf,bg._data,bg._ranges,bg.reader.model||aG,bg._isServerGrouped());
var bh=new ao(bf,bg.reader.model);
bh.parent=function(){return bg.parent();
};
return bh;
},flatView:function(){var bf=this.group()||[];
if(bf.length){return Q(this._view);
}else{return this._view;
}},add:function(bf){return this.insert(this._data.length,bf);
},_createNewModel:function(bf){if(this.reader.model){return new this.reader.model(bf);
}if(bf instanceof aG){return bf;
}return new aG(bf);
},insert:function(bf,bg){if(!bg){bg=bf;
bf=0;
}if(!(bg instanceof au)){bg=this._createNewModel(bg);
}if(this._isServerGrouped()){this._data.splice(bf,0,this._wrapInEmptyGroup(bg));
}else{this._data.splice(bf,0,bg);
}return bg;
},pushCreate:function(bi){if(!ag(bi)){bi=[bi];
}var bk=[];
var bf=this.options.autoSync;
this.options.autoSync=false;
try{for(var bg=0;
bg<bi.length;
bg++){var bh=bi[bg];
var bl=this.add(bh);
bk.push(bl);
var bj=bl.toJSON();
if(this._isServerGrouped()){bj=this._wrapInEmptyGroup(bj);
}this._pristineData.push(bj);
}}finally{this.options.autoSync=bf;
}if(bk.length){this.trigger("push",{type:"create",items:bk});
}},pushUpdate:function(bh){if(!ag(bh)){bh=[bh];
}var bj=[];
for(var bf=0;
bf<bh.length;
bf++){var bg=bh[bf];
var bi=this._createNewModel(bg);
var bk=this.get(bi.id);
if(bk){bj.push(bk);
bk.accept(bg);
bk.trigger(r);
this._updatePristineForModel(bk,bg);
}else{this.pushCreate(bg);
}}if(bj.length){this.trigger("push",{type:"update",items:bj});
}},pushDestroy:function(bf){var bg=this._removeItems(bf);
if(bg.length){this.trigger("push",{type:"destroy",items:bg});
}},_removeItems:function(bk){if(!ag(bk)){bk=[bk];
}var bg=[];
var bf=this.options.autoSync;
this.options.autoSync=false;
try{for(var bi=0;
bi<bk.length;
bi++){var bj=bk[bi];
var bl=this._createNewModel(bj);
var bh=false;
this._eachItem(this._data,function(bo){for(var bm=0;
bm<bo.length;
bm++){var bn=bo.at(bm);
if(bn.id===bl.id){bg.push(bn);
bo.splice(bm,1);
bh=true;
break;
}}});
if(bh){this._removePristineForModel(bl);
this._destroyed.pop();
}}}finally{this.options.autoSync=bf;
}return bg;
},remove:function(bg){var bh,bi=this,bf=bi._isServerGrouped();
this._eachItem(bi._data,function(bj){bh=aS(bj,bg);
if(bh&&bf){if(!bh.isNew||!bh.isNew()){bi._destroyed.push(bh);
}return true;
}});
this._removeModelFromRanges(bg);
this._updateRangesLength();
return bg;
},destroyed:function(){return this._destroyed;
},created:function(){var bg,bh,bi=[],bf=this._flatData(this._data);
for(bg=0,bh=bf.length;
bg<bh;
bg++){if(bf[bg].isNew&&bf[bg].isNew()){bi.push(bf[bg]);
}}return bi;
},updated:function(){var bg,bh,bi=[],bf=this._flatData(this._data);
for(bg=0,bh=bf.length;
bg<bh;
bg++){if(bf[bg].isNew&&!bf[bg].isNew()&&bf[bg].dirty){bi.push(bf[bg]);
}}return bi;
},sync:function(){var bj=this,bf=[],bk=[],bg=bj._destroyed;
var bh=l.Deferred().resolve().promise();
if(bj.online()){if(!bj.reader.model){return bh;
}bf=bj.created();
bk=bj.updated();
var bi=[];
if(bj.options.batch&&bj.transport.submit){bi=bj._sendSubmit(bf,bk,bg);
}else{bi.push.apply(bi,bj._send("create",bf));
bi.push.apply(bi,bj._send("update",bk));
bi.push.apply(bi,bj._send("destroy",bg));
}bh=l.when.apply(null,bi).then(function(){var bl,bm;
for(bl=0,bm=arguments.length;
bl<bm;
bl++){bj._accept(arguments[bl]);
}bj._storeData(true);
bj._change({action:"sync"});
bj.trigger(a6);
});
}else{bj._storeData(true);
bj._change({action:"sync"});
}return bh;
},cancelChanges:function(bf){var bg=this;
if(bf instanceof an.data.Model){bg._cancelModel(bf);
}else{bg._destroyed=[];
bg._detachObservableParents();
bg._data=bg._observe(bg._pristineData);
if(bg.options.serverPaging){bg._total=bg._pristineTotal;
}bg._ranges=[];
bg._addRange(bg._data);
bg._change();
}},hasChanges:function(){var bg,bh,bf=this._flatData(this._data);
if(this._destroyed.length){return true;
}for(bg=0,bh=bf.length;
bg<bh;
bg++){if(bf[bg].isNew&&bf[bg].isNew()||bf[bg].dirty){return true;
}}return false;
},_accept:function(bk){var bm=this,bh=bk.models,bj=bk.response,bf=0,bl=bm._isServerGrouped(),bi=bm._pristineData,bn=bk.type,bg;
bm.trigger(aW,{response:bj,type:bn});
if(bj&&!ai(bj)){bj=bm.reader.parse(bj);
if(bm._handleCustomErrors(bj)){return;
}bj=bm.reader.data(bj);
if(!ag(bj)){bj=[bj];
}}else{bj=l.map(bh,function(bo){return bo.toJSON();
});
}if(bn==="destroy"){bm._destroyed=[];
}for(bf=0,bg=bh.length;
bf<bg;
bf++){if(bn!=="destroy"){bh[bf].accept(bj[bf]);
if(bn==="create"){bi.push(bl?bm._wrapInEmptyGroup(bh[bf]):bj[bf]);
}else{if(bn==="update"){bm._updatePristineForModel(bh[bf],bj[bf]);
}}}else{bm._removePristineForModel(bh[bf]);
}}},_updatePristineForModel:function(bf,bg){this._executeOnPristineForModel(bf,function(bh,bi){an.deepExtend(bi[bh],bg);
});
},_executeOnPristineForModel:function(bg,bf){this._eachPristineItem(function(bi){var bh=ac(bi,bg);
if(bh>-1){bf(bh,bi);
return true;
}});
},_removePristineForModel:function(bf){this._executeOnPristineForModel(bf,function(bg,bh){bh.splice(bg,1);
});
},_readData:function(bf){var bg=!this._isServerGrouped()?this.reader.data:this.reader.groups;
return bg.call(this.reader,bf);
},_eachPristineItem:function(bf){this._eachItem(this._pristineData,bf);
},_eachItem:function(bg,bf){if(bg&&bg.length){if(this._isServerGrouped()){J(bg,bf);
}else{bf(bg);
}}},_pristineForModel:function(bh){var bi,bg,bf=function(bj){bg=ac(bj,bh);
if(bg>-1){bi=bj[bg];
return true;
}};
this._eachPristineItem(bf);
return bi;
},_cancelModel:function(bf){var bg=this._pristineForModel(bf);
this._eachItem(this._data,function(bi){var bh=ab(bi,bf);
if(bh>=0){if(bg&&(!bf.isNew()||bg.__state__)){bi[bh].accept(bg);
}else{bi.splice(bh,1);
}}});
},_submit:function(bg,bf){var bh=this;
bh.trigger(aX,{type:"submit"});
bh.transport.submit(N({success:function(bj,bk){var bi=l.grep(bg,function(bl){return bl.type==bk;
})[0];
if(bi){bi.resolve({response:bj,models:bi.models,type:bk});
}},error:function(bk,bl,bi){for(var bj=0;
bj<bg.length;
bj++){bg[bj].reject(bk);
}bh.error(bk,bl,bi);
}},bf));
},_sendSubmit:function(bf,bj,bg){var bi=this,bh=[];
if(bi.options.batch){if(bf.length){bh.push(l.Deferred(function(bk){bk.type="create";
bk.models=bf;
}));
}if(bj.length){bh.push(l.Deferred(function(bk){bk.type="update";
bk.models=bj;
}));
}if(bg.length){bh.push(l.Deferred(function(bk){bk.type="destroy";
bk.models=bg;
}));
}bi._submit(bh,{data:{created:bi.reader.serialize(a7(bf)),updated:bi.reader.serialize(a7(bj)),destroyed:bi.reader.serialize(a7(bg))}});
}return bh;
},_promise:function(bf,bg,bi){var bh=this;
return l.Deferred(function(bj){bh.trigger(aX,{type:bi});
bh.transport[bi].call(bh.transport,N({success:function(bk){bj.resolve({response:bk,models:bg,type:bi});
},error:function(bl,bm,bk){bj.reject(bl);
bh.error(bl,bm,bk);
}},bf));
}).promise();
},_send:function(bj,bg){var bl=this,bh,bi,bk=[],bf=bl.reader.serialize(a7(bg));
if(bl.options.batch){if(bg.length){bk.push(bl._promise({data:{models:bf}},bg,bj));
}}else{for(bh=0,bi=bg.length;
bh<bi;
bh++){bk.push(bl._promise({data:bf[bh]},[bg[bh]],bj));
}}return bk;
},read:function(bf){var bi=this,bh=bi._params(bf);
var bg=l.Deferred();
bi._queueRequest(bh,function(){var bj=bi.trigger(aX,{type:"read"});
if(!bj){bi.trigger(aL);
bi._ranges=[];
bi.trigger("reset");
if(bi.online()){bi.transport.read({data:bh,success:function(bk){bi.success(bk,bh);
bg.resolve();
},error:function(){var bk=a0.call(arguments);
bi.error.apply(bi,bk);
bg.reject.apply(bg,bk);
}});
}else{if(bi.options.offlineStorage!=null){bi.success(bi.offlineData(),bh);
bg.resolve();
}}}else{bi._dequeueRequest();
bg.resolve(bj);
}});
return bg.promise();
},_readAggregates:function(bf){return this.reader.aggregates(bf);
},success:function(bf){var bp=this,bn=bp.options;
bp.trigger(aW,{response:bf,type:"read"});
if(bp.online()){bf=bp.reader.parse(bf);
if(bp._handleCustomErrors(bf)){bp._dequeueRequest();
return;
}bp._total=bp.reader.total(bf);
if(bp._aggregate&&bn.serverAggregates){bp._aggregateResult=bp._readAggregates(bf);
}bf=bp._readData(bf);
}else{bf=bp._readData(bf);
var bl=[];
var bk={};
var bm=bp.reader.model;
var bh=bm?bm.idField:"id";
var bi;
for(bi=0;
bi<this._destroyed.length;
bi++){var bg=this._destroyed[bi][bh];
bk[bg]=bg;
}for(bi=0;
bi<bf.length;
bi++){var bj=bf[bi];
var bo=bj.__state__;
if(bo=="destroy"){if(!bk[bj[bh]]){this._destroyed.push(this._createNewModel(bj));
}}else{bl.push(bj);
}}bf=bl;
bp._total=bf.length;
}bp._pristineTotal=bp._total;
bp._pristineData=bf.slice(0);
bp._detachObservableParents();
bp._data=bp._observe(bf);
if(bp.options.offlineStorage!=null){bp._eachItem(bp._data,function(bs){for(var bq=0;
bq<bs.length;
bq++){var br=bs.at(bq);
if(br.__state__=="update"){br.dirty=true;
}}});
}bp._storeData();
bp._addRange(bp._data);
bp._process(bp._data);
bp._dequeueRequest();
},_detachObservableParents:function(){if(this._data&&this._shouldDetachObservableParents){for(var bf=0;
bf<this._data.length;
bf++){if(this._data[bf].parent){this._data[bf].parent=ax;
}}}},_storeData:function(bm){var bk=this._isServerGrouped();
var bj=this.reader.model;
function bi(bn){var br=[];
for(var bp=0;
bp<bn.length;
bp++){var bo=bn.at(bp);
var bq=bo.toJSON();
if(bk&&bo.items){bq.items=bi(bo.items);
}else{bq.uid=bo.uid;
if(bj){if(bo.isNew()){bq.__state__="create";
}else{if(bo.dirty){bq.__state__="update";
}}}}br.push(bq);
}return br;
}if(this.options.offlineStorage!=null){var bl=bi(this._data);
var bf=[];
for(var bg=0;
bg<this._destroyed.length;
bg++){var bh=this._destroyed[bg].toJSON();
bh.__state__="destroy";
bf.push(bh);
}this.offlineData(bl.concat(bf));
if(bm){this._pristineData=this._readData(bl);
}}},_addRange:function(bf){var bi=this,bh=bi._skip||0,bg=bh+bi._flatData(bf,true).length;
bi._ranges.push({start:bh,end:bg,data:bf,timestamp:new Date().getTime()});
bi._ranges.sort(function(bj,bk){return bj.start-bk.start;
});
},error:function(bh,bg,bf){this._dequeueRequest();
this.trigger(aW,{});
this.trigger(L,{xhr:bh,status:bg,errorThrown:bf});
},_params:function(bf){var bh=this,bg=N({take:bh.take(),skip:bh.skip(),page:bh.page(),pageSize:bh.pageSize(),sort:bh._sort,filter:bh._filter,group:bh._group,aggregate:bh._aggregate},bf);
if(!bh.options.serverPaging){delete bg.take;
delete bg.skip;
delete bg.page;
delete bg.pageSize;
}if(!bh.options.serverGrouping){delete bg.group;
}else{if(bh.reader.model&&bg.group){bg.group=w(bg.group,bh.reader.model);
}}if(!bh.options.serverFiltering){delete bg.filter;
}else{if(bh.reader.model&&bg.filter){bg.filter=x(bg.filter,bh.reader.model);
}}if(!bh.options.serverSorting){delete bg.sort;
}else{if(bh.reader.model&&bg.sort){bg.sort=w(bg.sort,bh.reader.model);
}}if(!bh.options.serverAggregates){delete bg.aggregate;
}else{if(bh.reader.model&&bg.aggregate){bg.aggregate=w(bg.aggregate,bh.reader.model);
}}return bg;
},_queueRequest:function(bg,bf){var bh=this;
if(!bh._requestInProgress){bh._requestInProgress=true;
bh._pending=ba;
bf();
}else{bh._pending={callback:aM(bf,bh),options:bg};
}},_dequeueRequest:function(){var bf=this;
bf._requestInProgress=false;
if(bf._pending){bf._queueRequest(bf._pending.options,bf._pending.callback);
}},_handleCustomErrors:function(bg){if(this.reader.errors){var bf=this.reader.errors(bg);
if(bf){this.trigger(L,{xhr:null,status:"customerror",errorThrown:"custom error",errors:bf});
return true;
}}return false;
},_shouldWrap:function(bf){var bg=this.reader.model;
if(bg&&bf.length){return !(bf[0] instanceof bg);
}return false;
},_observe:function(bg){var bi=this,bh=bi.reader.model;
bi._shouldDetachObservableParents=true;
if(bg instanceof aF){bi._shouldDetachObservableParents=false;
if(bi._shouldWrap(bg)){bg.type=bi.reader.model;
bg.wrapAll(bg,bg);
}}else{var bf=bi.pageSize()&&!bi.options.serverPaging?ao:aF;
bg=new bf(bg,bi.reader.model);
bg.parent=function(){return bi.parent();
};
}if(bi._isServerGrouped()){be(bg,bh);
}if(bi._changeHandler&&bi._data&&bi._data instanceof aF){bi._data.unbind(r,bi._changeHandler);
}else{bi._changeHandler=aM(bi._change,bi);
}return bg.bind(r,bi._changeHandler);
},_updateTotalForAction:function(bf,bg){var bh=this;
var bi=parseInt(bh._total,10);
if(!ak(bh._total)){bi=parseInt(bh._pristineTotal,10);
}if(bf==="add"){bi+=bg.length;
}else{if(bf==="remove"){bi-=bg.length;
}else{if(bf!=="itemchange"&&bf!=="sync"&&!bh.options.serverPaging){bi=bh._pristineTotal;
}else{if(bf==="sync"){bi=bh._pristineTotal=parseInt(bh._total,10);
}}}}bh._total=bi;
},_change:function(bg){var bk=this,bi,bj,bf=bg?bg.action:"";
if(bf==="remove"){for(bi=0,bj=bg.items.length;
bi<bj;
bi++){if(!bg.items[bi].isNew||!bg.items[bi].isNew()){bk._destroyed.push(bg.items[bi]);
}}}if(bk.options.autoSync&&(bf==="add"||bf==="remove"||bf==="itemchange")){var bh=function(bl){if(bl.action==="sync"){bk.unbind("change",bh);
bk._updateTotalForAction(bf,bg.items);
}};
bk.first("change",bh);
bk.sync();
}else{bk._updateTotalForAction(bf,bg?bg.items:[]);
bk._process(bk._data,bg);
}},_calculateAggregates:function(bg,bi){bi=bi||{};
var bj=new aO(bg),bf=bi.aggregate,bh=bi.filter;
if(bh){bj=bj.filter(bh);
}return bj.aggregate(bf);
},_process:function(bf,bg){var bj=this,bh={},bi;
if(bj.options.serverPaging!==true){bh.skip=bj._skip;
bh.take=bj._take||bj._pageSize;
if(bh.skip===ba&&bj._page!==ba&&bj._pageSize!==ba){bh.skip=(bj._page-1)*bj._pageSize;
}}if(bj.options.serverSorting!==true){bh.sort=bj._sort;
}if(bj.options.serverFiltering!==true){bh.filter=bj._filter;
}if(bj.options.serverGrouping!==true){bh.group=bj._group;
}if(bj.options.serverAggregates!==true){bh.aggregate=bj._aggregate;
bj._aggregateResult=bj._calculateAggregates(bf,bh);
}bi=bj._queryProcess(bf,bh);
bj.view(bi.data);
if(bi.total!==ba&&!bj.options.serverFiltering){bj._total=bi.total;
}bg=bg||{};
bg.items=bg.items||bj._view;
bj.trigger(r,bg);
},_queryProcess:function(bf,bg){return aO.process(bf,bg);
},_mergeState:function(bf){var bg=this;
if(bf!==ba){bg._pageSize=bf.pageSize;
bg._page=bf.page;
bg._sort=bf.sort;
bg._filter=bf.filter;
bg._group=bf.group;
bg._aggregate=bf.aggregate;
bg._skip=bg._currentRangeStart=bf.skip;
bg._take=bf.take;
if(bg._skip===ba){bg._skip=bg._currentRangeStart=bg.skip();
bf.skip=bg.skip();
}if(bg._take===ba&&bg._pageSize!==ba){bg._take=bg._pageSize;
bf.take=bg._take;
}if(bf.sort){bg._sort=bf.sort=aD(bf.sort);
}if(bf.filter){bg._filter=bf.filter=aA(bf.filter);
}if(bf.group){bg._group=bf.group=aB(bf.group);
}if(bf.aggregate){bg._aggregate=bf.aggregate=ay(bf.aggregate);
}}return bf;
},query:function(bg){var bi;
var bh=this.options.serverSorting||this.options.serverPaging||this.options.serverFiltering||this.options.serverGrouping||this.options.serverAggregates;
if(bh||(this._data===ba||this._data.length===0)&&!this._destroyed.length){return this.read(this._mergeState(bg));
}var bf=this.trigger(aX,{type:"read"});
if(!bf){this.trigger(aL);
bi=this._queryProcess(this._data,this._mergeState(bg));
if(!this.options.serverFiltering){if(bi.total!==ba){this._total=bi.total;
}else{this._total=this._data.length;
}}this._aggregateResult=this._calculateAggregates(this._data,bg);
this.view(bi.data);
this.trigger(aW,{type:"read"});
this.trigger(r,{items:bi.data});
}return l.Deferred().resolve(bf).promise();
},fetch:function(bf){var bh=this;
var bg=function(bi){if(bi!==true&&aj(bf)){bf.call(bh);
}};
return this._query().then(bg);
},_query:function(bf){var bg=this;
return bg.query(N({},{page:bg.page(),pageSize:bg.pageSize(),sort:bg.sort(),filter:bg.filter(),group:bg.group(),aggregate:bg.aggregate()},bf));
},next:function(bf){var bh=this,bg=bh.page(),bi=bh.total();
bf=bf||{};
if(!bg||bi&&bg+1>bh.totalPages()){return;
}bh._skip=bh._currentRangeStart=bg*bh.take();
bg+=1;
bf.page=bg;
bh._query(bf);
return bg;
},prev:function(bf){var bh=this,bg=bh.page();
bf=bf||{};
if(!bg||bg===1){return;
}bh._skip=bh._currentRangeStart=bh._skip-bh.take();
bg-=1;
bf.page=bg;
bh._query(bf);
return bg;
},page:function(bh){var bg=this,bf;
if(bh!==ba){bh=ar.max(ar.min(ar.max(bh,1),bg.totalPages()),1);
bg._query({page:bh});
return;
}bf=bg.skip();
return bf!==ba?ar.round((bf||0)/(bg.take()||1))+1:ba;
},pageSize:function(bg){var bf=this;
if(bg!==ba){bf._query({pageSize:bg,page:1});
return;
}return bf.take();
},sort:function(bg){var bf=this;
if(bg!==ba){bf._query({sort:bg});
return;
}return bf._sort;
},filter:function(bg){var bf=this;
if(bg===ba){return bf._filter;
}bf.trigger("reset");
bf._query({filter:bg,page:1});
},group:function(bg){var bf=this;
if(bg!==ba){bf._query({group:bg});
return;
}return bf._group;
},total:function(){return parseInt(this._total||0,10);
},aggregate:function(bg){var bf=this;
if(bg!==ba){bf._query({aggregate:bg});
return;
}return bf._aggregate;
},aggregates:function(){var bf=this._aggregateResult;
if(ai(bf)){bf=this._emptyAggregates(this.aggregate());
}return bf;
},_emptyAggregates:function(bg){var bi={};
if(!ai(bg)){var bf={};
if(!ag(bg)){bg=[bg];
}for(var bh=0;
bh<bg.length;
bh++){bf[bg[bh].aggregate]=0;
bi[bg[bh].field]=bf;
}}return bi;
},_wrapInEmptyGroup:function(bj){var bg=this.group(),bk,bf,bh,bi;
for(bh=bg.length-1,bi=0;
bh>=bi;
bh--){bf=bg[bh];
bk={value:bj.get(bf.field),field:bf.field,items:bk?[bk]:[bj],hasSubgroups:!!bk,aggregates:this._emptyAggregates(bf.aggregates)};
}return bk;
},totalPages:function(){var bg=this,bf=bg.pageSize()||bg.total();
return ar.ceil((bg.total()||0)/bf);
},inRange:function(bg,bh){var bi=this,bf=ar.min(bg+bh,bi.total());
if(!bi.options.serverPaging&&bi._data.length>0){return true;
}return bi._findRange(bg,bf).length>0;
},lastRange:function(){var bf=this._ranges;
return bf[bf.length-1]||{start:0,end:0,data:[]};
},firstItemUid:function(){var bf=this._ranges;
return bf.length&&bf[0].data.length&&bf[0].data[0].uid;
},enableRequestsInProgress:function(){this._skipRequestsInProgress=false;
},_timeStamp:function(){return new Date().getTime();
},range:function(bl,bn){this._currentRequestTimeStamp=this._timeStamp();
this._skipRequestsInProgress=true;
bl=ar.min(bl||0,this.total());
var bo=this,bi=ar.max(ar.floor(bl/bn),0)*bn,bk=ar.min(bi+bn,bo.total()),bg;
bg=bo._findRange(bl,ar.min(bl+bn,bo.total()));
if(bg.length){bo._pending=ba;
bo._skip=bl>bo.skip()?ar.min(bk,(bo.totalPages()-1)*bo.take()):bi;
bo._currentRangeStart=bl;
bo._take=bn;
var bj=bo.options.serverPaging;
var bm=bo.options.serverSorting;
var bh=bo.options.serverFiltering;
var bf=bo.options.serverAggregates;
try{bo.options.serverPaging=true;
if(!bo._isServerGrouped()&&!(bo.group()&&bo.group().length)){bo.options.serverSorting=true;
}bo.options.serverFiltering=true;
bo.options.serverPaging=true;
bo.options.serverAggregates=true;
if(bj){bo._detachObservableParents();
bo._data=bg=bo._observe(bg);
}bo._process(bg);
}finally{bo.options.serverPaging=bj;
bo.options.serverSorting=bm;
bo.options.serverFiltering=bh;
bo.options.serverAggregates=bf;
}return;
}if(bn!==ba){if(!bo._rangeExists(bi,bk)){bo.prefetch(bi,bn,function(){if(bl>bi&&bk<bo.total()&&!bo._rangeExists(bk,ar.min(bk+bn,bo.total()))){bo.prefetch(bk,bn,function(){bo.range(bl,bn);
});
}else{bo.range(bl,bn);
}});
}else{if(bi<bl){bo.prefetch(bk,bn,function(){bo.range(bl,bn);
});
}}}},_findRange:function(bu,bh){var bx=this,bq=bx._ranges,bn,bg=[],bs,bw,bv,bi,bo,bp,bm,bl=bx.options,br=bl.serverSorting||bl.serverPaging||bl.serverFiltering||bl.serverGrouping||bl.serverAggregates,bj,bf,bk;
for(bs=0,bk=bq.length;
bs<bk;
bs++){bn=bq[bs];
if(bu>=bn.start&&bu<=bn.end){bf=0;
for(bw=bs;
bw<bk;
bw++){bn=bq[bw];
bj=bx._flatData(bn.data,true);
if(bj.length&&bu+bf>=bn.start){bo=bn.data;
bp=bn.end;
if(!br){var bt=aB(bx.group()||[]).concat(aD(bx.sort()||[]));
bm=bx._queryProcess(bn.data,{sort:bt,filter:bx.filter()});
bj=bo=bm.data;
if(bm.total!==ba){bp=bm.total;
}}bv=0;
if(bu+bf>bn.start){bv=bu+bf-bn.start;
}bi=bj.length;
if(bp>bh){bi=bi-(bp-bh);
}bf+=bi-bv;
bg=bx._mergeGroups(bg,bo,bv,bi);
if(bh<=bn.end&&bf==bh-bu){return bg;
}}}break;
}}return[];
},_mergeGroups:function(bf,bh,bi,bj){if(this._isServerGrouped()){var bk=bh.toJSON(),bg;
if(bf.length){bg=bf[bf.length-1];
}at(bg,bk,bi,bj);
return bf.concat(bk);
}return bf.concat(bh.slice(bi,bj));
},skip:function(){var bf=this;
if(bf._skip===ba){return bf._page!==ba?(bf._page-1)*(bf.take()||1):ba;
}return bf._skip;
},currentRangeStart:function(){return this._currentRangeStart||0;
},take:function(){return this._take||this._pageSize;
},_prefetchSuccessHandler:function(bi,bh,bf,bg){var bj=this;
var bk=bj._timeStamp();
return function(bl){var bm=false,bp={start:bi,end:bh,data:[],timestamp:bj._timeStamp()},bn,bo,bq;
bj._dequeueRequest();
bj.trigger(aW,{response:bl,type:"read"});
bl=bj.reader.parse(bl);
bq=bj._readData(bl);
if(bq.length){for(bn=0,bo=bj._ranges.length;
bn<bo;
bn++){if(bj._ranges[bn].start===bi){bm=true;
bp=bj._ranges[bn];
break;
}}if(!bm){bj._ranges.push(bp);
}}bp.data=bj._observe(bq);
bp.end=bp.start+bj._flatData(bp.data,true).length;
bj._ranges.sort(function(br,bs){return br.start-bs.start;
});
bj._total=bj.reader.total(bl);
if(bg||(bk>=bj._currentRequestTimeStamp||!bj._skipRequestsInProgress)){if(bf&&bq.length){bf();
}else{bj.trigger(r,{});
}}};
},prefetch:function(bi,bj,bf){var bk=this,bh=ar.min(bi+bj,bk.total()),bg={take:bj,skip:bi,page:bi/bj+1,pageSize:bj,sort:bk._sort,filter:bk._filter,group:bk._group,aggregate:bk._aggregate};
if(!bk._rangeExists(bi,bh)){clearTimeout(bk._timeout);
bk._timeout=setTimeout(function(){bk._queueRequest(bg,function(){if(!bk.trigger(aX,{type:"read"})){bk.transport.read({data:bk._params(bg),success:bk._prefetchSuccessHandler(bi,bh,bf),error:function(){var bl=a0.call(arguments);
bk.error.apply(bk,bl);
}});
}else{bk._dequeueRequest();
}});
},100);
}else{if(bf){bf();
}}},_multiplePrefetch:function(bi,bj,bf){var bk=this,bh=ar.min(bi+bj,bk.total()),bg={take:bj,skip:bi,page:bi/bj+1,pageSize:bj,sort:bk._sort,filter:bk._filter,group:bk._group,aggregate:bk._aggregate};
if(!bk._rangeExists(bi,bh)){if(!bk.trigger(aX,{type:"read"})){bk.transport.read({data:bk._params(bg),success:bk._prefetchSuccessHandler(bi,bh,bf,true)});
}}else{if(bf){bf();
}}},_rangeExists:function(bj,bf){var bk=this,bi=bk._ranges,bg,bh;
for(bg=0,bh=bi.length;
bg<bh;
bg++){if(bi[bg].start<=bj&&bi[bg].end>=bf){return true;
}}return false;
},_removeModelFromRanges:function(bi){var bk,bf,bj;
for(var bg=0,bh=this._ranges.length;
bg<bh;
bg++){bj=this._ranges[bg];
this._eachItem(bj.data,function(bl){bk=aS(bl,bi);
if(bk){bf=true;
}});
if(bf){break;
}}},_updateRangesLength:function(){var bj=0,bh,bi;
for(var bf=0,bg=this._ranges.length;
bf<bg;
bf++){bh=this._ranges[bf];
bh.start=bh.start-bj;
bi=this._flatData(bh.data,true).length;
bj=bh.end-bi;
bh.end=bh.start+bi;
}}});
var a9={};
a9.create=function(bh,bf,bg){var bi,bj=bh.transport?l.extend({},bh.transport):null;
if(bj){bj.read=typeof bj.read===a4?{url:bj.read}:bj.read;
if(bh.type==="jsdo"){bj.dataSource=bg;
}if(bh.type){an.data.transports=an.data.transports||{};
an.data.schemas=an.data.schemas||{};
if(an.data.transports[bh.type]&&!al(an.data.transports[bh.type])){bi=new an.data.transports[bh.type](N(bj,{data:bf}));
}else{bj=N(true,{},an.data.transports[bh.type],bj);
}bh.schema=N(true,{},an.data.schemas[bh.type],bh.schema);
}if(!bi){bi=aj(bj.read)?bj:new aR(bj);
}}else{bi=new ap({data:bh.data||[]});
}return bi;
};
E.create=function(bm){if(ag(bm)||bm instanceof aF){bm={data:bm};
}var bg=bm||{},bf=bg.data,bi=bg.fields,bo=bg.table,bn=bg.select,bj,bk,bl={},bh;
if(!bf&&bi&&!bg.transport){if(bo){bf=af(bo,bi);
}else{if(bn){bf=ae(bn,bi);
if(bg.group===ba&&bf[0]&&bf[0].optgroup!==ba){bg.group="optgroup";
}}}}if(an.data.Model&&bi&&(!bg.schema||!bg.schema.model)){for(bj=0,bk=bi.length;
bj<bk;
bj++){bh=bi[bj];
if(bh.type){bl[bh.field]=bh;
}}if(!ai(bl)){bg.schema=N(true,bg.schema,{model:{fields:bl}});
}}bg.data=bf;
bn=null;
bg.select=null;
bo=null;
bg.table=null;
return bg instanceof E?bg:new E(bg);
};
function ae(bp,bg){bp=l(bp)[0];
var bm=bp.options;
var bh=bg[0];
var bo=bg[1];
var bf=[];
var bi,bj;
var bk;
var bl;
var bn;
var bq;
for(bi=0,bj=bm.length;
bi<bj;
bi++){bn={};
bl=bm[bi];
bk=bl.parentNode;
if(bk===bp){bk=null;
}if(bl.disabled||bk&&bk.disabled){continue;
}if(bk){bn.optgroup=bk.label;
}bn[bh.field]=bl.text;
bq=bl.attributes.value;
if(bq&&bq.specified){bq=bl.value;
}else{bq=bl.text;
}bn[bo.field]=bq;
bf.push(bn);
}return bf;
}function af(bq,bl){var br=l(bq)[0].tBodies[0],bp=br?br.rows:[],bm,bn,bk,bj=bl.length,bh=[],bg,bo,bf,bi;
for(bm=0,bn=bp.length;
bm<bn;
bm++){bo={};
bi=true;
bg=bp[bm].cells;
for(bk=0;
bk<bj;
bk++){bf=bg[bk];
if(bf.nodeName.toLowerCase()!=="th"){bi=false;
bo[bl[bk].field]=bf.innerHTML;
}}if(!bi){bh.push(bo);
}}return bh;
}var aw=au.define({idField:"id",init:function(bj){var bi=this,bh=bi.hasChildren||bj&&bj.hasChildren,bf="items",bg={};
an.data.Model.fn.init.call(bi,bj);
if(typeof bi.children===a4){bf=bi.children;
}bg={schema:{data:bf,model:{hasChildren:bh,id:bi.idField,fields:bi.fields}}};
if(typeof bi.children!==a4){N(bg,bi.children);
}bg.data=bj;
if(!bh){bh=bg.schema.data;
}if(typeof bh===a4){bh=an.getter(bh);
}if(aj(bh)){bi.hasChildren=!!bh.call(bi,bi);
}bi._childrenOptions=bg;
if(bi.hasChildren){bi._initChildren();
}bi._loaded=!!(bj&&bj._loaded);
},_initChildren:function(){var bh=this;
var bf,bi,bg;
if(!(bh.children instanceof Y)){bf=bh.children=new Y(bh._childrenOptions);
bi=bf.transport;
bg=bi.parameterMap;
bi.parameterMap=function(bj,bk){bj[bh.idField||"id"]=bh.id;
if(bg){bj=bg(bj,bk);
}return bj;
};
bf.parent=function(){return bh;
};
bf.bind(r,function(bj){bj.node=bj.node||bh;
bh.trigger(r,bj);
});
bf.bind(L,function(bk){var bj=bh.parent();
if(bj){bk.node=bk.node||bh;
bj.trigger(L,bk);
}});
bh._updateChildrenField();
}},append:function(bf){this._initChildren();
this.loaded(true);
this.children.add(bf);
},hasChildren:false,level:function(){var bg=this.parentNode(),bf=0;
while(bg&&bg.parentNode){bf++;
bg=bg.parentNode?bg.parentNode():null;
}return bf;
},_updateChildrenField:function(){var bf=this._childrenOptions.schema.data;
this[bf||"items"]=this.children.data();
},_childrenLoaded:function(){this._loaded=true;
this._updateChildrenField();
},load:function(){var bh={};
var bg="_query";
var bf,bi;
if(this.hasChildren){this._initChildren();
bf=this.children;
bh[this.idField||"id"]=this.id;
if(!this._loaded){bf._data=ba;
bg="read";
}bf.one(r,aM(this._childrenLoaded,this));
bi=bf[bg](bh);
}else{this.loaded(true);
}return bi||l.Deferred().resolve().promise();
},parentNode:function(){var bf=this.parent();
return bf.parent();
},loaded:function(bf){if(bf!==ba){this._loaded=bf;
}else{return this._loaded;
}},shouldSerialize:function(bf){return au.fn.shouldSerialize.call(this,bf)&&bf!=="children"&&bf!=="_loaded"&&bf!=="hasChildren"&&bf!=="_childrenOptions";
}});
function C(bf){return function(){var bg=this._data,bh=E.fn[bf].apply(this,a0.call(arguments));
if(this._data!=bg){this._attachBubbleHandlers();
}return bh;
};
}var Y=E.extend({init:function(bg){var bf=aw.define({children:bg});
E.fn.init.call(this,N(true,{},{schema:{modelBase:bf,model:bf}},bg));
this._attachBubbleHandlers();
},_attachBubbleHandlers:function(){var bf=this;
bf._data.bind(L,function(bg){bf.trigger(L,bg);
});
},remove:function(bg){var bh=bg.parentNode(),bf=this,bi;
if(bh&&bh._initChildren){bf=bh.children;
}bi=E.fn.remove.call(bf,bg);
if(bh&&!bf.data().length){bh.hasChildren=false;
}return bi;
},success:C("success"),data:C("data"),insert:function(bf,bg){var bh=this.parent();
if(bh&&bh._initChildren){bh.hasChildren=true;
bh._initChildren();
}return E.fn.insert.call(this,bf,bg);
},_find:function(bj,bl){var bh,bi,bk,bf;
var bg=this._data;
if(!bg){return;
}bk=E.fn[bj].call(this,bl);
if(bk){return bk;
}bg=this._flatData(this._data);
for(bh=0,bi=bg.length;
bh<bi;
bh++){bf=bg[bh].children;
if(!(bf instanceof Y)){continue;
}bk=bf[bj](bl);
if(bk){return bk;
}}},get:function(bf){return this._find("get",bf);
},getByUid:function(bf){return this._find("getByUid",bf);
}});
function ad(bq,bj){var bo=l(bq).children(),bl,bp,bh=[],br,bu=bj[0].field,bv=bj[1]&&bj[1].field,bs=bj[2]&&bj[2].field,bm=bj[3]&&bj[3].field,bn,bk,bt,bg,bf;
function bi(bw,bx){return bw.filter(bx).add(bw.find(bx));
}for(bl=0,bp=bo.length;
bl<bp;
bl++){br={_loaded:true};
bn=bo.eq(bl);
bt=bn[0].firstChild;
bf=bn.children();
bq=bf.filter("ul");
bf=bf.filter(":not(ul)");
bk=bn.attr("data-id");
if(bk){br.id=bk;
}if(bt){br[bu]=bt.nodeType==3?bt.nodeValue:bf.text();
}if(bv){br[bv]=bi(bf,"a").attr("href");
}if(bm){br[bm]=bi(bf,"img").attr("src");
}if(bs){bg=bi(bf,".k-sprite").prop("className");
br[bs]=bg&&l.trim(bg.replace("k-sprite",""));
}if(bq.length){br.items=ad(bq.eq(0),bj);
}if(bn.attr("data-hasChildren")=="true"){br.hasChildren=true;
}bh.push(br);
}return bh;
}Y.create=function(bj){bj=bj&&bj.push?{data:bj}:bj;
var bg=bj||{},bf=bg.data,bh=bg.fields,bi=bg.list;
if(bf&&bf._dataSource){return bf._dataSource;
}if(!bf&&bh&&!bg.transport){if(bi){bf=ad(bi,bh);
}}bg.data=bf;
return bg instanceof Y?bg:new Y(bg);
};
var o=an.Observable.extend({init:function(bg,bi,bh){an.Observable.fn.init.call(this);
this._prefetching=false;
this.dataSource=bg;
this.prefetch=!bh;
var bf=this;
bg.bind("change",function(){bf._change();
});
bg.bind("reset",function(){bf._reset();
});
this._syncWithDataSource();
this.setViewSize(bi);
},setViewSize:function(bf){this.viewSize=bf;
this._recalculate();
},at:function(bf){var bh=this.pageSize,bg=true;
if(bf>=this.total()){this.trigger("endreached",{index:bf});
return null;
}if(!this.useRanges){return this.dataSource.view()[bf];
}if(this.useRanges){if(bf<this.dataOffset||bf>=this.skip+bh){bg=this.range(Math.floor(bf/bh)*bh);
}if(bf===this.prefetchThreshold){this._prefetch();
}if(bf===this.midPageThreshold){this.range(this.nextMidRange,true);
}else{if(bf===this.nextPageThreshold){this.range(this.nextFullRange);
}else{if(bf===this.pullBackThreshold){if(this.offset===this.skip){this.range(this.previousMidRange);
}else{this.range(this.previousFullRange);
}}}}if(bg){return this.dataSource.at(bf-this.dataOffset);
}else{this.trigger("endreached",{index:bf});
return null;
}}},indexOf:function(bf){return this.dataSource.data().indexOf(bf)+this.dataOffset;
},total:function(){return parseInt(this.dataSource.total(),10);
},next:function(){var bf=this,bh=bf.pageSize,bg=bf.skip-bf.viewSize+bh,bi=ar.max(ar.floor(bg/bh),0)*bh;
this.offset=bg;
this.dataSource.prefetch(bi,bh,function(){bf._goToRange(bg,true);
});
},range:function(bi,bh){if(this.offset===bi){return true;
}var bf=this,bj=this.pageSize,bk=ar.max(ar.floor(bi/bj),0)*bj,bg=this.dataSource;
if(bh){bk+=bj;
}if(bg.inRange(bi,bj)){this.offset=bi;
this._recalculate();
this._goToRange(bi);
return true;
}else{if(this.prefetch){bg.prefetch(bk,bj,function(){bf.offset=bi;
bf._recalculate();
bf._goToRange(bi,true);
});
return false;
}}return true;
},syncDataSource:function(){var bf=this.offset;
this.offset=null;
this.range(bf);
},destroy:function(){this.unbind();
},_prefetch:function(){var bf=this,bh=this.pageSize,bi=this.skip+bh,bg=this.dataSource;
if(!bg.inRange(bi,bh)&&!this._prefetching&&this.prefetch){this._prefetching=true;
this.trigger("prefetching",{skip:bi,take:bh});
bg.prefetch(bi,bh,function(){bf._prefetching=false;
bf.trigger("prefetched",{skip:bi,take:bh});
});
}},_goToRange:function(bg,bf){if(this.offset!==bg){return;
}this.dataOffset=bg;
this._expanding=bf;
this.dataSource.range(bg,this.pageSize);
this.dataSource.enableRequestsInProgress();
},_reset:function(){this._syncPending=true;
},_change:function(){var bf=this.dataSource;
this.length=this.useRanges?bf.lastRange().end:bf.view().length;
if(this._syncPending){this._syncWithDataSource();
this._recalculate();
this._syncPending=false;
this.trigger("reset",{offset:this.offset});
}this.trigger("resize");
if(this._expanding){this.trigger("expand");
}delete this._expanding;
},_syncWithDataSource:function(){var bf=this.dataSource;
this._firstItemUid=bf.firstItemUid();
this.dataOffset=this.offset=bf.skip()||0;
this.pageSize=bf.pageSize();
this.useRanges=bf.options.serverPaging;
},_recalculate:function(){var bg=this.pageSize,bf=this.offset,bi=this.viewSize,bh=Math.ceil(bf/bg)*bg;
this.skip=bh;
this.midPageThreshold=bh+bg-1;
this.nextPageThreshold=bh+bi-1;
this.prefetchThreshold=bh+Math.floor(bg/3*2);
this.pullBackThreshold=this.offset-1;
this.nextMidRange=bh+bg-bi;
this.nextFullRange=bh;
this.previousMidRange=bf-bi;
this.previousFullRange=bh-bg;
}});
var n=an.Observable.extend({init:function(bh,bg){var bf=this;
an.Observable.fn.init.call(bf);
this.dataSource=bh;
this.batchSize=bg;
this._total=0;
this.buffer=new o(bh,bg*3);
this.buffer.bind({endreached:function(bi){bf.trigger("endreached",{index:bi.index});
},prefetching:function(bi){bf.trigger("prefetching",{skip:bi.skip,take:bi.take});
},prefetched:function(bi){bf.trigger("prefetched",{skip:bi.skip,take:bi.take});
},reset:function(){bf._total=0;
bf.trigger("reset");
},resize:function(){bf._total=Math.ceil(this.length/bf.batchSize);
bf.trigger("resize",{total:bf.total(),offset:this.offset});
}});
},syncDataSource:function(){this.buffer.syncDataSource();
},at:function(bh){var bf=this.buffer,bj=bh*this.batchSize,bk=this.batchSize,bl=[],bi;
if(bf.offset>bj){bf.at(bf.offset-1);
}for(var bg=0;
bg<bk;
bg++){bi=bf.at(bj+bg);
if(bi===null){break;
}bl.push(bi);
}return bl;
},total:function(){return this._total;
},destroy:function(){this.buffer.destroy();
this.unbind();
}});
N(true,an.data,{readers:{json:D},Query:aO,DataSource:E,HierarchicalDataSource:Y,Node:aw,ObservableObject:aG,ObservableArray:aF,LazyObservableArray:ao,LocalTransport:ap,RemoteTransport:aR,Cache:p,DataReader:D,Model:au,Buffer:o,BatchBuffer:n});
}(window.kendo.jQuery));
return window.kendo;
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
window.$=h;
window.jQuery=i;
})($telerik.$,$telerik.$);
window.$=c;
window.jQuery=d;
})($telerik.$,$telerik.$);
