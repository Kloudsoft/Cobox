(function(b,a,e){var d=window.jQuery,c=window.$;
window.$=window.jQuery=a;
(function(g,f,j){var i=window.jQuery,h=window.$;
window.$=window.jQuery=f;
(function(l,k){k("util/undoredostack",["kendo.core"],l);
}(function(){(function(k){var l=k.Observable.extend({init:function(m){k.Observable.fn.init.call(this,m);
this.clear();
},events:["undo","redo"],push:function(m){this.stack=this.stack.slice(0,this.currentCommandIndex+1);
this.currentCommandIndex=this.stack.push(m)-1;
},undo:function(){if(this.canUndo()){var m=this.stack[this.currentCommandIndex--];
m.undo();
this.trigger("undo",{command:m});
}},redo:function(){if(this.canRedo()){var m=this.stack[++this.currentCommandIndex];
m.redo();
this.trigger("redo",{command:m});
}},clear:function(){this.stack=[];
this.currentCommandIndex=-1;
},canUndo:function(){return this.currentCommandIndex>=0;
},canRedo:function(){return this.currentCommandIndex!=this.stack.length-1;
}});
k.deepExtend(k,{util:{UndoRedoStack:l}});
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("util/main",["kendo.core"],l);
}(function(){(function(){var A=Math,x=window.kendo,p=x.deepExtend;
var s=A.PI/180,B=Number.MAX_VALUE,D=-Number.MAX_VALUE,W="undefined";
function q(Y){return typeof Y!==W;
}function P(aa,Z){var Y=G(Z);
return A.round(aa*Y)/Y;
}function G(Y){if(Y){return A.pow(10,Y);
}else{return 1;
}}function z(aa,Z,Y){return A.max(A.min(aa,Y),Z);
}function H(Y){return Y*s;
}function r(Y){return Y/s;
}function v(Y){return typeof Y==="number"&&!isNaN(Y);
}function X(Z,Y){return q(Z)?Z:Y;
}function T(Y){return Y*Y;
}function F(Z){var aa=[];
for(var Y in Z){aa.push(Y+Z[Y]);
}return aa.sort().join("");
}function t(aa){var Y=2166136261;
for(var Z=0;
Z<aa.length;
++Z){Y+=(Y<<1)+(Y<<4)+(Y<<7)+(Y<<8)+(Y<<24);
Y^=aa.charCodeAt(Z);
}return Y>>>0;
}function u(Y){return t(F(Y));
}var E=Date.now;
if(!E){E=function(){return new Date().getTime();
};
}function m(Y){var aa=Y.length,Z,ac=B,ab=D;
for(Z=0;
Z<aa;
Z++){ab=A.max(ab,Y[Z]);
ac=A.min(ac,Y[Z]);
}return{min:ac,max:ab};
}function o(Y){return m(Y).min;
}function n(Y){return m(Y).max;
}function S(Y){return Q(Y).min;
}function R(Y){return Q(Y).max;
}function Q(Y){var ac=B,ab=D;
for(var Z=0,aa=Y.length;
Z<aa;
Z++){var ad=Y[Z];
if(ad!==null&&isFinite(ad)){ac=A.min(ac,ad);
ab=A.max(ab,ad);
}}return{min:ac===B?j:ac,max:ab===D?j:ab};
}function y(Y){if(Y){return Y[Y.length-1];
}}function k(Y,Z){Y.push.apply(Y,Z);
return Y;
}function N(Y){return x.template(Y,{useWithBlock:false,paramName:"d"});
}function J(Y,Z){return q(Z)&&Z!==null?" "+Y+"='"+Z+"' ":"";
}function I(Y){var aa="";
for(var Z=0;
Z<Y.length;
Z++){aa+=J(Y[Z][0],Y[Z][1]);
}return aa;
}function M(Y){var aa="";
for(var Z=0;
Z<Y.length;
Z++){var ab=Y[Z][1];
if(q(ab)){aa+=Y[Z][0]+":"+ab+";";
}}if(aa!==""){return aa;
}}function L(Y){if(typeof Y!=="string"){Y+="px";
}return Y;
}function K(aa){var ab=[];
if(aa){var Z=x.toHyphens(aa).split("-");
for(var Y=0;
Y<Z.length;
Y++){ab.push("k-pos-"+Z[Y]);
}}return ab.join(" ");
}function w(Y){return Y===""||Y===null||Y==="none"||Y==="transparent"||!q(Y);
}function l(Z){var Y={1:"i",10:"x",100:"c",2:"ii",20:"xx",200:"cc",3:"iii",30:"xxx",300:"ccc",4:"iv",40:"xl",400:"cd",5:"v",50:"l",500:"d",6:"vi",60:"lx",600:"dc",7:"vii",70:"lxx",700:"dcc",8:"viii",80:"lxxx",800:"dccc",9:"ix",90:"xc",900:"cm",1000:"m"};
var ab=[1000,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1];
var aa="";
while(Z>0){if(Z<ab[0]){ab.shift();
}else{aa+=Y[ab[0]];
Z-=ab[0];
}}return aa;
}function O(ab){ab=ab.toLowerCase();
var Y={i:1,v:5,x:10,l:50,c:100,d:500,m:1000};
var ad=0,aa=0;
for(var Z=0;
Z<ab.length;
++Z){var ac=Y[ab.charAt(Z)];
if(!ac){return null;
}ad+=ac;
if(ac>aa){ad-=2*aa;
}aa=ac;
}return ad;
}function C(Z){var Y=Object.create(null);
return function(){var ab="";
for(var aa=arguments.length;
--aa>=0;
){ab+=":"+arguments[aa];
}if(ab in Y){return Y[ab];
}return Z.apply(this,arguments);
};
}function U(ac){var ab=[],Y=0,aa=ac.length,ad,Z;
while(Y<aa){ad=ac.charCodeAt(Y++);
if(ad>=55296&&ad<=56319&&Y<aa){Z=ac.charCodeAt(Y++);
if((Z&64512)==56320){ab.push(((ad&1023)<<10)+(Z&1023)+65536);
}else{ab.push(ad);
Y--;
}}else{ab.push(ad);
}}return ab;
}function V(Y){return Y.map(function(aa){var Z="";
if(aa>65535){aa-=65536;
Z+=String.fromCharCode(aa>>>10&1023|55296);
aa=56320|aa&1023;
}Z+=String.fromCharCode(aa);
return Z;
}).join("");
}p(x,{util:{MAX_NUM:B,MIN_NUM:D,append:k,arrayLimits:m,arrayMin:o,arrayMax:n,defined:q,deg:r,hashKey:t,hashObject:u,isNumber:v,isTransparent:w,last:y,limitValue:z,now:E,objectKey:F,round:P,rad:H,renderAttr:J,renderAllAttr:I,renderPos:K,renderSize:L,renderStyle:M,renderTemplate:N,sparseArrayLimits:Q,sparseArrayMin:S,sparseArrayMax:R,sqr:T,valueOrDefault:X,romanToArabic:O,arabicToRoman:l,memoize:C,ucs2encode:V,ucs2decode:U}});
x.drawing.util=x.util;
x.dataviz.util=x.util;
}());
return window.kendo;
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("util/text-metrics",["kendo.core","util/main"],l);
}(function(){(function(k){var o=document,p=window.kendo,l=p.Class,u=p.util,n=u.defined;
var r=l.extend({init:function(w){this._size=w;
this._length=0;
this._map={};
},put:function(x,A){var y=this,z=y._map,w={key:x,value:A};
z[x]=w;
if(!y._head){y._head=y._tail=w;
}else{y._tail.newer=w;
w.older=y._tail;
y._tail=w;
}if(y._length>=y._size){z[y._head.key]=null;
y._head=y._head.newer;
y._head.older=null;
}else{y._length++;
}},get:function(x){var y=this,w=y._map[x];
if(w){if(w===y._head&&w!==y._tail){y._head=w.newer;
y._head.older=null;
}if(w!==y._tail){if(w.older){w.older.newer=w.newer;
w.newer.older=w.older;
}w.older=y._tail;
w.newer=null;
y._tail.newer=w;
y._tail=w;
}return w.value;
}}});
var m=k("<div style='position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;padding: 0 !important; margin: 0 !important; border: 0 !important;line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;' />")[0];
function v(){return{width:0,height:0,baseline:0};
}var t=l.extend({init:function(w){this._cache=new r(1000);
this._initOptions(w);
},options:{baselineMarkerSize:1},measure:function(F,D,x){if(!F){return v();
}var E=u.objectKey(D),z=u.hashKey(F+E),y=this._cache.get(z);
if(y){return y;
}var C=v();
var B=x?x:m;
var w=this._baselineMarker().cloneNode(false);
for(var A in D){var G=D[A];
if(n(G)){B.style[A]=G;
}}k(B).text(F);
B.appendChild(w);
o.body.appendChild(B);
if((F+"").length){C.width=B.offsetWidth-this.options.baselineMarkerSize;
C.height=B.offsetHeight;
C.baseline=w.offsetTop+this.options.baselineMarkerSize;
}if(C.width>0&&C.height>0){this._cache.put(z,C);
}B.parentNode.removeChild(B);
return C;
},_baselineMarker:function(){return k("<div class='k-baseline-marker' style='display: inline-block; vertical-align: baseline;width: "+this.options.baselineMarkerSize+"px; height: "+this.options.baselineMarkerSize+"px;overflow: hidden;' />")[0];
}});
t.current=new t();
function s(y,x,w){return t.current.measure(y,x,w);
}function q(y,w){var z=[];
if(y.length>0&&document.fonts){try{z=y.map(function(A){return document.fonts.load(A);
});
}catch(x){p.logToConsole(x);
}Promise.all(z).then(w,w);
}else{w();
}}p.util.TextMetrics=t;
p.util.LRUCache=r;
p.util.loadFonts=q;
p.util.measureText=s;
}(window.kendo.jQuery));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("util/parse-xml",["kendo.core","util/main"],l);
}(function(){var G=String.fromCharCode;
var s={amp:38,lt:60,gt:62,quot:34,nbsp:160};
function m(L){var K=[];
for(var J=0;
J<L.length;
++J){K.push(L.charCodeAt(J));
}return K;
}function H(K,J){if(J>65535){J-=65536;
K.push(J>>>10&1023|55296,56320|J&1023);
}else{K.push(J);
}}var E=m("<![CDATA[");
var n=m("]]>");
var o=m("-->");
var F=m("!--");
var q=m("/>");
var r=m("</");
var p=m("?>");
var A=m("?");
var w=m("<");
var v=m(">");
var C=m(";");
var t=m("=");
var k=m("&");
var B=m('"');
var l=m("'");
var D=m("#");
var x=m("x");
var I=m("X");
var u={};
function y(M,K){var O=0;
var aa=[];
var U={is:function(am){var ak=aa.length,al=am.length;
while(--ak>=0&&--al>=0){if(aa[ak].$tag!=am[al]&&am[al]!="*"){return false;
}}return al<0?aa[aa.length-1]:null;
},exit:function(){throw u;
},stack:aa};
function W(ak){var al=M[O++];
if(!(al&240^240)){H(ak,(al&3)<<18|(M[O++]&63)<<12|(M[O++]&63)<<6|M[O++]&63);
}else{if(!(al&224^224)){H(ak,(al&15)<<12|(M[O++]&63)<<6|M[O++]&63);
}else{if(!(al&192^192)){H(ak,(al&31)<<6|M[O++]&63);
}else{ak.push(al);
}}}}function L(ak){throw new Error(ak+", at "+O);
}function X(al){var ak=[];
while(O<M.length&&al(M[O])){ak.push(M[O++]);
}return ak;
}function V(ak){return G.apply(0,X(ak));
}function Z(){X(T);
}function N(ak){var am=O;
for(var al=0;
al<ak.length;
++al){if(M[O++]!=ak[al]){O=am;
return false;
}}return ak;
}function Y(ak){if(!N(ak)){L("Expecting "+ak.join(", "));
}}function T(ak){return ak==9||ak==10||ak==13||ak==32;
}function P(ak){return ak>=48&&ak<=57;
}function Q(ak){return ak>=48&&ak<=57||(ak|=32)>=97&&ak<=102;
}function S(ak){return ak==58||ak==95||(ak|=32)>=97&&ak<=122;
}function R(ak){return ak==45||P(ak)||S(ak);
}function ad(){var ak=[];
while(O<M.length){if(N(o)){return J("comment",G.apply(0,ak));
}W(ak);
}}function aj(){var al,ak;
if(N(A)){af();
}else{if(N(F)){ad();
}else{al=ah();
ak=ac(al);
aa.push(ak);
if(N(q)){J("enter",al,ak,true);
}else{Y(v);
J("enter",al,ak);
ae(al);
if(al!=ah()){L("Bad closing tag");
}J("leave",al,ak);
Z();
Y(v);
}aa.pop();
}}}function ae(al){var ak=[];
while(O<M.length){if(N(r)){return ak.length&&J("text",G.apply(0,ak));
}else{if(N(E)){while(O<M.length&&!N(n)){W(ak);
}}else{if(N(w)){if(ak.length){J("text",G.apply(0,ak));
}aj();
ak=[];
}else{if(N(k)){ag(ak);
}else{W(ak);
}}}}}L("Unclosed tag "+al);
}function ah(){if(!S(M[O])){L("Expecting XML name");
}return V(R);
}function ai(){var al=N(B)||N(l);
if(!al){L("Expecting string");
}var ak=[];
while(O<M.length){if(N(al)){return G.apply(0,ak);
}else{if(N(k)){ag(ak);
}else{W(ak);
}}}L("Unfinished string");
}function ag(ak){var al;
if(N(D)){if(N(x)||N(I)){al=parseInt(V(Q),16);
}else{al=parseInt(V(P),10);
}if(isNaN(al)){L("Bad numeric entity");
}}else{var am=ah();
al=s[am];
if(al===j){L("Unknown entity "+am);
}}H(ak,al);
Y(C);
}function af(){J("decl",ah(),ac());
Y(p);
}function ac(am){var al={$tag:am};
while(O<M.length){Z();
var ak=M[O];
if(ak==63||ak==62||ak==47){break;
}al[ah()]=(Y(t),ai());
}return al;
}function J(ao,an,ak,al){var am=K&&K[ao];
if(am){am.call(U,an,ak,al);
}}var ab=[];
W(ab);
if(ab[0]!=65279){O=0;
}while(O<M.length){Z();
Y(w);
aj();
Z();
}}kendo.util.parseXML=function z(){try{return y.apply(this,arguments);
}catch(J){if(J!==u){throw J;
}}};
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("util/base64",["util/main"],l);
}(function(){(function(){var o=window.kendo,k=o.deepExtend,n=String.fromCharCode;
var p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
function l(y){var z="";
var q,r,s,t,u,v,w;
var x=0;
y=m(y);
while(x<y.length){q=y.charCodeAt(x++);
r=y.charCodeAt(x++);
s=y.charCodeAt(x++);
t=q>>2;
u=(q&3)<<4|r>>4;
v=(r&15)<<2|s>>6;
w=s&63;
if(isNaN(r)){v=w=64;
}else{if(isNaN(s)){w=64;
}}z=z+p.charAt(t)+p.charAt(u)+p.charAt(v)+p.charAt(w);
}return z;
}function m(s){var t="";
for(var r=0;
r<s.length;
r++){var q=s.charCodeAt(r);
if(q<128){t+=n(q);
}else{if(q<2048){t+=n(192|q>>>6);
t+=n(128|q&63);
}else{if(q<65536){t+=n(224|q>>>12);
t+=n(128|q>>>6&63);
t+=n(128|q&63);
}}}}return t;
}k(o.util,{encodeBase64:l,encodeUTF8:m});
}());
return window.kendo;
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("mixins/observers",["kendo.core"],l);
}(function(){(function(k){var o=Math,n=window.kendo,l=n.deepExtend,m=k.inArray;
var p={observers:function(){this._observers=this._observers||[];
return this._observers;
},addObserver:function(q){if(!this._observers){this._observers=[q];
}else{this._observers.push(q);
}return this;
},removeObserver:function(q){var s=this.observers();
var r=m(q,s);
if(r!=-1){s.splice(r,1);
}return this;
},trigger:function(s,q){var u=this._observers;
var t;
var r;
if(u&&!this._suspended){for(r=0;
r<u.length;
r++){t=u[r];
if(t[s]){t[s](q);
}}}return this;
},optionsChange:function(q){this.trigger("optionsChange",q);
},geometryChange:function(q){this.trigger("geometryChange",q);
},suspend:function(){this._suspended=(this._suspended||0)+1;
return this;
},resume:function(){this._suspended=o.max((this._suspended||0)-1,0);
return this;
},_observerField:function(q,r){if(this[q]){this[q].removeObserver(this);
}this[q]=r;
r.addObserver(this);
}};
l(n,{mixins:{ObserversMixin:p}});
}(window.kendo.jQuery));
return window.kendo;
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/commands",["kendo.core","kendo.binder","kendo.window","kendo.list","kendo.tabstrip"],l);
}(function(){(function(p){if(p.support.browser.msie&&p.support.browser.version<9){return;
}var k=p.jQuery;
var n=p.spreadsheet.Command=p.Class.extend({init:function(r){this.options=r;
this._workbook=r.workbook;
this._property=r&&r.property;
this._state={};
},range:function(r){if(r!==j){this._range=r;
}return this._range;
},redo:function(){this.exec();
},undo:function(){this.range().setState(this._state);
},getState:function(){this._state=this.range().getState(this._property);
},_forEachCell:function(r){var s=this.range();
var t=s._ref;
t.forEach(function(u){s.sheet().forEach(u.toRangeRef(),r.bind(this));
}.bind(this));
}});
var q=p.spreadsheet.PropertyChangeCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this._value=r.value;
},exec:function(){var r=this.range();
this.getState();
r[this._property](this._value);
}});
p.spreadsheet.ClearContentCommand=n.extend({exec:function(){this.getState();
this.range().clearContent();
}});
p.spreadsheet.EditCommand=q.extend({init:function(r){r.property="input";
q.fn.init.call(this,r);
},rejectState:function(r){this.undo();
return{title:r.title,body:r.message,reason:"error",type:"validationError"};
},exec:function(){var t=this.range();
var v=this._value;
this.getState();
try{t.input(v);
var u=t._getValidationState();
if(u){return this.rejectState(u);
}}catch(r){if(r instanceof p.spreadsheet.calc.ParseError){try{t.input(v+")");
var u=t._getValidationState();
if(u){return this.rejectState(u);
}}catch(s){if(s instanceof p.spreadsheet.calc.ParseError){t.input("'"+v);
return{title:"Error in formula",body:r+"",reason:"error"};
}}}else{throw r;
}}}});
p.spreadsheet.TextWrapCommand=q.extend({init:function(r){r.property="wrap";
q.fn.init.call(this,r);
this._value=r.value;
},getState:function(){var r={};
this.range().forEachRow(function(t){var s=t.topLeft().row;
r[s]=t.sheet().rowHeight(s);
});
this._state=this.range().getState(this._property);
this._rowHeight=r;
},undo:function(){var t=this.range().sheet();
var s=this._rowHeight;
this.range().setState(this._state);
for(var r in s){t.rowHeight(r,s[r]);
}}});
p.spreadsheet.AdjustDecimalsCommand=n.extend({init:function(r){this._decimals=r.value;
r.property="format";
n.fn.init.call(this,r);
},exec:function(){var t=this.range().sheet();
var r=this._decimals;
var s=p.spreadsheet.formatting;
this.getState();
t.batch(function(){this.range().forEachCell(function(x,v,u){var w=u.format;
if(w||r>0){w=s.adjustDecimals(w||"#",r);
t.range(x,v).format(w);
}});
}.bind(this));
}});
p.spreadsheet.BorderChangeCommand=n.extend({init:function(r){r.property="border";
n.fn.init.call(this,r);
this._type=r.border;
this._style=r.style;
},exec:function(){this.getState();
this[this._type](this._style);
},noBorders:function(){var r=this.range();
r.sheet().batch(function(){r.borderLeft(null).borderTop(null).borderRight(null).borderBottom(null);
}.bind(this),{});
},allBorders:function(s){var r=this.range();
r.sheet().batch(function(){r.borderLeft(s).borderTop(s).borderRight(s).borderBottom(s);
}.bind(this),{});
},leftBorder:function(r){this.range().leftColumn().borderLeft(r);
},rightBorder:function(r){this.range().rightColumn().borderRight(r);
},topBorder:function(r){this.range().topRow().borderTop(r);
},bottomBorder:function(r){this.range().bottomRow().borderBottom(r);
},outsideBorders:function(s){var r=this.range();
r.sheet().batch(function(){r.leftColumn().borderLeft(s);
r.topRow().borderTop(s);
r.rightColumn().borderRight(s);
r.bottomRow().borderBottom(s);
}.bind(this),{});
},insideBorders:function(r){this.range().sheet().batch(function(){this.allBorders(r);
this.outsideBorders(null);
}.bind(this),{});
},insideHorizontalBorders:function(s){var r=this.range();
r.sheet().batch(function(){r.borderBottom(s);
r.bottomRow().borderBottom(null);
}.bind(this),{});
},insideVerticalBorders:function(s){var r=this.range();
r.sheet().batch(function(){r.borderRight(s);
r.rightColumn().borderRight(null);
}.bind(this),{});
}});
p.spreadsheet.MergeCellCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this._type=r.value;
},exec:function(){this.getState();
this[this._type]();
},activate:function(r){this.range().sheet().activeCell(r);
},getState:function(){this._state=this.range().getState();
},undo:function(){if(this._type!=="unmerge"){this.range().unmerge();
this.activate(this.range().topLeft());
}this.range().setState(this._state);
},cells:function(){var r=this.range();
var s=r._ref;
r.merge();
this.activate(s);
},horizontally:function(){var r=this.range().topRow()._ref;
this.range().forEachRow(function(s){s.merge();
});
this.activate(r);
},vertically:function(){var r=this.range().leftColumn()._ref;
this.range().forEachColumn(function(s){s.merge();
});
this.activate(r);
},unmerge:function(){var r=this.range();
var s=r._ref.topLeft;
r.unmerge();
this.activate(s);
}});
p.spreadsheet.FreezePanesCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this._type=r.value;
},exec:function(){this.getState();
this._topLeft=this.range().topLeft();
this[this._type]();
},getState:function(){this._state=this.range().sheet().getState();
},undo:function(){this.range().sheet().setState(this._state);
},panes:function(){var s=this._topLeft;
var r=this.range().sheet();
r.frozenColumns(s.col).frozenRows(s.row);
},rows:function(){var s=this._topLeft;
var r=this.range().sheet();
r.frozenRows(s.row);
},columns:function(){var s=this._topLeft;
var r=this.range().sheet();
r.frozenColumns(s.col);
},unfreeze:function(){var r=this.range().sheet();
r.frozenRows(0).frozenColumns(0);
}});
p.spreadsheet.PasteCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this._clipboard=this._workbook.clipboard();
},getState:function(){this._range=this._workbook.activeSheet().range(this._clipboard.pasteRef());
this._state=this._range.getState();
},exec:function(){var s=this._clipboard.canPaste();
this._clipboard.menuInvoked=true;
if(!s.canPaste){if(s.menuInvoked){return{reason:"useKeyboard"};
}if(s.pasteOnMerged){return{reason:"modifyMerged"};
}return;
}this.getState();
this._clipboard.paste();
var r=this._workbook.activeSheet().range(this._clipboard.pasteRef());
r._adjustRowHeight();
}});
p.spreadsheet.AdjustRowHeightCommand=n.extend({exec:function(){var r=this.options;
var t=this._workbook.activeSheet();
var s=r.range||t.range(r.rowIndex);
s._adjustRowHeight();
}});
p.spreadsheet.ToolbarPasteCommand=n.extend({exec:function(){if(p.support.clipboard.paste){this._workbook._view.clipboard.focus().select();
document.execCommand("paste");
}else{return{reason:"useKeyboard"};
}}});
p.spreadsheet.CopyCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this._clipboard=r.workbook.clipboard();
},undo:k.noop,exec:function(){var r=this._clipboard.canCopy();
this._clipboard.menuInvoked=true;
if(!r.canCopy){if(r.menuInvoked){return{reason:"useKeyboard"};
}else{if(r.multiSelection){return{reason:"unsupportedSelection"};
}}return;
}this._clipboard.copy();
}});
p.spreadsheet.ToolbarCopyCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this._clipboard=r.workbook.clipboard();
},undo:k.noop,exec:function(){if(p.support.clipboard.copy){var r=this._workbook._view.clipboard;
var s=document.createElement("textarea");
k(s).addClass("k-spreadsheet-clipboard").val(r.html()).appendTo(document.body).focus().select();
document.execCommand("copy");
r.trigger("copy");
k(s).remove();
}else{return{reason:"useKeyboard"};
}}});
p.spreadsheet.CutCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this._clipboard=r.workbook.clipboard();
},exec:function(){if(this._clipboard.canCopy()){this.getState();
this._clipboard.cut();
}}});
p.spreadsheet.AutoFillCommand=n.extend({init:function(r){n.fn.init.call(this,r);
},origin:function(r){this._origin=r;
},exec:function(){this.getState();
this.range().fillFrom(this._origin);
}});
p.spreadsheet.ToolbarCutCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this._clipboard=r.workbook.clipboard();
},exec:function(){if(p.support.clipboard.copy){var r=this._workbook._view.clipboard;
var s=document.createElement("textarea");
k(s).val(r.html()).appendTo(document.body).focus().select();
document.execCommand("copy");
r.trigger("cut");
k(s).remove();
}else{return{reason:"useKeyboard"};
}}});
p.spreadsheet.FilterCommand=n.extend({undo:function(){this.range().filter(this._state);
},exec:function(){var r=this.range();
this._state=r.hasFilter();
if(r.hasFilter()){r.filter(false);
}else{if(!r.intersectingMerged().length){r.filter(true);
}else{return{reason:"error",type:"filterRangeContainingMerges"};
}}}});
p.spreadsheet.SortCommand=n.extend({undo:function(){var r=this.range().sheet();
r.setState(this._state);
},exec:function(){var u=this.range();
var v=u.sheet();
var r=v.activeCell();
var t=this.options.sheet?r.topLeft.col:this.options.column||0;
var s=this.options.value==="asc"?true:false;
this._state=v.getState();
if(this.options.sheet){u=this.expandRange();
}if(!u.intersectingMerged().length){u.sort({column:t,ascending:s});
}else{return{reason:"error",type:"sortRangeContainingMerges"};
}},expandRange:function(){var r=this.range().sheet();
return new p.spreadsheet.Range(r._sheetRef,r);
}});
var m=p.spreadsheet.ApplyFilterCommand=n.extend({column:function(){return this.options.column||0;
},undo:function(){var r=this.range().sheet();
r.clearFilter(this.column());
if(this._state.length){this.range().filter(this._state);
}},getState:function(){var s=this.range().sheet();
var r=s.filter();
if(r){this._state=r.columns.filter(function(t){return t.index==this.column();
}.bind(this));
}},exec:function(){var w=this.range();
var r=this.column();
var s=w.sheet().filter();
var v;
var u;
var t=false;
if(this.options.valueFilter){u={column:r,filter:new p.spreadsheet.ValueFilter(this.options.valueFilter)};
}else{if(this.options.customFilter){u={column:r,filter:new p.spreadsheet.CustomFilter(this.options.customFilter)};
}}this.getState();
if(s&&s.ref.eq(w._ref)&&s.columns.length){s.columns.forEach(function(x){if(x.index===r){t=true;
}});
v=s.columns.map(function(x){return x.index===r?u:{column:x.index,filter:x.filter};
});
if(!t){v.push(u);
}}else{v=u;
}w.filter(v);
}});
p.spreadsheet.ClearFilterCommand=m.extend({exec:function(){var s=this.range();
var r=this.column();
this.getState();
s.clearFilter(r);
}});
p.spreadsheet.HideLineCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this.axis=r.axis;
},undo:function(){var r=this.range().sheet();
r.setAxisState(this._state);
},exec:function(){var r=this.range().sheet();
this._state=r.getAxisState();
if(this.axis=="row"){r.axisManager().hideSelectedRows();
}else{r.axisManager().hideSelectedColumns();
}}});
p.spreadsheet.UnHideLineCommand=p.spreadsheet.HideLineCommand.extend({exec:function(){var r=this.range().sheet();
this._state=r.getAxisState();
if(this.axis=="row"){r.axisManager().unhideSelectedRows();
}else{r.axisManager().unhideSelectedColumns();
}}});
var o=p.spreadsheet.DeleteCommand=n.extend({undo:function(){var r=this.range().sheet();
r.setState(this._state);
}});
p.spreadsheet.DeleteRowCommand=o.extend({exec:function(){var r=this.range().sheet();
this._state=r.getState();
r.axisManager().deleteSelectedRows();
}});
p.spreadsheet.DeleteColumnCommand=o.extend({exec:function(){var r=this.range().sheet();
this._state=r.getState();
r.axisManager().deleteSelectedColumns();
}});
var l=n.extend({init:function(r){n.fn.init.call(this,r);
this._value=r.value;
},undo:function(){var r=this.range().sheet();
r.setState(this._state);
}});
p.spreadsheet.AddColumnCommand=l.extend({exec:function(){var r=this.range().sheet();
this._state=r.getState();
if(this._value==="left"){r.axisManager().addColumnLeft();
}else{r.axisManager().addColumnRight();
}}});
p.spreadsheet.AddRowCommand=l.extend({exec:function(){var r=this.range().sheet();
if(!r.axisManager().canAddRow()){return{reason:"error",type:"shiftingNonblankCells"};
}this._state=r.getState();
if(this._value==="above"){r.axisManager().addRowAbove();
}else{r.axisManager().addRowBelow();
}}});
p.spreadsheet.EditValidationCommand=n.extend({init:function(r){n.fn.init.call(this,r);
this._value=r.value;
},exec:function(){this.range().validation(this._value);
}});
p.spreadsheet.OpenCommand=n.extend({exec:function(){var r=this.options.file;
if(r.name.match(/.xlsx$/i)===null){return{reason:"error",type:"openUnsupported"};
}this.options.workbook.fromFile(this.options.file);
}});
p.spreadsheet.SaveAsCommand=n.extend({exec:function(){var r=this.options.name+this.options.extension;
if(this.options.extension===".xlsx"){this.options.workbook.saveAsExcel({fileName:r});
}else{if(this.options.extension===".pdf"){this.options.workbook.saveAsPDF(k.extend(this.options.pdf,{workbook:this.options.workbook,fileName:r}));
}}}});
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/formulabar",["kendo.core"],l);
}(function(){(function(n){if(n.support.browser.msie&&n.support.browser.version<9){return;
}var k=n.jQuery;
var l={wrapper:"k-spreadsheet-formula-bar"};
var m=n.ui.Widget.extend({init:function(o,p){n.ui.Widget.call(this,o,p);
o=this.element.addClass(m.classNames.wrapper);
this.formulaInput=new n.spreadsheet.FormulaInput(k("<div/>").appendTo(o));
},destroy:function(){if(this.formulaInput){this.formulaInput.destroy();
}this.formulaInput=null;
}});
n.spreadsheet.FormulaBar=m;
k.extend(true,m,{classNames:l});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/formulainput",["kendo.core"],l);
}(function(){(function(r,A){if(r.support.browser.msie&&r.support.browser.version<9){return;
}var k=r.jQuery;
var z=r.ui.Widget;
var v=".kendoFormulaInput";
var t=r.keys;
var l={wrapper:"k-spreadsheet-formula-input",listWrapper:"k-spreadsheet-formula-list"};
var x=["font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","text-transform","line-height"];
var s={27:"esc",37:"left",39:"right",35:"end",36:"home",32:"spacebar"};
var w=/(^_|[^a-z0-9]$)/i;
var m=z.extend({init:function(B,C){z.call(this,B,C);
B=this.element;
B.addClass(m.classNames.wrapper).attr("contenteditable",true).attr("spellcheck",false);
if(this.options.autoScale){B.on("input",this.scale.bind(this));
}this._highlightedRefs=[];
this._staticTokens=[];
this._formulaSource();
this._formulaList();
this._popup();
this._tooltip();
B.on("keydown",this._keydown.bind(this)).on("keyup",this._keyup.bind(this)).on("blur",this._blur.bind(this)).on("input click",this._input.bind(this)).on("focus",this._focus.bind(this));
},options:{name:"FormulaInput",autoScale:false,filterOperator:"startswith",scalePadding:30,minLength:1},events:["keyup","focus"],enable:function(B){if(B===j){return this.element.attr("contenteditable")==="false"?false:true;
}this.element.attr("contenteditable",B).toggleClass("k-state-disabled",!B);
},getPos:function(){var D=this.element[0];
var F=A.getSelection();
var B=E(F.focusNode,F.focusOffset);
var C=E(F.anchorNode,F.anchorOffset);
if(B!=null&&C!=null){if(B>C){var G=B;
B=C;
C=G;
}return{begin:B,end:C,collapsed:B==C};
}function E(I,K){try{(function J(M){if(M===I){throw K;
}else{if(M.nodeType==1){for(var L=M.firstChild;
L;
L=L.nextSibling){J(L);
}}else{if(M.nodeType==3){K+=M.nodeValue.length;
}}}}(D));
}catch(H){return H;
}}},setPos:function(B,D){var C=this.element[0];
B=E(C,B);
if(D!=null){D=E(C,D);
}else{D=B;
}if(B&&D){var F=document.createRange();
F.setStart(B.node,B.pos);
F.setEnd(D.node,D.pos);
var G=A.getSelection();
G.removeAllRanges();
G.addRange(F);
}function E(J,K){try{(function I(N){if(N.nodeType==3){var M=N.nodeValue.length;
if(M>=K){throw N;
}K-=M;
}else{if(N.nodeType==1){for(var L=N.firstChild;
L;
L=L.nextSibling){I(L);
}}}}(J));
}catch(H){return{node:H,pos:K};
}}},end:function(){this.setPos(this.length());
},home:function(){this.setPos(0);
},length:function(){return this.value().length;
},_formulaSource:function(){var C=[];
var D;
for(var B in r.spreadsheet.calc.runtime.FUNCS){if(!w.test(B)){D=B.toUpperCase();
C.push({value:D,text:D});
}}this.formulaSource=new r.data.DataSource({data:C});
},_formulaList:function(){this.list=new r.ui.StaticList(k("<ul />").addClass(m.classNames.listWrapper).insertAfter(this.element),{autoBind:false,selectable:true,change:this._formulaListChange.bind(this),dataSource:this.formulaSource,dataValueField:"value",template:"#:data.value#"});
this.list.element.on("mousedown",function(B){B.preventDefault();
});
},_formulaListChange:function(){var E=this._tokenContext();
if(!E||this._mute){return;
}var B=E.token;
var C=this.list.value()[0];
var D={replace:true,token:B,end:B.end};
if(!E.nextToken||E.nextToken.value!="("){C+="(";
}this._replaceAt(D,C);
this.popup.close();
},_popup:function(){this.popup=new r.ui.Popup(this.list.element,{anchor:this.element});
},_blur:function(){this.popup.close();
clearTimeout(this._focusId);
},_isFormula:function(){return/^=/.test(this.value());
},_keydown:function(B){var C=B.keyCode;
if(s[C]){this.popup.close();
this._navigated=true;
}else{if(this._move(C)){this._navigated=true;
B.preventDefault();
}}this._keyDownTimeout=setTimeout(this._syntaxHighlight.bind(this));
},_keyup:function(){var B=this.popup;
var C;
if(this._isFormula()&&!this._navigated){C=((this._tokenContext()||{}).token||{}).value;
this.filter(C);
if(!C||!this.formulaSource.view().length){B.close();
}else{B[B.visible()?"position":"open"]();
this.list.focusFirst();
}}this._navigated=false;
this._syntaxHighlight();
this.trigger("keyup");
},_input:function(){this._syntaxHighlight();
},_focus:function(){this._focusTimeout=setTimeout(this._syntaxHighlight.bind(this));
this.trigger("focus");
},_move:function(B){var C=this.list;
var E=false;
var D=this.popup;
if(B===t.DOWN){C.focusNext();
if(!C.focus()){C.focusFirst();
}E=true;
}else{if(B===t.UP){C.focusPrev();
if(!C.focus()){C.focusLast();
}E=true;
}else{if(B===t.ENTER){if(D.visible()){C.select(C.focus());
}D.close();
E=true;
}else{if(B===t.TAB){C.select(C.focus());
D.close();
E=true;
}else{if(B===t.PAGEUP){C.focusFirst();
E=true;
}else{if(B===t.PAGEDOWN){C.focusLast();
E=true;
}}}}}}return E;
},_tokenContext:function(){var C=this.getPos();
var F=this.value();
if(!F||!C||!C.collapsed){return null;
}var E=r.spreadsheet.calc.tokenize(F,this.row(),this.col());
var D;
for(var B=0;
B<E.length;
++B){D=E[B];
if(y(D,C)&&/^(?:str|sym|func)$/.test(D.type)){return{token:D,nextToken:E[B+1]};
}}return null;
},_sync:function(){if(this._editorToSync&&this.isActive()){this._editorToSync.value(this.value());
}},_textContainer:function(){var B=r.getComputedStyles(this.element[0],x);
B.position="absolute";
B.visibility="hidden";
B.whiteSpace="pre";
B.top=-3333;
B.left=-3333;
this._span=k("<span/>").css(B).insertAfter(this.element);
},_tooltip:function(){this._cellTooltip=k('<div class="k-widget k-tooltip" style="position:absolute; display:none">A1</div>').insertAfter(this.element);
},tooltip:function(B){this._cellTooltip.text(B);
},toggleTooltip:function(B){this._cellTooltip.toggle(B);
},isActive:function(){return this.element[0]===r._activeElement();
},filter:function(B){if(!B||B.length<this.options.minLength){return;
}this._mute=true;
this.list.select(-1);
this._mute=false;
this.formulaSource.filter({field:this.list.options.dataValueField,operator:this.options.filterOperator,value:B});
},hide:function(){this.element.hide();
this._cellTooltip.hide();
},show:function(){this.element.show();
},row:function(){if(this.activeCell){return this.activeCell.row;
}},col:function(){if(this.activeCell){return this.activeCell.col;
}},position:function(B){if(!B){return;
}this.element.show().css({top:B.top+1+"px",left:B.left+1+"px"});
this._cellTooltip.css({top:B.top-this._cellTooltip.height()-10+"px",left:B.left});
},resize:function(B){if(!B){return;
}this.element.css({width:B.width-1,height:B.height-1});
},canInsertRef:function(C){var D=this._canInsertRef(C);
var E=D&&D.token;
var B;
if(E){for(B=0;
B<this._staticTokens.length;
B++){if(o(E,this._staticTokens[B])){return null;
}}}return D;
},_canInsertRef:function(F){if(this.popup.visible()){return null;
}var H=F;
var G=this.getPos();
var J,I;
if(G&&this._isFormula()){if(G.begin===0){return null;
}J=r.spreadsheet.calc.tokenize(this.value(),this.row(),this.col());
for(var E=0;
E<J.length;
++E){I=J[E];
if(y(I,G)){return D(I);
}if(B(I)){return C(J[E-1],I);
}}return C(I,null);
}return null;
function B(K){return K.begin>G.begin;
}function D(K){if(K){if(/^(?:num|str|bool|sym|ref)$/.test(K.type)){return{replace:true,token:K,end:K.end};
}if(/^(?:op|punc|startexp)$/.test(K.type)){if(K.end==G.end){return C(K,J[E+1]);
}return C(J[E-1],K);
}}}function C(K,L){if(K==null){return null;
}if(L==null){if(/^(?:op|startexp)$/.test(K.type)||q(K.value)){return{token:K,end:G.end};
}return null;
}if(H){if(K.type=="op"&&/^(?:punc|op)$/.test(L.type)){return{token:K,end:G.end};
}}else{if(K.type=="startexp"){return{token:K,end:G.end};
}if(/^(?:ref|op|punc)$/.test(K.type)){return{token:K,end:G.end};
}if(/^(?:punc|op)$/.test(K.type)){return/^[,;({]$/.test(K.value)?{token:K,end:G.end}:null;
}}return false;
}},refAtPoint:function(B){var C=this._canInsertRef();
if(C){this._replaceAt(C,B.simplify().toString());
}},_replaceAt:function(B,C){var G=this.value();
var F=B.token;
var E=G.substr(B.end);
G=G.substr(0,B.replace?F.begin:B.end)+C;
var D=G.length;
G+=E;
this._value(G);
this.setPos(D);
this.scale();
this._syntaxHighlight();
this._sync();
},syncWith:function(C){var B="input"+v;
this._editorToSync=C;
this.element.off(B).on(B,this._sync.bind(this));
},scale:function(){var B=this.element;
var C;
if(!this._span){this._textContainer();
}this._span.html(B.html());
C=this._span.width()+this.options.scalePadding;
if(C>B.width()){B.width(C);
}},_value:function(B){this.element.text(B);
},value:function(B){if(B===j){return this.element.text();
}this._value(B);
this._syntaxHighlight();
},highlightedRefs:function(){return this._highlightedRefs.slice();
},_syntaxHighlight:function(){var E=this.getPos();
var I=this.value();
var F=r.spreadsheet.Pane.classNames.series;
var C=[];
var G=0;
var D=[];
var H=[];
var B;
if(E&&!E.collapsed){return;
}if(!/^=/.test(I)){this.element.text(I);
if(this.popup){this.popup.close();
}}else{H=r.spreadsheet.calc.tokenize(I,this.row(),this.col());
H.forEach(function(K){K.active=false;
K.cls=["k-syntax-"+K.type];
if(K.type=="ref"){K.colorClass=F[G++%F.length];
K.cls.push(K.colorClass);
C.push(K);
}if(E&&K.type=="punc"){if(q(K.value)){D.unshift(K);
}else{if(n(K.value)){var J=D.shift();
if(J){if(p(K.value,J.value)){if(y(K,E)||y(J,E)){K.cls.push("k-syntax-paren-match");
J.cls.push("k-syntax-paren-match");
}}else{K.cls.push("k-syntax-error");
J.cls.push("k-syntax-error");
}}else{K.cls.push("k-syntax-error");
}}}}if(E&&y(K,E)){K.cls.push("k-syntax-at-point");
K.active=true;
B=K;
}if(K.type=="func"&&!u(K.value)&&(!E||!y(K,E))){K.cls.push("k-syntax-error");
}});
H.reverse().forEach(function(M){var J=M.begin,K=M.end;
var L=r.htmlEncode(I.substring(J,K));
I=I.substr(0,J)+"<span class='"+M.cls.join(" ")+"'>"+L+"</span>"+I.substr(K);
});
this.element.html(I);
}if(E){this.setPos(E.begin,E.end);
}if(B&&/^(?:startexp|op|punc)$/.test(B.type)){this._setStaticTokens(H);
}this._highlightedRefs=C;
},_setStaticTokens:function(D){var B,C;
this._staticTokens=[];
for(B=0;
B<D.length;
B++){C=D[B];
if(/^(?:num|str|bool|sym|ref)$/.test(C.type)){this._staticTokens.push(C);
}}},destroy:function(){this._editorToSync=null;
this.element.off(v);
clearTimeout(this._focusTimeout);
clearTimeout(this._keyDownTimeout);
this._cellTooltip=null;
this._span=null;
this.popup.destroy();
this.popup=null;
z.fn.destroy.call(this);
}});
function q(B){return B=="("||B=="["||B=="{";
}function n(B){return B==")"||B=="]"||B=="}";
}function p(B,C){return C=="("?B==")":C=="["?B=="]":C=="{"?B=="}":false;
}function y(B,C){return B.begin<=C.begin&&B.end>=C.end;
}function u(B){return r.spreadsheet.calc.runtime.FUNCS[B.toLowerCase()];
}function o(B,C){if(!B||!C){return false;
}if(B.type=="ref"&&C.type=="ref"){return B.ref.eq(C.ref);
}else{return B.value===C.value;
}}r.spreadsheet.FormulaInput=m;
k.extend(true,m,{classNames:l});
}(kendo,window));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/eventlistener",["kendo.core"],l);
}(function(){(function(n){if(n.support.browser.msie&&n.support.browser.version<9){return;
}var k=n.jQuery;
var o={8:"backspace",9:"tab",13:"enter",27:"esc",37:"left",38:"up",39:"right",40:"down",35:"end",36:"home",32:"spacebar",33:"pageup",34:"pagedown",46:"delete",113:":edit"};
var q=navigator.platform.toUpperCase().indexOf("MAC")>=0;
var m=function(r){if(r>47&&r<58||r>64&&r<91||r>95&&r<112||r>185&&r<193||r>218&&r<223){return true;
}return false;
};
var p=function(r){var s=o[r];
if(!s&&m(r)){s=":alphanum";
}return s;
};
var l=n.Class.extend({init:function(u,t,r){this._handlers={};
this.target=u;
this._observer=t||window;
this.keyDownProxy=this.keyDown.bind(this);
this.mouseProxy=this.mouse.bind(this);
this.threshold=5;
this._pressLocation=null;
u.on("keydown",this.keyDownProxy);
u.on("contextmenu mousedown cut copy paste scroll wheel click dblclick focus",this.mouseProxy);
k(document.documentElement).on("mousemove mouseup",this.mouseProxy);
if(r){for(var s in r){this.on(s,r[s]);
}}},keyDown:function(r){this.handleEvent(r,p(r.keyCode));
},mouse:function(u){var v;
if(u.which){v=u.which==3;
}else{if(u.button){v=u.button==2;
}}var w=u.type;
if(w==="mousedown"){if(v){w="rightmousedown";
}else{this._pressLocation={x:u.pageX,y:u.pageY};
}}if(w==="mouseup"){if(!v){this._pressLocation=null;
}}if(w==="mousemove"&&this._pressLocation){var s=this._pressLocation.x-u.pageX;
var t=this._pressLocation.y-u.pageY;
var r=Math.sqrt(s*s+t*t);
if(r>this.threshold){w="mousedrag";
}}this.handleEvent(u,w);
},handleEvent:function(s,v){var t="";
s.mod=q?s.metaKey:s.ctrlKey;
if(s.shiftKey){t+="shift+";
}if(s.ctrlKey){t+="ctrl+";
}t+=v;
var r=this._handlers["*+"+v];
if(r){r.call(this._observer,s,t);
}var u=this._handlers[t];
if(u){u.call(this._observer,s,t);
}},on:function(s,r){var t=this._handlers;
if(typeof r==="string"){r=this._observer[r];
}if(typeof s==="string"){s=s.split(",");
}s.forEach(function(u){t[u]=r;
});
},destroy:function(){this.target.off("keydown",this.keyDownProxy);
this.target.off("keydown",this.mouseProxy);
k(document.documentElement).off("mousemove mouseup",this.mouseProxy);
}});
n.spreadsheet.EventListener=l;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/rangelist",["kendo.core"],l);
}(function(){(function(n){if(n.support.browser.msie&&n.support.browser.version<9){return;
}var w=n.Class.extend({init:function r(E,G,D,F){this.level=E;
this.value=G;
this.left=D;
this.right=F;
}});
var q=new function p(){this.left=this;
this.right=this;
this.level=0;
}();
function s(D){return D;
}function y(D){if(D.left.level===D.level){var E=D;
D=D.left;
E.left=D.right;
D.right=E;
}return D;
}function A(D){if(D.right.right.level===D.level){var E=D;
D=D.right;
E.right=D.left;
D.left=E;
D.level+=1;
}return D;
}function k(D,E){if(D===q){return new w(1,E,q,q);
}else{if(D.value.start-E.start>0){D.left=k(D.left,E);
}else{D.right=k(D.right,E);
}}return A(y(D));
}function x(F,G){if(F===q){return F;
}var D=F.value.start-G.start;
if(D===0){if(F.left!==q&&F.right!==q){var E=F.left;
while(E.right!==q){E=E.right;
}F.value=E.value;
F.left=x(F.left,F.value);
}else{if(F.left===q){F=F.right;
}else{F=F.left;
}}}else{if(D>0){F.left=x(F.left,G);
}else{F.right=x(F.right,G);
}}if(F.left.level<F.level-1||F.right.level<F.level-1){F.level-=1;
if(F.right.level>F.level){F.right.level=F.level;
}F=y(F);
F.right=y(F.right);
F.right.right=y(F.right.right);
F=A(F);
F.right=A(F.right);
}return F;
}var t=n.Class.extend({init:function B(E,D,F){this.start=E;
this.end=D;
this.value=F;
},intersects:function(D){return D.start<=this.end&&D.end>=this.start;
}});
var v=n.Class.extend({init:function(){this.root=q;
},insert:function(D){this.root=k(this.root,D);
},remove:function(D){this.root=x(this.root,D);
},findrange:function(E){var D=this.root;
while(D!=q){if(E<D.value.start){D=D.left;
}else{if(E>D.value.end){D=D.right;
}else{return D.value;
}}}return null;
},values:function(){var D=[];
C(this.root,D);
return D;
},intersecting:function(F,D){var E=[];
l(this.root,new t(F,D),E);
return E;
},map:function(D){var E=new v();
o(E,this.root,D);
return E;
},clone:function(){return this.map(s);
},first:function(){var D=this.root;
while(D.left!=q){D=D.left;
}return D;
},last:function(){var D=this.root;
while(D.right!=q){D=D.right;
}return D;
}});
function C(D,E){if(D===q){return;
}C(D.left,E);
E.push(D.value);
C(D.right,E);
}function l(D,E,F){if(D===q){return;
}var G=D.value;
if(E.start<G.start){l(D.left,E,F);
}if(G.intersects(E)){F.push(G);
}if(E.end>G.end){l(D.right,E,F);
}}function o(F,E,D){if(E===q){return;
}o(F,E.left,D);
F.insert(D(E.value));
o(F,E.right,D);
}var u=n.Class.extend({init:function(E,D,F){if(D===j){this.tree=E;
}else{this.tree=new v();
this.tree.insert(new t(E,D,F));
}},values:function(){return this.tree.values();
},map:function(D){return new u(this.tree.map(D));
},intersecting:function(E,D){return this.tree.intersecting(E,D);
},first:function(){return this.tree.first().value;
},last:function(){return this.tree.last().value;
},insert:function(E,D,F){return this.tree.insert(new t(E,D,F));
},value:function(N,D,O){if(O===j){if(D===j){D=N;
}return this.intersecting(N,D)[0].value;
}var K=this.tree.intersecting(N-1,D+1);
if(K.length){var E=K[0],G=K[K.length-1];
if(E.end<N){if(E.value===O){N=E.start;
}else{K.shift();
}}if(G.start>D){if(G.value===O){D=G.end;
}else{K.pop();
}}for(var F=0,H=K.length;
F<H;
F++){var I=K[F];
var M=I.value;
var L=I.start;
var J=I.end;
this.tree.remove(I);
if(L<N){if(M!==O){this.insert(L,N-1,M);
}else{N=L;
}}if(J>D){if(M!==O){this.insert(D+1,J,M);
}else{D=J;
}}}}this.insert(N,D,O);
},expandedValues:function(I,D){var G=this.intersecting(I,D);
var H=[];
var F=0;
for(var E=I;
E<=D;
E++){if(G[F].end<E){F++;
}H.push({index:E-I,value:G[F].value});
}return H;
},sortedIndices:function(H,E,I,F){var G=this.expandedValues(H,E);
var D=function(J,K){if(J.value===K.value){return J.index-K.index;
}return I(J.value,K.value);
};
if(F){D=function(J,K){var L=F[J.index];
var M=F[K.index];
if(L.value===M.value){return I(J.value,K.value);
}return J.index-K.index;
};
}G.sort(D);
return G;
},sort:function(H,D,F){if(this.intersecting(H,D).length===1){return;
}var I=this.expandedValues(H,D);
for(var E=0,G=F.length;
E<G;
E++){this.value(E+H,E+H,I[F[E].index].value);
}},copy:function(J,I,L){var M=this.intersecting(J,I);
var K=L;
var D;
for(var E=0,F=M.length;
E<F;
E++){var H=M[E].start;
if(H<J){H=J;
}var G=M[E].end;
if(G>I){G=I;
}D=K+(G-H);
this.value(K,D,M[E].value);
K=++D;
}},iterator:function(E,D){return new m(E,D,this.intersecting(E,D));
},getState:function(){return this.tree.clone();
},setState:function(D){this.tree=D;
}});
var m=n.Class.extend({init:function(F,D,E){this.start=F;
this.end=D;
this.index=0;
this.ranges=E;
},unique:function(){return this.ranges.map(function(D){return D.value;
});
},at:function(D){while(this.ranges[this.index].end<D){this.index++;
}return this.ranges[this.index].value;
},forEach:function(D){for(var E=this.start;
E<=this.end;
E++){D(this.at(E),E);
}this.index=0;
}});
var z=u.extend({init:function(E,D,F){this.tree=new v();
this.range=new t(E,D,F);
},intersecting:function(J,D){var H=this.tree.intersecting(J,D);
var I=[];
var G;
if(!H.length){return[this.range];
}for(var E=0,F=H.length;
E<F;
E++){G=H[E];
if(G.start>J){I.push(new t(J,G.start-1,this.range.value));
}I.push(G);
J=G.end+1;
}if(G.end<D){I.push(new t(G.end+1,D,this.range.value));
}return I;
},insert:function(E,D,F){if(F!==this.range.value){this.tree.insert(new t(E,D,F));
}},lastRangeStart:function(){var D=this.tree.root;
if(D===q){return this.range.start;
}while(D.right!==q){D=D.right;
}return D.value.end+1;
}});
n.spreadsheet.RangeTree=v;
n.spreadsheet.RangeList=u;
n.spreadsheet.SparseRangeList=z;
n.spreadsheet.ValueRange=t;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/propertybag",["kendo.core"],l);
}(function(){(function(m){if(m.support.browser.msie&&m.support.browser.version<9){return;
}var k=m.jQuery;
var n=m.Class.extend({init:function(q){this.list=q;
},get:function(q){return this.parse(this.list.value(q,q));
},set:function(r,q,s){if(s===j){s=q;
q=r;
}this.list.value(r,q,s);
},parse:function(q){return q;
},copy:function(s,r,q){this.list.copy(s,r,q);
},iterator:function(r,q){return this.list.iterator(r,q);
}});
var l=n.extend({set:function(r,q,s){this.list.value(r,q,JSON.stringify(s));
},parse:function(q){return JSON.parse(q);
}});
var p=n.extend({init:function(s,q,r){n.prototype.init.call(this,s);
this.validations=r;
this.formats=q;
},set:function(r,q,s){if(s instanceof Date){s=m.spreadsheet.dateToNumber(s);
this.formats.value(r,q,o(m.culture().calendar.patterns.d));
}this.list.value(r,q,s);
}});
function o(q){return q.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm");
}m.spreadsheet.PropertyBag=m.Class.extend({specs:[{property:p,name:"value",value:null,sortable:true,serializable:true,depends:"format"},{property:n,name:"format",value:null,sortable:true,serializable:true},{property:n,name:"formula",value:null,sortable:true,serializable:true},{property:n,name:"background",value:null,sortable:true,serializable:true},{property:l,name:"borderBottom",value:null,sortable:false,serializable:true},{property:l,name:"borderRight",value:null,sortable:false,serializable:true},{property:l,name:"borderLeft",value:null,sortable:false,serializable:true},{property:l,name:"borderTop",value:null,sortable:false,serializable:true},{property:n,name:"color",value:null,sortable:true,serializable:true},{property:n,name:"fontFamily",value:null,sortable:true,serializable:true},{property:n,name:"underline",value:null,sortable:true,serializable:true},{property:n,name:"fontSize",value:null,sortable:true,serializable:true},{property:n,name:"italic",value:null,sortable:true,serializable:true},{property:n,name:"bold",value:null,sortable:true,serializable:true},{property:n,name:"textAlign",value:null,sortable:true,serializable:true},{property:n,name:"verticalAlign",value:null,sortable:true,serializable:true},{property:n,name:"wrap",value:null,sortable:true,serializable:true},{property:n,name:"validation",value:null,sortable:false,serializable:true},{property:n,name:"enable",value:null,sortable:false,serializable:true}],init:function(q){this.properties={};
this.lists={};
this.specs.forEach(function(r){this.lists[r.name]=new m.spreadsheet.SparseRangeList(0,q,r.value);
},this);
this.specs.forEach(function(r){this.properties[r.name]=new r.property(this.lists[r.name],this.lists[r.depends]);
},this);
},getState:function(){var q={};
this.specs.forEach(function(r){q[r.name]=this.lists[r.name].getState();
},this);
return q;
},setState:function(q){this.specs.forEach(function(r){this.lists[r.name].setState(q[r.name]);
},this);
},get:function(r,q){if(q===j){return this.lists[r];
}return this.properties[r].get(q);
},set:function(r,s,q,t){this.properties[r].set(s,q,t);
},fromJSON:function(q,t){for(var r=0;
r<this.specs.length;
r++){var s=this.specs[r];
if(s.serializable){if(t[s.name]!==j){this.set(s.name,q,q,t[s.name],false);
}}}},copy:function(r,q,s){this.specs.forEach(function(t){this.properties[t.name].copy(r,q,s);
},this);
},iterator:function(r,s,q){return this.properties[r].iterator(s,q);
},sortable:function(){return this.specs.filter(function(q){return q.sortable;
}).map(function(q){return this.lists[q.name];
},this);
},iterators:function(s,q){var r=this.specs.filter(function(t){return t.serializable;
});
return r.map(function(u){var t=this.iterator(u.name,s,q);
return{name:u.name,value:u.value,at:function(v){return u.property.fn.parse(t.at(v));
}};
},this);
},forEach:function(w,r,q){var v=this.iterators(w,r);
for(var t=w;
t<=r;
t++){var y={};
for(var s=0;
s<v.length;
s++){var u=v[s];
var x=u.at(t);
if(x!==u.value){y[u.name]=x;
}}q(y);
}},forEachProperty:function(q){for(var r in this.properties){q(this.properties[r]);
}}});
m.spreadsheet.ALL_PROPERTIES=k.map(m.spreadsheet.PropertyBag.prototype.specs,function(q){return q.name;
});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/references",["kendo.core"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var u=kendo.spreadsheet;
var l=kendo.Class;
function m(w){var x=Math.floor(w/26)-1;
return(x>=0?m(x):"")+String.fromCharCode(65+w%26);
}function o(w){if(/^[a-z0-9_]*$/i.test(w)){return w;
}return"'"+w.replace(/\x27/g,"\\'")+"'";
}function n(A,z,x,y){var w="";
++z;
if(!isFinite(z)){z="";
}else{if(y!=null&&!(y&2)){z="$"+z;
}}if(!isFinite(x)){x="";
}else{w=m(x);
if(y!=null&&!(y&1)){w="$"+w;
}}if(A){return o(A)+"!"+w+z;
}else{return w+z;
}}var t=l.extend({type:"ref",hasSheet:function(){return this._hasSheet;
},simplify:function(){return this;
},setSheet:function(x,w){this.sheet=x;
if(w!=null){this._hasSheet=w;
}return this;
},absolute:function(){return this;
},relative:function(){return this;
},adjust:function(){return this;
},toString:function(){return this.relative(0,0,3,3).print(0,0);
},forEach:function(w,x){w.call(x,this);
},map:function(w,x){return w.call(x,this);
},intersects:function(w){return this.intersect(w)!==q;
},isCell:function(){return false;
},toRow:function(){return this;
},toColumn:function(){return this;
},first:function(){return this;
},lastRange:function(){return this;
},size:function(){return 1;
},rangeAt:function(){return this;
},nextRangeIndex:function(){return 0;
},previousRangeIndex:function(){return 0;
},eq:function(A){var y=this;
var z=A;
if(y===q||z===q){return y===z;
}if(z instanceof k||z instanceof s&&!(y instanceof k)){y=A;
z=this;
}if(y instanceof k){z=z.simplify();
return z instanceof k&&y.row==z.row&&y.col==z.col&&y.sheet==z.sheet;
}else{if(y instanceof s){if(z instanceof s){return z.topLeft.eq(y.topLeft)&&z.bottomRight.eq(y.bottomRight);
}if(z instanceof v){return z.single()&&y.eq(z.refs[0]);
}}else{if(y instanceof v&&z instanceof v){var B=y.refs;
var C=z.refs;
if(B.length!=C.length){return false;
}for(var w=0,x=B.length;
w<x;
w++){if(!B[w].eq(C[w])){return false;
}}return true;
}}}return y===z;
},concat:function(w){return new v([this,w]);
},replaceAt:function(w,x){return x;
},forEachColumnIndex:function(w){this.forEachAxisIndex("col",w);
},forEachRowIndex:function(w){this.forEachAxisIndex("row",w);
},forEachAxisIndex:function(w,x){var z=[];
var y=w==="row"?"forEachRow":"forEachColumn";
this[y](function(B){var A=B.first()[w];
if(z.indexOf(A)===-1){z.push(A);
}});
z.sort(function(A,B){return A>B?1:A<B?-1:0;
}).forEach(x);
},valid:function(){return false;
}});
t.display=n;
var q=new (t.extend({init:function r(){},print:function(){return"#NULL!";
},clone:function(){return this;
},eq:function(w){return w===this;
},forEach:function(){}}))();
var p=t.extend({ref:"name",init:function p(w){this.name=w;
},print:function(){var w=o(this.name);
if(this.hasSheet()){w=o(this.sheet)+"!"+w;
}return w;
}});
var k=t.extend({ref:"cell",init:function k(y,w,x){this.row=y;
this.col=w;
this.rel=x||0;
},clone:function(){return new k(this.row,this.col,this.rel).setSheet(this.sheet,this.hasSheet());
},intersect:function(w){if(w instanceof k){if(this.eq(w)){return this;
}else{return q;
}}return w.intersect(this);
},print:function(B,A){var x=this.col,z=this.row,y=this.rel,w;
if(B==null){if(isFinite(x)){x=y&1?"C["+x+"]":"C"+(x+1);
}else{x="";
}if(isFinite(z)){z=y&2?"R["+z+"]":"R"+(z+1);
}else{z="";
}return z+x;
}else{w=this.absolute(B,A);
return w.valid()?n(this._hasSheet&&this.sheet,w.row,w.col,y):"#REF!";
}},absolute:function(x,w){var y=this.clone();
if(y.rel&3===0){return y;
}if(y.rel&1){y.col+=w;
}if(y.rel&2){y.row+=x;
}y.rel=0;
return y;
},toRangeRef:function(){return new s(this,this);
},relative:function(x,w,z){if(z==null){z=this.rel;
}var A=z&2?this.row-x:this.row;
var y=z&1?this.col-w:this.col;
return new k(A,y,z).setSheet(this.sheet,this.hasSheet());
},height:function(){return 1;
},width:function(){return 1;
},toString:function(){return n(null,this.row,this.col,3);
},isCell:function(){return true;
},leftColumn:function(){return this;
},rightColumn:function(){return this;
},topRow:function(){return this;
},bottomRow:function(){return this;
},forEachRow:function(w){w(this.toRangeRef());
},forEachColumn:function(w){w(this.toRangeRef());
},adjust:function(A,w,D,C,y,B,x){var z=this.absolute(A,w);
if(y){if(z.row>=B){if(x<0&&z.row<B-x){return q;
}z.row+=x;
}}else{if(z.col>=B){if(x<0&&z.col<B-x){return q;
}z.col+=x;
}}if(D!=null&&C!=null){z=z.relative(D,C,this.rel);
}return z;
},valid:function(){if(this.rel){throw new Error("valid() called on relative reference");
}var w=this.col,x=this.row;
return !(isFinite(w)&&w<0||isFinite(x)&&x<0);
}});
var s=t.extend({ref:"range",init:function s(x,w){if(x._hasSheet&&w._hasSheet&&x.sheet.toLowerCase()!=w.sheet.toLowerCase()){this.endSheet=w.sheet;
}this.topLeft=new k(x.row,x.col,x.rel);
this.bottomRight=new k(w.row,w.col,w.rel);
this.normalize();
},clone:function(){return new s(this.topLeft.clone(),this.bottomRight.clone()).setSheet(this.sheet,this.hasSheet());
},_containsRange:function(w){return this._containsCell(w.topLeft)&&this._containsCell(w.bottomRight);
},_containsCell:function(w){return w.sheet==this.sheet&&w.row>=this.topLeft.row&&w.col>=this.topLeft.col&&w.row<=this.bottomRight.row&&w.col<=this.bottomRight.col;
},contains:function(w){if(w instanceof Array){var x=this;
return w.some(function(y){return x.contains(y);
});
}if(w instanceof k){return this._containsCell(w);
}if(w instanceof s){return this._containsRange(w);
}return false;
},_intersectRange:function(E){if(this.sheet!=E.sheet){return q;
}var x=this.topLeft.col;
var z=this.topLeft.row;
var y=this.bottomRight.col;
var w=this.bottomRight.row;
var B=E.topLeft.col;
var D=E.topLeft.row;
var C=E.bottomRight.col;
var A=E.bottomRight.row;
if(x<=C&&B<=y&&z<=A&&D<=w){return new s(new k(Math.max(z,D),Math.max(x,B)),new k(Math.min(w,A),Math.min(y,C))).setSheet(this.sheet,this.hasSheet());
}else{return q;
}},intersect:function(w){if(w===q){return w;
}if(w instanceof k){return this._containsCell(w)?w:q;
}if(w instanceof s){return this._intersectRange(w).simplify();
}if(w instanceof v){return w.intersect(this);
}throw new Error("Unknown reference");
},simplify:function(){if(this.isCell()){return new k(this.topLeft.row,this.topLeft.col,this.topLeft.rel).setSheet(this.sheet,this.hasSheet());
}return this;
},normalize:function(){var w=this.topLeft,x=this.bottomRight;
var B=w.row,y=w.col,C=x.row,z=x.col;
var F=w.rel&2,D=w.rel&1;
var G=x.rel&2,E=x.rel&1;
var H,A=false;
if(B>C){A=true;
H=B;
B=C;
C=H;
H=F;
F=G;
G=H;
}if(y>z){A=true;
H=y;
y=z;
z=H;
H=D;
D=E;
E=H;
}if(A){this.topLeft=new k(B,y,D|F);
this.bottomRight=new k(C,z,E|G);
}return this;
},print:function(z,y){var w=this.absolute(z,y);
if(w.valid()){var x=this.topLeft.print(z,y)+":"+this.bottomRight.print(z,y);
if(this.hasSheet()){x=o(this.sheet)+(this.endSheet?":"+o(this.endSheet):"")+"!"+x;
}return x;
}return"#REF!";
},absolute:function(x,w){return new s(this.topLeft.absolute(x,w),this.bottomRight.absolute(x,w)).setSheet(this.sheet,this.hasSheet());
},relative:function(x,w,z,y){if(y==null){y=z;
}return new s(this.topLeft.relative(x,w,z),this.bottomRight.relative(x,w,y)).setSheet(this.sheet,this.hasSheet());
},height:function(){if(this.topLeft.rel!=this.bottomRight.rel){throw new Error("Mixed relative/absolute references");
}return this.bottomRight.row-this.topLeft.row+1;
},width:function(){if(this.topLeft.rel!=this.bottomRight.rel){throw new Error("Mixed relative/absolute references");
}return this.bottomRight.col-this.topLeft.col+1;
},collapse:function(){return this.topLeft.toRangeRef();
},leftColumn:function(){return new s(this.topLeft,new k(this.bottomRight.row,this.topLeft.col));
},rightColumn:function(){return new s(new k(this.topLeft.row,this.bottomRight.col),this.bottomRight);
},topRow:function(){return new s(this.topLeft,new k(this.topLeft.row,this.bottomRight.col));
},bottomRow:function(){return new s(new k(this.bottomRight.row,this.topLeft.col),this.bottomRight);
},toRangeRef:function(){return this;
},toRow:function(w){return new s(new k(this.topLeft.row+w,this.topLeft.col),new k(this.topLeft.row+w,this.bottomRight.col));
},toColumn:function(w){return new s(new k(this.topLeft.row,this.topLeft.col+w),new k(this.bottomRight.row,this.topLeft.col+w));
},forEachRow:function(w){var B=this.topLeft.row;
var y=this.bottomRight.row;
var A=this.topLeft.col;
var x=this.bottomRight.col;
for(var z=B;
z<=y;
z++){w(new s(new k(z,A),new k(z,x)));
}},forEachColumn:function(w){var B=this.topLeft.row;
var y=this.bottomRight.row;
var A=this.topLeft.col;
var x=this.bottomRight.col;
for(var z=A;
z<=x;
z++){w(new s(new k(B,z),new k(y,z)));
}},intersecting:function(w){return w.filter(function(x){return x.toRangeRef().intersects(this);
},this);
},union:function(B,y){var z=this.intersecting(B);
var E=this.topLeft.row;
var D=this.topLeft.col;
var x=this.bottomRight.row;
var w=this.bottomRight.col;
var A=false;
z.forEach(function(F){F=F.toRangeRef();
if(F.topLeft.row<E){A=true;
E=F.topLeft.row;
}if(F.topLeft.col<D){A=true;
D=F.topLeft.col;
}if(F.bottomRight.row>x){A=true;
x=F.bottomRight.row;
}if(F.bottomRight.col>w){A=true;
w=F.bottomRight.col;
}if(y){y(F);
}});
var C=new s(new k(E,D),new k(x,w));
if(A){return C.union(B,y);
}else{return C;
}},resize:function(A){var y=Math.max.bind(Math,0);
function z(D){return D||0;
}var C=this.topLeft.row+z(A.top);
var x=this.topLeft.col+z(A.left);
var w=this.bottomRight.row+z(A.bottom);
var B=this.bottomRight.col+z(A.right);
if(x<0&&B<0||C<0&&w<0){return q;
}else{if(C<=w&&x<=B){return new s(new k(y(C),y(x)),new k(y(w),y(B)));
}else{return q;
}}},move:function(x,w){return new s(new k(this.topLeft.row+x,this.topLeft.col+w),new k(this.bottomRight.row+x,this.bottomRight.col+w));
},first:function(){return this.topLeft;
},isCell:function(){return !this.endSheet&&this.topLeft.eq(this.bottomRight);
},toString:function(){return this.topLeft+":"+this.bottomRight;
},adjust:function(z,w,E,B,y,A,x){var C=this.topLeft.adjust(z,w,E,B,y,A,x);
var D=this.bottomRight.adjust(z,w,E,B,y,A,x);
if(C===q&&D===q){return q;
}if(C===q){C=this.topLeft.absolute(z,w);
if(y){C.row=A;
}else{C.col=A;
}if(E!=null&&B!=null){C=C.relative(E,B,this.topLeft.rel);
}}else{if(D===q){D=this.bottomRight.absolute(z,w);
if(y){D.row=A-1;
}else{D.col=A-1;
}if(E!=null&&B!=null){D=D.relative(E,B,this.bottomRight.rel);
}}}return new s(C,D).setSheet(this.sheet,this.hasSheet()).simplify();
},valid:function(){return this.topLeft.valid()&&this.bottomRight.valid();
}});
var v=t.extend({init:function v(w){this.refs=w;
this.length=this.refs.length;
},intersect:function(z){var w=[];
for(var y=0;
y<this.length;
++y){var A=z.intersect(this.refs[y]);
if(A!==q){w.push(A);
}}if(w.length>0){return new v(w).simplify();
}return q;
},simplify:function(){var w=new v(this.refs.reduce(function(x,y){y=y.simplify();
if(y!==q){x.push(y);
}return x;
},[]));
if(w.empty()){return q;
}if(w.single()){return w.refs[0];
}return w;
},absolute:function(x,w){return new v(this.refs.map(function(y){return y.absolute(x,w);
}));
},forEach:function(w,x){this.refs.forEach(w,x);
},toRangeRef:function(){return this.refs[0].toRangeRef();
},contains:function(w){return this.refs.some(function(x){return x.contains(w);
});
},map:function(w,x){return new v(this.refs.map(w,x));
},first:function(){return this.refs[0].first();
},lastRange:function(){return this.refs[this.length-1];
},size:function(){return this.length;
},single:function(){return this.length==1;
},empty:function(){return this.length===0;
},isCell:function(){return this.single()&&this.refs[0].isCell();
},rangeAt:function(w){return this.refs[w];
},nextRangeIndex:function(w){if(w===this.length-1){return 0;
}else{return w+1;
}},previousRangeIndex:function(w){if(w===0){return this.length-1;
}else{return w-1;
}},concat:function(w){return new v(this.refs.concat([w]));
},print:function(x,w){return this.refs.map(function(y){return y.print(x,w);
}).join(",");
},replaceAt:function(w,y){var x=this.refs.slice();
x.splice(w,1,y);
return new v(x);
},leftColumn:function(){return this.map(function(w){return w.leftColumn();
});
},rightColumn:function(){return this.map(function(w){return w.rightColumn();
});
},topRow:function(){return this.map(function(w){return w.topRow();
});
},bottomRow:function(){return this.map(function(w){return w.bottomRow();
});
},forEachRow:function(w){this.forEach(function(x){x.forEachRow(w);
});
},forEachColumn:function(w){this.forEach(function(x){x.forEachColumn(w);
});
},adjust:function(z,w,C,B,y,A,x){return this.map(function(D){return D.adjust(z,w,C,B,y,A,x);
}).simplify();
},toString:function(){return this.refs.map(function(w){return w.toString();
}).join(", ");
},valid:function(){for(var w=this.refs.length;
--w>=0;
){if(this.refs[w].valid()){return false;
}}return true;
}});
u.NULLREF=q;
u.SHEETREF=new s(new k(0,0),new k(Infinity,Infinity));
u.FIRSTREF=new k(0,0);
u.Ref=t;
u.NameRef=p;
u.CellRef=k;
u.RangeRef=s;
u.UnionRef=v;
u.SHEETREF.print=function(){return"#SHEET";
};
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/autofillcalculator",["kendo.core"],l);
}(function(){(function(m){if(m.support.browser.msie&&m.support.browser.version<9){return;
}var n=m.spreadsheet.RangeRef;
var l=m.spreadsheet.CellRef;
var k=m.Class.extend({init:function(o){this._grid=o;
},rectIsVertical:function(q,o,s,t){var r=this._grid.rectangle(q.toRangeRef());
var p=this._grid.rectangle(o.toRangeRef());
return Math.abs(p[t]-r[t])>Math.abs(r[s]-p[s]);
},autoFillDest:function(y,r){var z=y.topLeft;
var p=y.bottomRight;
var x;
var u=r.row>=z.row;
var t=r.col>=z.col;
if(u){x=t?4:3;
}else{x=t?2:1;
}var w,v,q,s;
if(x===4){w=z;
v=p;
s=r.row>v.row||r.col>v.col;
if(s){r=new l(Math.max(r.row,v.row),Math.max(r.col,v.col));
}if(this.rectIsVertical(v,r,"right","bottom")){q=new l(r.row,v.col);
}else{q=new l(v.row,r.col);
}}else{if(x===3){var o=new l(z.col,p.row);
if(r.row>p.row&&this.rectIsVertical(o,r,"left","bottom")){w=z;
q=new l(r.row,p.col);
}else{w=p;
q=new l(z.row,r.col);
}}else{if(x===2){var A=new l(z.row,p.col);
if(r.col>p.col&&!this.rectIsVertical(A,r,"right","top")){w=z;
q=new l(p.row,r.col);
}else{w=p;
q=new l(r.row,z.col);
}}else{w=p;
if(this.rectIsVertical(z,r,"left","top")){q=new l(r.row,z.col);
}else{q=new l(z.row,r.col);
}}}}return this._grid.normalize(new n(w,q));
}});
m.spreadsheet.AutoFillCalculator=k;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/navigator",["kendo.core","spreadsheet/autofillcalculator"],l);
}(function(){(function(m){if(m.support.browser.msie&&m.support.browser.version<9){return;
}var n=m.spreadsheet.RangeRef;
var k=m.spreadsheet.CellRef;
var l=m.Class.extend({init:function(q,p,r,s){this.rangeGetter=r;
this.prevLeft=function(u){var t=s(this.range(u));
var v=this.range(p.prevVisible(t.topLeft[q]));
return s(v).topLeft[q];
};
this.nextRight=function(u){var t=s(this.range(u));
var v=this.range(p.nextVisible(t.bottomRight[q]));
return s(v).bottomRight[q];
};
this.nextLeft=function(t){var u=s(this.range(t));
return p.nextVisible(u.bottomRight[q]);
};
this.prevRight=function(t){var u=s(this.range(t));
return p.prevVisible(u.topLeft[q]);
};
},boundary:function(q,p){this.top=q;
this.bottom=p;
},range:function(p){return this.rangeGetter(p,this.top,this.bottom);
}});
var o=m.Class.extend({init:function(p){this._sheet=p;
this.columns=this._sheet._grid._columns;
this.autoFillCalculator=new m.spreadsheet.AutoFillCalculator(p._grid);
this.colEdge=new l("col",this._sheet._grid._columns,this.columnRange.bind(this),this.union.bind(this));
this.rowEdge=new l("row",this._sheet._grid._rows,this.rowRange.bind(this),this.union.bind(this));
},height:function(p){this._viewPortHeight=p;
},union:function(p){return this._sheet.unionWithMerged(p);
},columnRange:function(q,r,p){return this._sheet._ref(r,q,p-r,1);
},rowRange:function(r,p,q){return this._sheet._ref(r,p,1,q-p);
},selectionIncludesMergedCells:function(){return this._sheet.select().contains(this._sheet._mergedCells);
},setSelectionValue:function(q){var p=this._sheet.selection();
setTimeout(function(){p.value(q());
});
},selectAll:function(){this._sheet.select(this._sheet._sheetRef);
},select:function(r,q,p){r=this.refForMode(r,q);
if(p){r=this._sheet.select().concat(r);
}this._sheet.select(r);
},refForMode:function(r,q){var p=this._sheet._grid;
switch(q){case"range":r=p.normalize(r);
break;
case"row":r=p.rowRef(r.row);
break;
case"column":r=p.colRef(r.col);
break;
case"sheet":r=this._sheet._sheetRef;
break;
}return r;
},startSelection:function(r,q,p){if(q=="autofill"){this._sheet.startAutoFill();
}else{this._sheet.startSelection();
this.select(r,q,p);
}},completeSelection:function(){this._sheet.completeSelection();
},selectForContextMenu:function(q,p){var r=this._sheet;
if(!r.select().contains(this.refForMode(q,p))){this.select(q,p);
}},modifySelection:function(p){var t=this.determineDirection(p);
var z=this._sheet;
var B=this._viewPortHeight;
var w=z._grid._rows;
var s=z._grid._columns;
var v=z.currentOriginalSelectionRange();
var y=z.select().toRangeRef();
var q=z.activeCell();
var A=v.topLeft.clone();
var r=v.bottomRight.clone();
var x;
this.colEdge.boundary(y.topLeft.row,y.bottomRight.row);
this.rowEdge.boundary(y.topLeft.col,y.bottomRight.col);
switch(t){case"expand-left":A.col=this.colEdge.prevLeft(A.col);
x=A;
break;
case"shrink-right":A.col=this.colEdge.nextLeft(A.col);
x=A;
break;
case"expand-right":r.col=this.colEdge.nextRight(r.col);
x=r;
break;
case"shrink-left":r.col=this.colEdge.prevRight(r.col);
x=r;
break;
case"expand-up":A.row=this.rowEdge.prevLeft(A.row);
x=A;
break;
case"shrink-down":A.row=this.rowEdge.nextLeft(A.row);
x=A;
break;
case"expand-down":r.row=this.rowEdge.nextRight(r.row);
x=r;
break;
case"shrink-up":r.row=this.rowEdge.prevRight(r.row);
x=r;
break;
case"expand-page-up":A.row=w.prevPage(A.row,B);
break;
case"shrink-page-up":r.row=w.prevPage(r.row,B);
break;
case"expand-page-down":r.row=w.nextPage(r.row,B);
break;
case"shrink-page-down":A.row=w.nextPage(A.row,B);
break;
case"first-col":A.col=s.firstVisible();
r.col=q.bottomRight.col;
x=A;
break;
case"last-col":r.col=s.lastVisible();
A.col=q.topLeft.col;
x=r;
break;
case"first-row":A.row=w.firstVisible();
r.row=q.bottomRight.row;
x=A;
break;
case"last-row":r.row=w.lastVisible();
A.row=q.topLeft.row;
x=r;
break;
case"last":r.row=w.lastVisible();
r.col=s.lastVisible();
A=q.topLeft;
x=r;
break;
case"first":A.row=w.firstVisible();
A.col=s.firstVisible();
r=q.bottomRight;
x=A;
break;
}var u=new n(A,r);
if(!this.union(u).intersects(q)){this.modifySelection(t.replace("shrink","expand"));
return;
}if(x){z.focus(x);
}this.updateCurrentSelectionRange(u);
},moveActiveCell:function(u){var x=this._sheet;
var p=x.activeCell();
var y=p.topLeft;
var q=p.bottomRight;
var r=x.originalActiveCell();
var w=x._grid._rows;
var t=x._grid._columns;
var v=r.row;
var s=r.col;
switch(u){case"left":s=t.prevVisible(y.col);
break;
case"up":v=w.prevVisible(y.row);
break;
case"right":s=t.nextVisible(q.col);
break;
case"down":v=w.nextVisible(q.row);
break;
case"first-col":s=t.firstVisible();
break;
case"last-col":s=t.lastVisible();
break;
case"first-row":v=w.firstVisible();
break;
case"last-row":v=w.lastVisible();
break;
case"last":v=w.lastVisible();
s=t.lastVisible();
break;
case"first":v=w.firstVisible();
s=t.firstVisible();
break;
case"next-page":v=w.nextPage(q.row,this._viewPortHeight);
break;
case"prev-page":v=w.prevPage(q.row,this._viewPortHeight);
break;
}x.select(new k(v,s));
},navigateInSelection:function(u){var B=this._sheet;
var p=B.activeCell();
var C=p.topLeft;
var q=B.originalActiveCell();
var x=B._grid._rows;
var s=B._grid._columns;
var w=q.row;
var r=q.col;
var z=B.currentNavigationRange();
var A=z.topLeft;
var y=z.bottomRight;
var v=false;
var D=C.col;
var E=C.row;
while(!v){var t=new k(w,r);
switch(u){case"next":if(y.eq(t)){z=B.nextNavigationRange();
w=z.topLeft.row;
r=z.topLeft.col;
}else{r=s.nextVisible(D,true);
if(r>y.col){r=A.col;
w=x.nextVisible(w,true);
}}break;
case"previous":if(A.eq(t)){z=B.previousNavigationRange();
w=z.bottomRight.row;
r=z.bottomRight.col;
}else{r=s.prevVisible(D,true);
if(r<A.col){r=y.col;
w=x.prevVisible(w,true);
}}break;
case"lower":if(y.eq(t)){z=B.nextNavigationRange();
w=z.topLeft.row;
r=z.topLeft.col;
}else{w=x.nextVisible(E,true);
if(w>y.row){w=A.row;
r=s.nextVisible(r,true);
}}break;
case"upper":if(A.eq(t)){z=B.previousNavigationRange();
w=z.bottomRight.row;
r=z.bottomRight.col;
}else{w=x.prevVisible(E,true);
if(w<A.row){w=y.row;
r=s.prevVisible(r,true);
}}break;
default:throw new Error("Unknown entry navigation: "+u);
}v=!this.shouldSkip(w,r);
D=r;
E=w;
}if(B.singleCellSelection()){B.select(new k(w,r));
}else{B.activeCell(new k(w,r));
}},extendSelection:function(s,r){var t=this._sheet;
var q=t._grid;
if(r==="autofill"){this.resizeAutoFill(s);
return;
}if(r==="range"){s=q.normalize(s);
}else{if(r==="row"){s=q.rowRef(s.row).bottomRight;
}else{if(r==="column"){s=q.colRef(s.col).bottomRight;
}}}var p=t.originalActiveCell().toRangeRef();
this.updateCurrentSelectionRange(new n(p.topLeft,s));
},shouldSkip:function(s,p){var r=new k(s,p);
var q=false;
this._sheet.forEachMergedCell(function(t){if(t.intersects(r)&&!t.collapse().eq(r)){q=true;
}});
return q;
},resizeAutoFill:function(w){var z=this._sheet;
var y=z.select();
var s=z._autoFillOrigin;
var p=this.autoFillCalculator.autoFillDest(y,w);
var v=this.punch(y,p);
var r,q,x;
if(!v){var t=z.range(p)._previewFillFrom(z.range(s));
if(t){q=t.direction;
var u=t.props;
if(q===0||q==1){x=u[u.length-1];
r=x[x.length-1].value;
}else{if(q===2){x=u[0];
r=x[x.length-1].value;
}else{if(q===3){x=u[u.length-1];
r=x[0].value;
}}}}}z.updateAutoFill(p,v,r,q);
},determineDirection:function(p){var u=this._sheet.currentSelectionRange();
var q=this._sheet.activeCell();
var s=q.topLeft.col==u.topLeft.col;
var t=q.bottomRight.col==u.bottomRight.col;
var v=q.topLeft.row==u.topLeft.row;
var r=q.bottomRight.row==u.bottomRight.row;
switch(p){case"left":p=t?"expand-left":"shrink-left";
break;
case"right":p=s?"expand-right":"shrink-right";
break;
case"up":p=r?"expand-up":"shrink-up";
break;
case"down":p=v?"expand-down":"shrink-down";
break;
case"prev-page":p=r?"expand-page-up":"shrink-page-up";
break;
case"next-page":p=v?"expand-page-down":"shrink-page-down";
break;
}return p;
},updateCurrentSelectionRange:function(p){var q=this._sheet;
q.select(q.originalSelect().replaceAt(q.selectionRangeIndex(),p),false);
},punch:function(s,t){var r;
if(t.topLeft.eq(s.topLeft)){if(t.bottomRight.row<s.bottomRight.row){var q=this.rowEdge.nextRight(t.bottomRight.row);
r=new n(new k(q,s.topLeft.col),s.bottomRight);
}else{if(t.bottomRight.col<s.bottomRight.col){var p=this.colEdge.nextRight(t.bottomRight.col);
r=new n(new k(s.topLeft.row,p),s.bottomRight);
}}}return r;
}});
m.spreadsheet.SheetNavigator=o;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/axismanager",["kendo.core"],l);
}(function(){(function(l){if(l.support.browser.msie&&l.support.browser.version<9){return;
}var k=l.Class.extend({init:function(m){this._sheet=m;
},forEachSelectedColumn:function(m){var n=this._sheet;
n.batch(function(){n.select().forEachColumnIndex(function(p,o){m(n,p,o);
});
},{layout:true,recalc:true});
},forEachSelectedRow:function(m){var n=this._sheet;
n.batch(function(){n.select().forEachRowIndex(function(p,o){m(n,p,o);
});
},{layout:true,recalc:true});
},includesHiddenColumns:function(m){return this._sheet._grid._columns.includesHidden(m.topLeft.col,m.bottomRight.col);
},includesHiddenRows:function(m){return this._sheet._grid._rows.includesHidden(m.topLeft.row,m.bottomRight.row);
},selectionIncludesHiddenColumns:function(){return this.includesHiddenColumns(this._sheet.select());
},selectionIncludesHiddenRows:function(){return this.includesHiddenRows(this._sheet.select());
},deleteSelectedColumns:function(){this.forEachSelectedColumn(function(o,n,m){o.deleteColumn(n-m);
});
},deleteSelectedRows:function(){this.forEachSelectedRow(function(o,n,m){o.deleteRow(n-m);
});
},hideSelectedColumns:function(){this.forEachSelectedColumn(function(n,m){n.hideColumn(m);
});
},hideSelectedRows:function(){this.forEachSelectedRow(function(n,m){n.hideRow(m);
});
},unhideSelectedColumns:function(){this.forEachSelectedColumn(function(n,m){n.unhideColumn(m);
});
},unhideSelectedRows:function(){this.forEachSelectedRow(function(n,m){n.unhideRow(m);
});
},addColumnLeft:function(){this.forEachSelectedColumn(function(o,n,m){o.insertColumn(n-m);
});
},addColumnRight:function(){this.forEachSelectedColumn(function(o,n,m){o.insertColumn(n+(m+1));
});
},canAddRow:function(){var m=this._sheet.select().toRangeRef();
var n=m.height();
return this._sheet.canInsertRow(0,n);
},addRowAbove:function(){this.forEachSelectedRow(function(o,n,m){o.insertRow(n-m);
});
},addRowBelow:function(){this.forEachSelectedRow(function(o,n,m){o.insertRow(n+(m+1));
});
}});
l.spreadsheet.AxisManager=k;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/clipboard",["kendo.core"],l);
}(function(){(function(n){if(n.support.browser.msie&&n.support.browser.version<9){return;
}var k=n.jQuery;
var o=n.spreadsheet.RangeRef;
var l=n.spreadsheet.CellRef;
var m=n.Class.extend({init:function(p){this.workbook=p;
this.origin=n.spreadsheet.NULLREF;
this.iframe=document.createElement("iframe");
this.iframe.className="k-spreadsheet-clipboard-paste";
this.menuInvoked=true;
this._external={};
this._uid=n.guid();
document.body.appendChild(this.iframe);
},canCopy:function(){var q={canCopy:true};
var p=this.workbook.activeSheet().select();
if(p===n.spreadsheet.NULLREF){q.canCopy=false;
}if(p instanceof n.spreadsheet.UnionRef){q.canCopy=false;
q.multiSelection=true;
}if(this.menuInvoked){q.canCopy=false;
q.menuInvoked=true;
}return q;
},canPaste:function(){var r=this.workbook.activeSheet();
var q=this.pasteRef();
var s={canPaste:true};
if(q===n.spreadsheet.NULLREF){var p=this._external.hasOwnProperty("html")||this._external.hasOwnProperty("plain");
s.pasteOnMerged=this.intersectsMerged();
s.canPaste=s.pasteOnMerged?false:p;
return s;
}if(!q.eq(r.unionWithMerged(q))){s.canPaste=false;
s.pasteOnMerged=true;
}if(this.menuInvoked){s.canPaste=false;
s.menuInvoked=true;
}return s;
},intersectsMerged:function(){var q=this.workbook.activeSheet();
var r=this.parse(this._external);
this.origin=this.stateRangeRef(r);
var p=this.pasteRef();
return !p.eq(q.unionWithMerged(p));
},copy:function(){var p=this.workbook.activeSheet();
this.origin=p.select();
this.contents=p.selection().getState();
},cut:function(){var p=this.workbook.activeSheet();
this.copy();
p.range(p.select()).clear();
},pasteRef:function(){var t=this.workbook.activeSheet();
var q=t.activeCell().first();
var r=this.origin.first();
var s=r.row-q.row;
var p=r.col-q.col;
return this.origin.relative(s,p,3);
},stateRangeRef:function(u){var t=[];
var r=[];
for(var s in u){if(s==="mergedCells"||s==="ref"){continue;
}var p=s.split(",");
t.push(p[0]);
r.push(p[1]);
}var v=new l(Math.min.apply(null,t),Math.min.apply(null,r));
var q=new l(Math.max.apply(null,t),Math.max.apply(null,r));
return new o(v,q);
},destroy:function(){document.body.removeChild(this.iframe);
},paste:function(){var r={};
var q=this.workbook.activeSheet();
if(this._isInternal()){r=this.contents;
}else{r=this.parse(this._external);
this.origin=this.stateRangeRef(r);
}var p=this.pasteRef();
q.range(p).clear().setState(r);
q.triggerChange({recalc:true,ref:p});
},external:function(p){if(p.html||p.plain){this._external=p;
}else{return this._external;
}},parse:function(p){var s={ref:new l(0,0,0),mergedCells:[]};
if(p.html){var q=this.iframe.contentWindow.document;
q.open();
q.write(p.html);
q.close();
var t=k(q).find("table:first");
if(t.length){s=this._parseHTML(t.find("tbody:first"));
}else{if(!p.plain){var r=k(q.body).find(":not(style)");
s["0,0"]=this._cellState(r.text());
}else{s=this._parseTSV(p.plain);
}}}else{s=this._parseTSV(p.plain);
}return s;
},_parseHTML:function(q){var r=this;
var p={ref:new l(0,0,0),mergedCells:[]};
q.find("tr").each(function(s,t){k(t).find("td").each(function(w,D){var C=parseInt(k(D).attr("rowspan"),10)-1||0;
var x=parseInt(k(D).attr("colspan"),10)-1||0;
var u="<td/>";
var v;
if(C){var y=s+C;
for(var A=s;
A<=y;
A++){var B=q.find("tr").eq(A);
if(A>s){u="<td class='rowspan'></td>";
if(w===0){B.find("td").eq(w).after(u);
}else{var z=Math.min(B.find("td").length,w);
B.find("td").eq(z-1).after(u);
}}if(x){for(v=w;
v<x+w;
v++){u="<td class='rowspan colspan'></td>";
B.find("td").eq(v).after(u);
}}}}else{if(x){for(v=w;
v<x+w;
v++){u="<td class='colspan'></td>";
k(t).find("td").eq(v).after(u);
}}}});
});
q.find("tr").each(function(s,t){k(t).find("td").each(function(w,C){var z=s+","+w;
var A=parseInt(k(C).attr("rowspan"),10)-1||0;
var x=parseInt(k(C).attr("colspan"),10)-1||0;
var v=r._cellState(k(C));
p[z]=v;
if(A||x){var B=String.fromCharCode(65+w);
var y=String.fromCharCode(65+w+x);
var u=B+(s+1)+":"+y+(s+1+A);
p.mergedCells.push(u);
}});
});
return p;
},_parseTSV:function(r){var u={ref:new l(0,0,0),mergedCells:[]};
if(r.indexOf("\t")===-1&&r.indexOf("\n")==-1){u["0,0"]={value:r};
}else{var t=r.split("\n");
for(var s=0;
s<t.length;
s++){var q=t[s].split("\t");
for(var p=0;
p<q.length;
p++){u[s+","+p]={value:q[p]};
}}}return u;
},_isInternal:function(){if(this._external.html===j){return true;
}var p=k("<div/>").html(this._external.html).find("table.kendo-clipboard-"+this._uid).length?true:false;
var q=k("<div/>").html(this._external.plain).find("table.kendo-clipboard-"+this._uid).length?true:false;
if(p||q){return true;
}return false;
},_cellState:function(q){var s=window.getComputedStyle(q[0]);
var t=q.text();
var p=this._borderObject(s);
var r={value:t===""?null:t,borderBottom:p.borderBottom,borderRight:p.borderRight,borderLeft:p.borderLeft,borderTop:p.borderTop,fontSize:parseInt(s["font-size"],10)};
if(s["background-color"]!=="rgb(0, 0, 0)"&&s["background-color"]!=="rgba(0, 0, 0, 0)"){r.background=s["background-color"];
}if(s.color!=="rgb(0, 0, 0)"&&s.color!=="rgba(0, 0, 0, 0)"){r.color=s.color;
}if(s["text-decoration"]=="underline"){r.underline=true;
}if(s["font-style"]=="italic"){r.italic=true;
}if(s["font-weight"]=="bold"){r.bold=true;
}if(this._strippedStyle(s["text-align"])!=="right"){r.textAlign=this._strippedStyle(s["text-align"]);
}if(s["vertical-align"]!=="middle"){r.verticalAlign=s["vertical-align"];
}if(s["word-wrap"]!=="normal"){r.wrap=true;
}return r;
},_strippedStyle:function(q){var p=["-ms-","-moz-","-webkit-"];
p.forEach(function(r){q=q.replace(r,"");
});
return q;
},_borderObject:function(r){var p={};
var q=["borderBottom","borderRight","borderLeft","borderTop"];
q.forEach(function(s){if(r[s+"Style"]=="none"){p[s]=null;
return;
}p[s]={size:1,color:r[s+"Color"]};
});
return p;
}});
n.spreadsheet.Clipboard=m;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/range",["kendo.core","util/text-metrics"],l);
}(function(){(function(n){if(n.support.browser.msie&&n.support.browser.version<9){return;
}var k=n.jQuery;
var t=n.spreadsheet.UnionRef;
var r=["color","fontFamily","underline","italic","bold","textAlign","verticalAlign","background"];
var l={borderTop:{complement:"borderBottom",direction:{top:-1,bottom:-1}},borderLeft:{complement:"borderRight",direction:{left:-1,right:-1}},borderRight:{complement:"borderLeft",direction:{left:1,right:1}},borderBottom:{complement:"borderTop",direction:{top:1,bottom:1}}};
var q=n.Class.extend({init:function(u,v){this._sheet=v;
this._ref=u;
},_normalize:function(u){return this._sheet._grid.normalize(u);
},_set:function(u,x,v){var w=this._sheet;
this._ref.forEach(function(y){w._set(y.toRangeRef(),u,x);
});
if(!v){w.triggerChange({recalc:u=="formula"||u=="value"||u=="validation",value:x,ref:this._ref});
}return this;
},_get:function(u){return this._sheet._get(this._ref.toRangeRef(),u);
},_property:function(u,v){if(v===j){return this._get(u);
}else{return this._set(u,v);
}},value:function(u){if(u!==j){this._set("formula",null,true);
}return this._property("value",u);
},resize:function(u){var v=this._resizedRef(u);
return new q(v,this._sheet);
},_resizedRef:function(u){return this._ref.map(function(v){return v.toRangeRef().resize(u);
});
},_border:function(w,z){var x;
var u=l[w].complement;
var v=l[w].direction;
var y=this._sheet;
y.batch(function(){x=this._property(w,z);
if(z!==j){this._resizedRef(v).forEach(function(A){if(A!==n.spreadsheet.NULLREF){new q(A,y)._property(u,null);
}});
}}.bind(this),{});
return x;
},_collapsedBorder:function(w){var x=this._property(w);
var u=l[w].complement;
var v=l[w].direction;
this._resizedRef(v).forEach(function(z){if(!x&&z!==n.spreadsheet.NULLREF){var y=new q(z,this._sheet);
x=y._property(u);
}}.bind(this));
return x;
},borderTop:function(u){return this._border("borderTop",u);
},borderRight:function(u){return this._border("borderRight",u);
},borderBottom:function(u){return this._border("borderBottom",u);
},borderLeft:function(u){return this._border("borderLeft",u);
},collapsedBorderTop:function(){return this._collapsedBorder("borderTop");
},collapsedBorderRight:function(){return this._collapsedBorder("borderRight");
},collapsedBorderBottom:function(){return this._collapsedBorder("borderBottom");
},collapsedBorderLeft:function(){return this._collapsedBorder("borderLeft");
},input:function(z){if(z!==j){var w=this._ref.toRangeRef().topLeft;
var A=n.spreadsheet.calc.parse(this._sheet.name(),w.row,w.col,z);
this._sheet.batch(function(){var x=null;
if(A.type=="exp"){x=n.spreadsheet.calc.compile(A);
}else{if(A.type=="date"){this.format(s(n.culture().calendar.patterns.d));
}else{if(A.type=="percent"){this.format(A.value*100==(A.value*100|0)?"0%":"0.00%");
}}}this.formula(x);
if(!x){this.value(A.value);
}}.bind(this),{recalc:true,value:z,ref:this._ref,editorChange:this._sheet.isInEditMode()});
return this;
}else{z=this._get("value");
var u=this._get("format");
var v=this._get("formula");
var y=u&&!v&&n.spreadsheet.formatting.type(z,u);
if(v){z="="+v;
}else{if(y==="date"){z=n.toString(n.spreadsheet.numberToDate(z),n.culture().calendar.patterns.d);
}else{if(y==="percent"){z=z*100+"%";
}else{if(typeof z=="string"&&(/^[=']/.test(z)||/^(?:true|false)$/i.test(z)||o(z))){z="'"+z;
}}}}return z;
}},enable:function(u){if(u===j){u=true;
this._sheet.forEach(this._ref.toRangeRef(),function(v,v,w){if(w.enable===false){u=false;
}});
return u;
}this._property("enable",u);
},format:function(u){return this._property("format",u);
},formula:function(v){if(v===j){var u=this._get("formula");
return u?""+u:null;
}return this._property("formula",v);
},validation:function(v){if(v===j){var u=this._get("validation");
return u?u.toJSON():null;
}return this._property("validation",v);
},_getValidationState:function(){var x=this._ref.toRangeRef();
var A=x.topLeft.row;
var z=x.topLeft.col;
var v=x.bottomRight.row;
var u=x.bottomRight.col;
var w,y;
for(w=z;
w<=u;
w++){for(y=A;
y<=v;
y++){var B=this._sheet._validation(y,w);
if(B&&B.type==="reject"&&B.value===false){return B;
}}}return false;
},merge:function(){this._ref=this._sheet._merge(this._ref);
return this;
},unmerge:function(){var u=this._sheet._mergedCells;
this._ref.forEach(function(v){v.toRangeRef().intersecting(u).forEach(function(w){u.splice(u.indexOf(w),1);
});
});
this._sheet.triggerChange({});
return this;
},select:function(){this._sheet.select(this._ref);
return this;
},values:function(D){if(this._ref instanceof t){throw new Error("Unsupported for multiple ranges.");
}if(this._ref===n.spreadsheet.NULLREF){if(D!==j){throw new Error("Unsupported for NULLREF.");
}else{return[];
}}var x=this._ref.toRangeRef();
var B=x.topLeft.row;
var A=x.topLeft.col;
var v=x.bottomRight.row;
var u=x.bottomRight.col;
var w,y;
if(D===j){D=new Array(x.height());
for(var E=0;
E<D.length;
E++){D[E]=new Array(x.width());
}for(w=A;
w<=u;
w++){for(y=B;
y<=v;
y++){D[y-B][w-A]=this._sheet._value(y,w);
}}return D;
}else{for(w=A;
w<=u;
w++){for(y=B;
y<=v;
y++){var z=D[y-B];
if(z){var C=z[w-A];
if(C!==j){this._sheet._value(y,w,C);
}}}}this._sheet.triggerChange({recalc:true});
return this;
}},_properties:function(y){if(this._ref instanceof t){throw new Error("Unsupported for multiple ranges.");
}if(this._ref===n.spreadsheet.NULLREF){if(y!==j){throw new Error("Unsupported for NULLREF.");
}else{return[];
}}var z=this._ref.toRangeRef();
var F=z.topLeft.row;
var E=z.topLeft.col;
var v=z.bottomRight.row;
var u=z.bottomRight.col;
var w,A;
var D=this._sheet;
if(y===j){y=new Array(z.height());
D.forEach(z,function(J,G,H){J-=F;
G-=E;
var I=y[J]||(y[J]=[]);
I[G]=H;
});
return y;
}else{var x;
z=z.clone();
var C=function(G){var H=x[G];
z.topLeft.row=z.bottomRight.row=A;
z.topLeft.col=z.bottomRight.col=w;
D._set(z,G,H);
};
for(w=E;
w<=u;
w++){for(A=F;
A<=v;
A++){var B=y[A-F];
if(B){x=B[w-E];
if(x){Object.keys(x).forEach(C);
}}}}D.triggerChange({recalc:true,ref:this._ref});
return this;
}},clear:function(v){var u=!v||!Object.keys(v).length;
var x=this._sheet;
var w={recalc:u||v&&v.contentsOnly===true,ref:this._ref};
x.batch(function(){if(w.recalc){this.formula(null);
}if(u){this.validation(null);
}if(u||v&&v.formatOnly===true){r.forEach(function(y){this[y](null);
}.bind(this));
this.format(null);
this.unmerge();
}}.bind(this),w);
return this;
},clearContent:function(){return this.clear({contentsOnly:true});
},clearFormat:function(){return this.clear({formatOnly:true});
},isSortable:function(){return !(this._ref instanceof t||this._ref===n.spreadsheet.NULLREF);
},sort:function(u){if(this._ref instanceof t){throw new Error("Unsupported for multiple ranges.");
}if(this._ref===n.spreadsheet.NULLREF){throw new Error("Unsupported for NULLREF.");
}if(u===j){u={column:0};
}u=u instanceof Array?u:[u];
this._sheet._sortBy(this._ref.toRangeRef(),u.map(function(w,v){if(typeof w==="number"){w={column:w};
}return{index:w.column===j?v:w.column,ascending:w.ascending===j?true:w.ascending};
}));
return this;
},isFilterable:function(){return !(this._ref instanceof t);
},filter:function(u){if(this._ref instanceof t){throw new Error("Unsupported for multiple ranges.");
}if(u===false){this.clearFilters();
}else{u=u===true?[]:u instanceof Array?u:[u];
this._sheet._filterBy(this._ref.toRangeRef(),u.map(function(w,v){return{index:w.column===j?v:w.column,filter:w.filter};
}));
}return this;
},clearFilter:function(u){this._sheet.clearFilter(u);
},clearFilters:function(){var u=this._sheet.filter();
var w=[];
if(u){for(var v=0;
v<u.columns.length;
v++){w.push(v);
}this._sheet.batch(function(){this.clearFilter(w);
this._filter=null;
},{layout:true,filter:true});
}},hasFilter:function(){var u=this._sheet.filter();
return !!u;
},leftColumn:function(){return new q(this._ref.leftColumn(),this._sheet);
},rightColumn:function(){return new q(this._ref.rightColumn(),this._sheet);
},topRow:function(){return new q(this._ref.topRow(),this._sheet);
},bottomRow:function(){return new q(this._ref.bottomRow(),this._sheet);
},column:function(u){return new q(this._ref.toColumn(u),this._sheet);
},row:function(u){return new q(this._ref.toRow(u),this._sheet);
},forEachRow:function(u){this._ref.forEachRow(function(v){u(new q(v,this._sheet));
}.bind(this));
},forEachColumn:function(u){this._ref.forEachColumn(function(v){u(new q(v,this._sheet));
}.bind(this));
},sheet:function(){return this._sheet;
},topLeft:function(){return this._ref.toRangeRef().topLeft;
},intersectingMerged:function(){var v=this._sheet;
var u=[];
v._mergedCells.forEach(function(w){if(w.intersects(this._ref)){u.push(w.toString());
}}.bind(this));
return u;
},getState:function(v){var w={ref:this._ref.first()};
var u;
if(!v){u=n.spreadsheet.ALL_PROPERTIES;
w.mergedCells=this.intersectingMerged();
}else{if(v==="input"){u=["value","formula"];
}else{if(v==="border"){u=["borderLeft","borderTop","borderRight","borderBottom"];
}else{u=[v];
}}}this.forEachCell(function(A,z,x){var y=w[A+","+z]={};
u.forEach(function(B){y[B]=x[B]||null;
});
});
return w;
},setState:function(y){var x=this._sheet;
var v=this._ref.first();
var w=y.ref.row-v.row;
var u=y.ref.col-v.col;
x.batch(function(){if(y.mergedCells){this.unmerge();
}this.forEachCell(function(D,A){var z=y[D+w+","+(A+u)];
var C=x.range(D,A);
for(var B in z){if(B!="value"){C._set(B,z[B]);
}}if(!z.formula){C._set("value",z.value);
}});
if(y.mergedCells){y.mergedCells.forEach(function(z){z=x._ref(z).relative(w,u,3);
x.range(z).merge();
},this);
}}.bind(this),{recalc:true});
},_adjustRowHeight:function(){var w=this._sheet;
var x=this.getState();
var v=[];
for(var u=0;
u<x.mergedCells.length;
u++){v.push(w.range(x.mergedCells[u]));
}this.forEachRow(function(z){var y=z.sheet().rowHeight(z.topLeft().row);
z.forEachCell(function(E,C,A){var B=w.range(E,C);
var F=0;
for(var D=0;
D<v.length;
D++){if(B._ref.intersects(v[D]._ref)){F+=A.width;
break;
}}var G=Math.max(w.columnWidth(C),F);
y=Math.max(y,n.spreadsheet.util.getTextHeight(A.value,G,A.fontSize,A.wrap));
});
w.rowHeight(z.topLeft().row,Math.max(w.rowHeight(z.topLeft().row),y));
});
},forEachCell:function(u){this._ref.forEach(function(v){this._sheet.forEach(v.toRangeRef(),u.bind(this));
}.bind(this));
},hasValue:function(){var u=false;
this.forEachCell(function(x,w,v){if(Object.keys(v).length!==0){u=true;
}});
return u;
},wrap:function(u){if(u===j){return !!this._property("wrap");
}this.forEachRow(function(w){var v=w.sheet().rowHeight(w.topLeft().row);
w.forEachCell(function(z,y,x){var A=this._sheet.columnWidth(y);
if(x.value!==null&&x.value!==j){v=Math.max(v,n.spreadsheet.util.getTextHeight(x.value,A,x.fontSize,true));
}});
w.sheet().rowHeight(w.topLeft().row,v);
}.bind(this));
this._property("wrap",u);
return this;
},fontSize:function(u){if(u===j){return this._property("fontSize");
}this.forEachRow(function(w){var v=w.sheet().rowHeight(w.topLeft().row);
w.forEachCell(function(z,y,x){var A=this._sheet.columnWidth(y);
if(x.value!==null&&x.value!==j){v=Math.max(v,n.spreadsheet.util.getTextHeight(x.value,A,u,x.wrap));
}});
w.sheet().rowHeight(w.topLeft().row,v);
}.bind(this));
this._property("fontSize",u);
return this;
},draw:function(v,u){this._sheet.draw(this,v,u);
}});
k.each(r,function(u,v){q.prototype[v]=function(w){return this._property(v,w);
};
});
function s(u){return u.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm");
}function o(u){return !/^=/.test(u)&&/number|percent/.test(n.spreadsheet.calc.parse(null,0,0,u).type);
}var p=k('<div style="position: absolute !important; top: -4000px !important; height: auto !important;padding: 1px !important; margin: 0 !important; border: 1px solid black !important;line-height: normal !important; visibility: hidden !important;white-space: pre-wrap !important; word-break: break-all !important;" />')[0];
function m(w,x,u,y){var v={baselineMarkerSize:0,width:x+"px","font-size":(u||12)+"px","word-break":y===true?"break-all":"normal","white-space":y===true?"pre-wrap":"pre"};
return n.util.measureText(w,v,p).height;
}n.spreadsheet.util={getTextHeight:m};
n.spreadsheet.Range=q;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/runtime",["spreadsheet/references"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var p={};
var V=kendo.spreadsheet;
V.calc=p;
var B=p.runtime={};
var s=kendo.Class;
var T=V.Ref;
var r=V.CellRef;
var S=V.RangeRef;
var W=V.UnionRef;
var M=V.NULLREF;
function q(aa){if(aa instanceof q){return aa;
}this.code=aa;
}q.prototype.toString=function(){return"#"+this.code+(this.code=="NAME"?"?":"!");
};
var u=s.extend({init:function u(aa,ab,ad,ac){this.callback=aa;
this.formula=ab;
this.ss=ad;
this.parent=ac;
},resolve:function(ab){var aa=this;
if(ab instanceof T){aa.resolveCells([ab],function(){ab=aa.getRefData(ab);
if(Array.isArray(ab)){ab=ab[0];
}aa._resolve(ab);
});
}else{aa._resolve(ab);
}},_resolve:function(ab){if(ab===j){ab=null;
}var aa=this.formula;
aa.value=ab;
if(this.ss.onFormula(aa)&&this.callback){this.callback.call(aa,ab);
}},resolveCells:function(aa,ad){var ac=this,af=[];
(function ah(aj){for(var ak=0;
ak<aj.length;
++ak){var al=aj[ak];
if(al instanceof T){ab(ac.getRefCells(al));
}if(Array.isArray(al)){ah(al);
}}}(aa));
if(!af.length){return ad.call(ac);
}for(var ai=af.length,ag=0;
ag<af.length;
++ag){ae(af[ag]);
}function ae(aj){aj.formula.exec(ac.ss,function(){if(!--ai){ad.call(ac);
}},ac);
}function ab(aj){for(var al=0;
al<aj.length;
++al){var ak=aj[al];
if(ak.formula){af.push(ak);
}}return true;
}},cellValues:function(aa,ab){var ad=[];
for(var ac=0;
ac<aa.length;
++ac){var ae=aa[ac];
if(ae instanceof T){ae=this.getRefData(ae);
ad=ad.concat(ae);
}else{if(Array.isArray(ae)){ad=ad.concat(this.cellValues(ae));
}else{if(ae instanceof I){ad=ad.concat(this.cellValues(ae.data));
}else{ad.push(ae);
}}}}if(ab){return ab.apply(this,ad);
}return ad;
},force:function(aa){if(aa instanceof T){return this.getRefData(aa);
}return aa;
},func:function(ad,ab,aa){ad=ad.toLowerCase();
var ac=D[ad];
if(ac){return ac.call(this,ab,aa);
}ab(new q("NAME"));
},bool:function(aa){if(aa instanceof T){aa=this.getRefData(aa);
}if(typeof aa=="string"){return aa.toLowerCase()=="true";
}if(typeof aa=="number"){return aa!==0;
}if(typeof aa=="boolean"){return aa;
}return aa!=null;
},asMatrix:function(ad){if(ad instanceof I){return ad;
}var af=this;
if(ad instanceof S){var ag=ad.topLeft;
var ah=ag.row,ab=ag.col;
var aa=af.getRefCells(ad);
var ac=new I(af);
if(isFinite(ad.width())){ac.width=ad.width();
}if(isFinite(ad.height())){ac.height=ad.height();
}if(!isFinite(ah)){ah=0;
}if(!isFinite(ab)){ab=0;
}aa.forEach(function(ai){ac.set(ai.row-ah,ai.col-ab,ai.value);
});
return ac;
}if(Array.isArray(ad)&&ad.length>0){var ac=new I(af),ae=0;
ad.forEach(function(ak){var ai=0;
var aj=1;
ak.forEach(function(al){var am=al instanceof S;
if(al instanceof T&&!am){al=af.getRefData(al);
}if(am||Array.isArray(al)){al=af.asMatrix(al);
}if(al instanceof I){al.each(function(ao,ap,an){ac.set(ae+ap,ai+an,ao);
});
aj=Math.max(aj,al.height);
ai+=al.width;
}else{ac.set(ae,ai++,al);
}});
ae+=aj;
});
return ac;
}},getRefCells:function(ab,aa){return this.ss.getRefCells(ab,aa);
},getRefData:function(aa){return this.ss.getData(aa);
},workbook:function(){return this.ss.workbook;
}});
var I=s.extend({init:function I(aa){this.context=aa;
this.height=0;
this.width=0;
this.data=[];
},clone:function(){var aa=new I(this.context);
aa.height=this.height;
aa.width=this.width;
aa.data=this.data.map(function(ab){return ab.slice();
});
return aa;
},get:function(ac,aa){var ab=this.data[ac];
var ad=ab?ab[aa]:null;
return ad instanceof T?this.context.getRefData(ad):ad;
},set:function(ad,aa,ab){var ac=this.data[ad];
if(ac==null){ac=this.data[ad]=[];
}ac[aa]=ab;
if(ad>=this.height){this.height=ad+1;
}if(aa>=this.width){this.width=aa+1;
}},each:function(ab,ac){for(var ad=0;
ad<this.height;
++ad){for(var aa=0;
aa<this.width;
++aa){var ae=this.get(ad,aa);
if(ac||ae!=null){ae=ab.call(this.context,ae,ad,aa);
if(ae!==j){return ae;
}}}}},map:function(aa,ab){var ac=new I(this.context);
this.each(function(ae,af,ad){ac.set(af,ad,aa.call(this,ae,af,ad));
},ab);
return ac;
},eachRow:function(aa){for(var ab=0;
ab<this.height;
++ab){var ac=aa.call(this.context,ab);
if(ac!==j){return ac;
}}},eachCol:function(ab){for(var aa=0;
aa<this.width;
++aa){var ac=ab.call(this.context,aa);
if(ac!==j){return ac;
}}},mapRow:function(aa){var ab=new I(this.context);
this.eachRow(function(ac){ab.set(ac,0,aa.call(this.context,ac));
});
return ab;
},mapCol:function(aa){var ab=new I(this.context);
this.eachCol(function(ac){ab.set(0,ac,aa.call(this.context,ac));
});
return ab;
},toString:function(){return JSON.stringify(this.data);
},transpose:function(){var aa=new I(this.context);
this.each(function(ac,ad,ab){aa.set(ab,ad,ac);
});
return aa;
},unit:function(ad){this.width=this.height=ad;
var aa=this.data=new Array(ad);
for(var ab=ad;
--ab>=0;
){var ae=aa[ab]=new Array(ad);
for(var ac=ad;
--ac>=0;
){ae[ac]=ab==ac?1:0;
}}return this;
},multiply:function(ab){var aa=this,ae=new I(aa.context);
for(var af=0;
af<aa.height;
++af){for(var ac=0;
ac<ab.width;
++ac){var ag=0;
for(var ad=0;
ad<aa.width;
++ad){var ah=aa.get(af,ad);
var ai=ab.get(ad,ac);
if(typeof ah!="number"||typeof ai!="number"){throw new q("VALUE");
}ag+=ah*ai;
}ae.set(af,ac,ag);
}}return ae;
},adds:function(ab,af){var aa=this,ad=new I(aa.context);
var ag=af?-1:1;
for(var ae=0;
ae<aa.height;
++ae){for(var ac=0;
ac<aa.width;
++ac){var ah=aa.get(ae,ac),ai=ab.get(ae,ac);
ad.set(ae,ac,ah+ag*ai);
}}return ad;
},determinant:function(){var aa=this.clone().data;
var ag=aa.length;
var ac=1,ab,af,ad,ae;
for(ab=0;
ab<ag;
ab++){for(af=ab;
af<ag&&!aa[af][ab];
af++){}if(af==ag){return 0;
}if(af!=ab){ac=-ac;
for(ae=ab;
ae<ag;
ae++){var ah=aa[ab][ae];
aa[ab][ae]=aa[af][ae];
aa[af][ae]=ah;
}}for(ad=ab+1;
ad<ag;
ad++){for(ae=ab+1;
ae<ag;
ae++){aa[ad][ae]-=aa[ab][ae]*aa[ad][ab]/aa[ab][ab];
}}ac*=aa[ab][ab];
}return ac;
},inverse:function(){var ah=this.width;
var ag=this.augment(new I(this.context).unit(ah));
var aa=ag.data;
var ai;
for(var af=0;
af<ah;
++af){var ad=k(af,ah,function(aj){return aa[aj][af];
});
if(!aa[ad][af]){return null;
}if(af!=ad){ai=aa[af];
aa[af]=aa[ad];
aa[ad]=ai;
}for(var ac=af+1;
ac<ah;
++ac){for(var ae=af+1;
ae<2*ah;
++ae){aa[ac][ae]-=aa[af][ae]*aa[ac][af]/aa[af][af];
}aa[ac][af]=0;
}}for(var ac=0;
ac<ah;
++ac){for(var ab=aa[ac][ac],ae=0;
ae<2*ah;
++ae){aa[ac][ae]/=ab;
}}for(var af=ah;
--af>=0;
){for(var ac=af;
--ac>=0;
){if(aa[ac][af]){for(var ae=2*ah;
--ae>=ah;
){aa[ac][ae]-=aa[af][ae]*aa[ac][af];
}}}}return ag.slice(0,ah,ah,ah);
},augment:function(aa){var ac=this.clone(),ab=ac.width;
aa.each(function(af,ae,ad){ac.set(ae,ad+ab,af);
});
return ac;
},slice:function(af,aa,ab,ag){var ae=new I(this.context);
for(var ac=0;
ac<ab;
++ac){for(var ad=0;
ad<ag;
++ad){ae.set(ac,ad,this.get(af+ac,aa+ad));
}}return ae;
}});
function k(ac,aa,ab){var ad=ab(ac),ae=ac;
while(++ac<aa){var af=ab(ac);
if(af>ad){ad=af;
ae=ac;
}}return ae;
}var C=s.extend({init:function C(ad,ab,ac,af,ae,aa){this.refs=ad;
this.handler=ab;
this.print=ac;
this.absrefs=null;
this.sheet=af;
this.row=ae;
this.col=aa;
this.onReady=[];
this.pending=false;
},clone:function(ae,ad,aa){var ab=ae.toLowerCase();
var ac=this.refs;
if(ab!=this.sheet.toLowerCase()){ac=ac.map(function(af){if(!af.hasSheet()&&af.sheet.toLowerCase()!=ab){af=af.clone().setSheet(ae);
}return af;
});
}return new C(ac,this.handler,this.print,ae,ad,aa);
},resolve:function(aa){this.pending=false;
this.onReady.forEach(function(ab){ab(aa);
});
},exec:function(ad,aa,ac){if("value" in this){if(aa){aa(this.value);
}}else{if(aa){this.onReady.push(aa);
}var ab=new u(this.resolve,this,ad,ac);
while(ac){if(ac.formula===this){this.pending=false;
ab.resolve(new q("CIRCULAR"));
return;
}ac=ac.parent;
}if(this.pending){return;
}this.pending=true;
if(!this.absrefs){this.absrefs=this.refs.map(function(ae){return ae.absolute(this.row,this.col);
},this);
}this.handler.call(ab);
}},reset:function(){this.onReady=[];
this.pending=false;
delete this.value;
},renameSheet:function(ab,aa){ab=ab.toLowerCase();
this.absrefs=null;
if(this.sheet.toLowerCase()==ab){this.sheet=aa;
}this.refs.forEach(function(ac){if(ac.sheet.toLowerCase()==ab){ac.sheet=aa;
}});
},adjust:function(aa,ai,aj,ab){aa=aa.toLowerCase();
var ae=this.row;
var ac=this.col;
var af=this.sheet.toLowerCase();
var ad=false;
if(af==aa){if(ai=="row"&&ae>=aj){this.row+=ab;
ad=true;
}if(ai=="col"&&ac>=aj){this.col+=ab;
ad=true;
}}var ah=this.row;
var ag=this.col;
this.absrefs=null;
this.refs=this.refs.map(function(ak){if(ak===M){return ak;
}if(ak.sheet.toLowerCase()!=aa){if(ad){if(ai=="row"&&ae>=aj){ak=ak.relative(ab,0);
}if(ai=="col"&&ac>=aj){ak=ak.relative(0,ab);
}}return ak;
}return ak.adjust(ae,ac,ah,ag,ai=="row",aj,ab);
},this);
},toString:function(){return this.print(this.row,this.col);
}});
var D=Object.create(null);
D["if"]=function(ab,aa){var ae=this;
var ac=aa[0],af=aa[1],ad=aa[2];
this.resolveCells([ac],function(){var ag=ae.asMatrix(ac);
if(ag){af(function(ah){ad(function(ai){var ak=ae.asMatrix(ah);
var aj=ae.asMatrix(ai);
ab(ag.map(function(an,am,al){if(ae.bool(an)){return ak?ak.get(am,al):ah;
}else{return aj?aj.get(am,al):ai;
}}));
});
});
}else{if(ae.bool(ac)){af(ab);
}else{ad(ab);
}}});
};
D.f=function(aa){aa((1+Math.sqrt(5))/2);
};
function t(ai,aa){var ab="function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ";
var an="function resolve(args, callback) { var toResolve = [], i = 0; ";
var am,ah,al="'use strict'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE'; ",ak=false;
var ac=false,aj=false;
al+=aa.map(ad).join("");
al+="if (i < args.length) return new CalcError('N/A'); ";
al+="return xargs; } ";
ab+="return { args: xargs, width: width, height: height, arrays: arrays }; } ";
var af;
if(ak){an+="this.resolveCells(toResolve, callback); } ";
af=new Function("CalcError",al+an+ab+" return { resolve: resolve, check: check, arrayArgs: arrayArgs };");
}else{af=new Function("CalcError",al+" return { check: check };");
}af=af(q);
if(!aj){delete af.arrayArgs;
}return af;
function ad(au){am=au[0];
var aq="{ ";
if(Array.isArray(am)){ab+="while (i < args.length) { ";
an+="while (i < args.length) { ";
aq+="xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ";
aq+="while (i < args.length) { ";
aq+=au.map(ad).join("");
aq+="} ";
aq+="xargs = stack.pop(); ";
an+="} ";
ab+="} ";
}else{if(am=="+"){ab+="while (i < args.length) { ";
an+="while (i < args.length) { ";
aq+="xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ";
aq+="do { ";
aq+=au.slice(1).map(ad).join("");
aq+="} while (i < args.length); ";
aq+="xargs = stack.pop(); ";
an+="} ";
ab+="} ";
}else{if(am=="?"){aq+="if (!("+ae(au[1])+")) return new CalcError(err); ";
}else{var at=au[1];
if(Array.isArray(at)&&/^#?collect/.test(at[0])){var ar=at[2];
ag();
aq+="try {var $"+am+" = this.cellValues(args.slice(i";
if(ar){aq+=", i + "+ar;
}aq+=")).filter(function($"+am+"){ ";
if(at[0]=="collect"){aq+="if ($"+am+" instanceof CalcError) throw $"+am+"; ";
}aq+="return "+ae(at[1])+"; }, this); ";
if(ar){aq+="i += "+ar+"; ";
}else{aq+="i = args.length; ";
}aq+="xargs.push($"+am+")} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ";
an+="toResolve.push(args.slice(i)); ";
}else{if(at=="rest"){aq+="xargs.push(args.slice(i)); i = args.length; ";
}else{if(ac=/^\*/.test(am)){aj=true;
am=am.substr(1);
}aq+="var $"+am+" = args[i++]; ";
var ap=false;
if(/!$/.test(at)){at=at.substr(0,at.length-1);
ap=true;
}else{aq+="if ($"+am+" instanceof CalcError) return $"+am+"; ";
}aq+=ao(at,ap)+"xargs.push($"+am+"); ";
}}}}}aq+="} ";
return aq;
}function ag(){if(ah){return"$"+am+"";
}ak=true;
ah=true;
an+="toResolve.push(args[i++]); ";
return"($"+am+" = this.force($"+am+"))";
}function ao(ar,ap){ah=false;
var aq="if (!("+ae(ar)+")) { ";
if(ah&&!ap){aq+=" if ($"+am+" instanceof CalcError) return $"+am+"; ";
}aq+="return new CalcError(err); } ";
if(!ah){an+="i++; ";
}if(ac){ab+="var $"+am+" = this.asMatrix(args[i]); if ($"+am+") { xargs.push($"+am+"); width = Math.max(width, $"+am+".width); height = Math.max(height, $"+am+".height); arrays.push(true) } else { xargs.push(args[i]); arrays.push(false); } i++; ";
}else{ab+="xargs.push(args[i++]); arrays.push(false); ";
}return aq;
}function ae(aq){if(Array.isArray(aq)){if(aq[0]=="or"){return"("+aq.slice(1).map(ae).join(") || (")+")";
}if(aq[0]=="and"){return"("+aq.slice(1).map(ae).join(") && (")+")";
}if(aq[0]=="values"){return"("+aq.slice(1).map(function(ar){return ag()+" === "+ar;
}).join(") || (")+")";
}if(aq[0]=="null"){return"("+ae("null")+" ? (($"+am+" = "+aq[1]+"), true) : false)";
}if(aq[0]=="between"||aq[0]=="[between]"){return"("+ag()+" >= "+aq[1]+" && $"+am+" <= "+aq[2]+" ? true : ((err = 'NUM'), false))";
}if(aq[0]=="(between)"){return"("+ag()+" > "+aq[1]+" && $"+am+" < "+aq[2]+" ? true : ((err = 'NUM'), false))";
}if(aq[0]=="(between]"){return"("+ag()+" > "+aq[1]+" && $"+am+" <= "+aq[2]+" ? true : ((err = 'NUM'), false))";
}if(aq[0]=="[between)"){return"("+ag()+" >= "+aq[1]+" && $"+am+" < "+aq[2]+" ? true : ((err = 'NUM'), false))";
}if(aq[0]=="assert"){var ap=aq[2]||"N/A";
return"(("+aq[1]+") ? true : (err = "+JSON.stringify(ap)+", false))";
}if(aq[0]=="not"){return"!("+ae(aq[1])+")";
}throw new Error("Unknown array type condition: "+aq[0]);
}if(aq=="number"){return"(typeof "+ag()+" == 'number' || typeof $"+am+" == 'boolean')";
}if(aq=="integer"){return"((typeof "+ag()+" == 'number' || typeof $"+am+" == 'boolean') ? ($"+am+" |= 0, true) : false)";
}if(aq=="date"){return"((typeof "+ag()+" == 'number') ? ($"+am+" |= 0, true) : false)";
}if(aq=="datetime"){return"(typeof "+ag()+" == 'number')";
}if(aq=="divisor"){return"((typeof "+ag()+" == 'number' || typeof $"+am+" == 'boolean') && ($"+am+" == 0 ? ((err = 'DIV/0'), false) : true))";
}if(aq=="number+"){return"((typeof "+ag()+" == 'number' || typeof $"+am+" == 'boolean') && ($"+am+" >= 0 ? true : ((err = 'NUM'), false)))";
}if(aq=="integer+"){return"((typeof "+ag()+" == 'number' || typeof $"+am+" == 'boolean') && (($"+am+" |= 0) >= 0 ? true : ((err = 'NUM'), false)))";
}if(aq=="number++"){return"((typeof "+ag()+" == 'number' || typeof $"+am+" == 'boolean') && ($"+am+" > 0 ? true : ((err = 'NUM'), false)))";
}if(aq=="integer++"){return"((typeof "+ag()+" == 'number' || typeof $"+am+" == 'boolean') && (($"+am+" |= 0 ) > 0) ? true : ((err = 'NUM'), false))";
}if(aq=="string"){return"(typeof "+ag()+" == 'string')";
}if(aq=="boolean"){return"(typeof "+ag()+" == 'boolean')";
}if(aq=="logical"){return"(typeof "+ag()+" == 'boolean' || (typeof $"+am+" == 'number' ? ($"+am+" = !!$"+am+", true) : false))";
}if(aq=="matrix"){ag();
return"((m = this.asMatrix($"+am+")) ? ($"+am+" = m) : false)";
}if(aq=="#matrix"){return"((m = this.asMatrix($"+am+")) ? ($"+am+" = m) : false)";
}if(aq=="ref"){return"($"+am+" instanceof kendo.spreadsheet.Ref)";
}if(aq=="area"){return"($"+am+" instanceof kendo.spreadsheet.CellRef || $"+am+" instanceof kendo.spreadsheet.RangeRef)";
}if(aq=="cell"){return"($"+am+" instanceof kendo.spreadsheet.CellRef)";
}if(aq=="null"){return"("+ag()+" == null)";
}if(aq=="anyvalue"){return"("+ag()+" != null && i <= args.length)";
}if(aq=="forced"){return"("+ag()+", i <= args.length)";
}if(aq=="anything"){return"(i <= args.length)";
}if(aq=="blank"){return"("+ag()+" == null || $"+am+" === '')";
}throw new Error("Can't check for type: "+aq);
}}function Z(ad,ac,aa){if(aa instanceof q){return aa;
}try{return ac.apply(ad,aa);
}catch(ab){if(ab instanceof q){return ab;
}else{throw ab;
}}}function H(ac,ad,ab,aa){return function(af,ae){function ag(){if(aa){var al=aa.call(this,ae);
ae=al.args;
if(al.width>0&&al.height>0){var aj=new I(this);
for(var ak=0;
ak<al.height;
++ak){for(var ah=0;
ah<al.width;
++ah){var am=[];
for(var ai=0;
ai<ae.length;
++ai){if(al.arrays[ai]){am[ai]=ae[ai].get(ak,ah);
}else{am[ai]=ae[ai];
}}am=ab.call(this,am);
aj.set(ak,ah,Z(this,ac,am));
}}return af(aj);
}}var am=ab.call(this,ae);
af(Z(this,ac,am));
}if(ad){ad.call(this,ae,ag);
}else{ag.call(this);
}};
}function G(ac,ad,ab,aa){return function(af,ae){function ag(){if(aa){var an=aa.call(this,ae);
ae=an.args;
if(an.width>0&&an.height>0){var al=new I(this);
var ai=an.width*an.height;
var ak=function(aq,ap){return function(ar){al.set(aq,ap,ar);
--ai;
if(ai===0){return af(al);
}};
};
for(var am=0;
am<an.height&&ai>0;
++am){for(var ah=0;
ah<an.width&&ai>0;
++ah){var ao=[];
for(var aj=0;
aj<ae.length;
++aj){if(an.arrays[aj]){ao[aj]=ae[aj].get(am,ah);
}else{ao[aj]=ae[aj];
}}ao=ab.call(this,ao);
if(ao instanceof q){al.set(am,ah,ao);
--ai;
if(ai===0){return af(al);
}}else{ao.unshift(ak(am,ah));
ac.apply(this,ao);
}}}return;
}}var an=ab.call(this,ae);
if(an instanceof q){af(an);
}else{an.unshift(af);
ac.apply(this,an);
}}if(ad){ad.call(this,ae,ag);
}else{ag.call(this);
}};
}function A(ab,aa){ab=ab.toLowerCase();
D[ab]=aa;
return{args:function(ac,af){var ad=t(ab,ac);
if(af){if(ad.arrayArgs){console.log(ad.arrayArgs.toString());
}if(ad.resolve){console.log(ad.resolve.toString());
}if(ad.check){console.log(ad.check.toString());
}}var ae=D[ab]=H(aa,ad.resolve,ad.check,ad.arrayArgs);
ae.kendoSpreadsheetArgs=ac;
return this;
},argsAsync:function(ac,af){var ad=t(ab,ac);
if(af){if(ad.arrayArgs){console.log(ad.arrayArgs.toString());
}if(ad.resolve){console.log(ad.resolve.toString());
}if(ad.check){console.log(ad.check.toString());
}}var ae=D[ab]=G(aa,ad.resolve,ad.check,ad.arrayArgs);
ae.kendoSpreadsheetArgs=ac;
return this;
}};
}function v(ac,ab,aa){ab++;
return(1461*(ac+4800+((ab-14)/12|0))/4|0)+(367*(ab-2-12*((ab-14)/12|0))/12|0)-(3*((ac+4900+((ab-14)/12|0))/100|0)/4|0)+aa-32075;
}function F(ad){var ae,ag,ac,ab,af,aa,ah;
ae=ad+68569;
ag=4*ae/146097|0;
ae=ae-((146097*ag+3)/4|0);
ab=4000*(ae+1)/1461001|0;
ae=ae-(1461*ab/4|0)+31;
ac=80*ae/2447|0;
aa=ae-(2447*ac/80|0);
ae=ac/11|0;
af=ac+2-12*ae;
ah=100*(ag-49)+ab+ae;
af--;
return{year:ah,month:af,date:aa,day:(ad+1)%7,ord:O[E(ah)][af]+aa};
}var n=v(1900,0,-1);
var x=[31,28,31,30,31,30,31,31,30,31,30,31];
var O=[[0,31,59,90,120,151,181,212,243,273,304,334],[0,31,60,91,121,152,182,213,244,274,305,335]];
function E(aa){if(aa%4){return 0;
}if(aa%100){return 1;
}if(aa%400){return 0;
}return 1;
}function z(aa){return E(aa)?366:365;
}function y(ab,aa){return E(ab)&&aa==1?29:x[aa];
}function X(aa){return F((aa|0)+n);
}function P(ac,ab,aa){return v(ac,ab,aa)-n;
}var L=60*1000;
var K=60*L;
var J=24*K;
function Y(af){var aa=af-(af|0);
if(aa<0){aa++;
}var ad=Math.round(J*aa);
var ab=Math.floor(ad/K);
ad-=ab*K;
var ac=Math.floor(ad/L);
ad-=ac*L;
var ae=Math.floor(ad/1000);
ad-=ae*1000;
return{hours:ab,minutes:ac,seconds:ae,milliseconds:ad};
}function U(ab){var aa=X(ab),ac=Y(ab);
return new Date(aa.year,aa.month,aa.date,ac.hours,ac.minutes,ac.seconds,ac.milliseconds);
}function Q(aa,ab,ad,ac){return(aa+ab/60+ad/3600+ac/3600000)/24;
}function w(aa){var ab=Q(aa.getHours(),aa.getMinutes(),aa.getSeconds(),aa.getMilliseconds());
aa=P(aa.getFullYear(),aa.getMonth(),aa.getDate());
if(aa<0){return aa-1+ab;
}else{return aa+ab;
}}function R(aa){return kendo.parseDate(aa,["MM/dd/yyyy","MM-dd-yyyy","MM/dd/yy","MM-dd-yy","MMMM dd yyyy","MMMM dd yy","MMM dd yyyy","MMM dd yy","dd MMMM yyyy","dd MMMM yy","dd MMM yyyy","dd MMM yy","MMMM dd, yyyy","MMMM dd, yy","MMM dd, yyyy","MMM dd, yy","MMMM dd","MMM dd","MMMM yyyy","MMM yyyy","dd MMMM","dd MMM","MM-dd","MM/dd"])||kendo.parseDate(aa);
}B.CalcError=q;
B.Formula=C;
B.Matrix=I;
B.packDate=P;
B.unpackDate=X;
B.packTime=Q;
B.unpackTime=Y;
B.serialToDate=U;
B.dateToSerial=w;
B.daysInMonth=y;
B.isLeapYear=E;
B.daysInYear=z;
B.parseDate=R;
V.dateToNumber=w;
V.numberToDate=U;
V.defineFunction=A;
V.CalcError=q;
B.defineFunction=A;
B.defineAlias=function(aa,ab){var ac=D[ab];
if(!ac){throw new Error("Function "+ab+" is not yet defined");
}if(!ac.kendoSpreadsheetAliases){ac.kendoSpreadsheetAliases=[ab];
}ac.kendoSpreadsheetAliases.push(aa);
D[aa]=ac;
};
B.FUNCS=D;
var N=["or","number",["null",0]];
var m=[["*a",N],["*b",N]];
var l=[["*a","anyvalue"],["*b","anyvalue"]];
A("binary+",function(aa,ab){return aa+ab;
}).args(m);
A("binary-",function(aa,ab){return aa-ab;
}).args(m);
A("binary*",function(aa,ab){return aa*ab;
}).args(m);
A("binary/",function(aa,ab){return aa/ab;
}).args([["*a",N],["*b","divisor"]]);
A("binary^",function(aa,ab){return Math.pow(aa,ab);
}).args(m);
A("binary&",function(aa,ab){if(aa==null){aa="";
}if(ab==null){ab="";
}return""+aa+ab;
}).args([["*a",["or","number","string","boolean","null"]],["*b",["or","number","string","boolean","null"]]]);
A("binary=",function(aa,ab){return aa===ab;
}).args(l);
A("binary<>",function(aa,ab){return aa!==ab;
}).args(l);
A("binary<",o(function(aa,ab){return aa<ab;
})).args(l);
A("binary<=",o(function(aa,ab){return aa<=ab;
})).args(l);
A("binary>",o(function(aa,ab){return aa>ab;
})).args(l);
A("binary>=",o(function(aa,ab){return aa>=ab;
})).args(l);
A("unary+",function(aa){return aa;
}).args([["*a",N]]);
A("unary-",function(aa){return -aa;
}).args([["*a",N]]);
A("unary%",function(aa){return aa/100;
}).args([["*a",N]]);
A("binary:",function(aa,ab){return new S(aa,ab).setSheet(aa.sheet||this.formula.sheet,aa.hasSheet());
}).args([["a","cell"],["b","cell"]]);
A("binary,",function(aa,ab){return new W([aa,ab]);
}).args([["a","ref"],["b","ref"]]);
A("binary ",function(aa,ab){return aa.intersect(ab);
}).args([["a","ref"],["b","ref"]]);
A("not",function(aa){return !this.bool(aa);
}).args([["*a","anyvalue"]]);
A("isblank",function(aa){if(aa instanceof r){aa=this.getRefData(aa);
return aa==null;
}return false;
}).args([["*value","anything!"]]);
A("iserror",function(aa){return aa instanceof q;
}).args([["*value","forced!"]]);
A("iserr",function(aa){return aa instanceof q&&aa.code!="N/A";
}).args([["*value","forced!"]]);
A("isna",function(aa){return aa instanceof q&&aa.code=="N/A";
}).args([["*value","forced!"]]);
A("islogical",function(aa){return typeof aa=="boolean";
}).args([["*value","forced!"]]);
A("isnontext",function(aa){return typeof aa!="string";
}).args([["*value","forced!"]]);
A("istext",function(aa){return typeof aa=="string";
}).args([["*value","forced!"]]);
A("isnumber",function(aa){return typeof aa=="number";
}).args([["*value","forced!"]]);
A("isref",function(aa){return aa instanceof r||aa instanceof S;
}).args([["*value","anything!"]]);
function o(aa){return function(ab,ac){if(typeof ab=="string"&&typeof ac!="string"){ac=ac==null?"":ac+"";
}if(typeof ab!="string"&&typeof ac=="string"){ab=ab==null?"":ab+"";
}if(typeof ab=="number"&&ac==null){ac=0;
}if(typeof ac=="number"&&ab==null){ab=0;
}if(typeof ab=="string"&&typeof ac=="string"){ab=ab.toLowerCase();
ac=ac.toLowerCase();
}if(typeof ac==typeof ab){return aa(ab,ac);
}else{return new q("VALUE");
}};
}},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/validation",["spreadsheet/runtime"],l);
}(function(){var k=kendo.jQuery;
if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var q=kendo.spreadsheet;
var p={};
q.validation=p;
var l=q.calc;
var m=kendo.Class;
var r="_matrix({0})";
var o='DATEVALUE("{0}")';
l.runtime.defineFunction("_matrix",function(t){return t;
}).args([["m","matrix"]]);
function n(y,x,t,z){var A;
var u;
var v;
var w;
if(typeof z==="string"){z=JSON.parse(z);
}if(z.from){if(z.dataType==="list"){z.from=kendo.format(r,z.from);
}if(z.dataType==="date"){v=l.runtime.parseDate(z.from);
if(v){z.from=kendo.format(o,z.from);
z.fromIsDateValue=true;
}}z.from=l.compile(l.parseFormula(y,x,t,z.from));
}if(z.to){if(z.dataType==="date"){w=l.runtime.parseDate(z.to);
if(w){z.to=kendo.format(o,z.to);
z.toIsDateValue=true;
}}z.to=l.compile(l.parseFormula(y,x,t,z.to));
}if(z.dataType=="custom"){u=p.validationComparers.custom;
}else{if(z.dataType=="list"){u=p.validationComparers.list;
}else{u=p.validationComparers[z.comparerType];
}}if(!u){throw kendo.format("'{0}' comparer is not implemented.",z.comparerType);
}A=function(D){var C=this.to&&this.to.value?this.to.value:j;
if(D===null||D===""){if(this.allowNulls){this.value=true;
}else{this.value=false;
}}else{if(this.dataType=="custom"){this.value=u(D,this.from.value,C);
}else{if(this.dataType=="list"){var B=this._getListData();
this.value=u(D,B,C);
}else{this.value=u(D,this.from.value,C);
}}}return this.value;
};
return new kendo.spreadsheet.validation.Validation(k.extend(z,{handler:A,sheet:y,row:x,col:t}));
}var s=m.extend({init:function s(t){this.handler=t.handler;
this.from=t.from;
this.to=t.to;
this.dataType=t.dataType;
this.comparerType=t.comparerType;
this.type=t.type?t.type:"warning";
this.allowNulls=t.allowNulls?true:false;
this.fromIsDateValue=t.fromIsDateValue?true:false;
this.toIsDateValue=t.toIsDateValue?true:false;
this.sheet=t.sheet;
this.row=t.row;
this.col=t.col;
if(t.tooltipMessageTemplate){this.tooltipMessageTemplate=t.tooltipMessageTemplate;
}if(t.tooltipTitleTemplate){this.tooltipTitleTemplate=t.tooltipTitleTemplate;
}if(t.messageTemplate){this.messageTemplate=t.messageTemplate;
}if(t.titleTemplate){this.titleTemplate=t.titleTemplate;
}},_formatMessages:function(v){var w=this.from?this.from.value:"";
var y=this.to?this.to.value:"";
var x=this.from?this.from.toString():"";
var z=this.to?this.to.toString():"";
var u=this.dataType;
var A=this.type;
var t=this.comparerType;
return kendo.format(v,w,y,x,z,u,A,t);
},_setMessages:function(){this.title="";
this.message="";
if(this.tooltipTitleTemplate){this.tooltipTitle=this._formatMessages(this.tooltipTitleTemplate);
}if(this.tooltipMessageTemplate){this.tooltipMessage=this._formatMessages(this.tooltipMessageTemplate);
}if(this.titleTemplate){this.title=this._formatMessages(this.titleTemplate);
}if(this.messageTemplate){this.message=this._formatMessages(this.messageTemplate);
}},_getListData:function(){if(!this.from.value||!this.from.value.data){return[];
}var u=this.from.value.data;
var w;
var x;
var v=[];
for(w=0;
w<u.length;
w++){var t=u[w];
if(t){for(x=0;
x<t.length;
x++){v.push(t[x]);
}}}return v;
},clone:function(w,v,t){var u=this._getOptions();
if(u.from){u.from=u.from.clone(w,v,t);
}if(u.to){u.to=u.to.clone(w,v,t);
}return new s(k.extend(u,{handler:this.handler},{sheet:w,row:v,col:t}));
},exec:function(y,w,v,u){var x=this;
var t=function(){x.value=x.handler.call(x,w,v);
x._setMessages();
if(u){u(x.value);
}};
if(x.to){x.to.exec(y,function(){x.from.exec(y,t);
});
}else{x.from.exec(y,t);
}},reset:function(){if(this.from){this.from.reset();
}if(this.to){this.to.reset();
}delete this.value;
},adjust:function(t,x,y,u){if(this.from){this.from.adjust(t,x,y,u);
}if(this.to){this.to.adjust(t,x,y,u);
}if(this.sheet.toLowerCase()==t.toLowerCase()){var w=this.row;
var v=this.col;
switch(x){case"row":if(w>=y){this.row+=u;
}break;
case"col":if(v>=y){this.col+=u;
}break;
}}},toJSON:function(){var t=this._getOptions();
if(t.from){t.from=t.from.toString();
if(t.dataType==="list"){t.from=t.from.replace(/^_matrix\((.*)\)$/i,"$1");
}if(t.dataType==="date"){if(this.fromIsDateValue){t.from=t.from.replace(/^DATEVALUE\("(.*)"\)$/i,"$1");
}}}if(t.to){t.to=t.to.toString();
if(t.dataType==="date"){if(this.toIsDateValue){t.to=t.to.replace(/^DATEVALUE\("(.*)"\)$/i,"$1");
}}}return t;
},_getOptions:function(){return{from:this.from,to:this.to,dataType:this.dataType,type:this.type,comparerType:this.comparerType,row:this.row,col:this.col,sheet:this.sheet,allowNulls:this.allowNulls,tooltipMessageTemplate:this.tooltipMessageTemplate,tooltipTitleTemplate:this.tooltipTitleTemplate,messageTemplate:this.messageTemplate,titleTemplate:this.titleTemplate};
}});
p.compile=n;
p.validationComparers={greaterThan:function(u,t){return u>t;
},lessThan:function(u,t){return u<t;
},between:function(v,t,u){return v>t&&v<u;
},equalTo:function(u,t){return u==t;
},notEqualTo:function(u,t){return u!=t;
},greaterThanOrEqualTo:function(u,t){return u>=t;
},lessThanOrEqualTo:function(u,t){return u<=t;
},notBetween:function(v,t,u){return v<t||v>u;
},custom:function(u,t){return t;
},list:function(u,t){return t.indexOf(u)>-1;
}};
p.Validation=s;
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/sheet",["kendo.core","kendo.color","spreadsheet/runtime","spreadsheet/validation","spreadsheet/references"],l);
}(function(){(function(l){if(l.support.browser.msie&&l.support.browser.version<9){return;
}var n=l.spreadsheet.RangeRef;
var k=l.spreadsheet.CellRef;
var m=l.spreadsheet.Range;
var o=l.Class.extend({init:function(q){this._sheet=q;
this.selection=l.spreadsheet.FIRSTREF.toRangeRef();
this.originalSelection=l.spreadsheet.FIRSTREF.toRangeRef();
this._activeCell=l.spreadsheet.FIRSTREF.toRangeRef();
this.originalActiveCell=l.spreadsheet.FIRSTREF;
},currentSelectionRange:function(){return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();
},currentOriginalNavigationRange:function(){return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();
},currentNavigationRange:function(){if(this.singleCellSelection()){return this._sheet._sheetRef;
}else{return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();
}},nextNavigationRange:function(){if(!this.singleCellSelection()){this.selectionRangeIndex=this.selection.nextRangeIndex(this.selectionRangeIndex);
}return this.currentNavigationRange();
},previousNavigationRange:function(){if(!this.singleCellSelection()){this.selectionRangeIndex=this.selection.previousRangeIndex(this.selectionRangeIndex);
}return this.currentNavigationRange();
},activeCell:function(q){if(q){this.originalActiveCell=q;
this._activeCell=this._sheet.unionWithMerged(q.toRangeRef());
this._sheet.focus(q);
this._sheet.triggerChange({activeCell:true,selection:true});
}return this._activeCell;
},select:function(s,r,q){if(s){if(s.eq(this.originalSelection)){return;
}this.originalSelection=s;
this.selection=r;
if(q!==false){if(s.isCell()){this.activeCell(s);
}else{this.activeCell(this.selection.lastRange().first());
}this.selectionRangeIndex=this.selection.size()-1;
}else{this._sheet.triggerChange({selection:true});
}}return this.selection;
},singleCellSelection:function(){return this._activeCell.eq(this.selection);
}});
var p=l.Observable.extend({init:function(v,r,w,s,t,u){l.Observable.prototype.init.call(this);
var q=v*r-1;
this._rows=new l.spreadsheet.Axis(v,w);
this._columns=new l.spreadsheet.Axis(r,s);
this._mergedCells=[];
this._frozenRows=0;
this._frozenColumns=0;
this._suspendChanges=false;
this._filter=null;
this._grid=new l.spreadsheet.Grid(this._rows,this._columns,v,r,t,u);
this._sheetRef=this._grid.normalize(l.spreadsheet.SHEETREF);
this._properties=new l.spreadsheet.PropertyBag(q);
this._sorter=new l.spreadsheet.Sorter(this._grid,this._properties.sortable());
this._viewSelection=new o(this);
this._editSelection=new o(this);
this._formulaSelections=[];
this.options={showGridLines:true};
},_selectionState:function(){return this._inEdit?this._editSelection:this._viewSelection;
},navigator:function(){if(!this._navigator){this._navigator=new l.spreadsheet.SheetNavigator(this);
}return this._navigator;
},axisManager:function(){if(!this._axisManager){this._axisManager=new l.spreadsheet.AxisManager(this);
}return this._axisManager;
},_name:function(q){if(!q){return this._sheetName;
}this._sheetName=q;
return this;
},name:function(){return this._name();
},_property:function(q,s,r){if(s===j){return q();
}else{q(s);
return this.triggerChange(r);
}},_field:function(q,s,r){if(s===j){return this[q];
}else{this[q]=s;
return this.triggerChange(r);
}},suspendChanges:function(q){if(q===j){return this._suspendChanges;
}this._suspendChanges=q;
return this;
},triggerChange:function(q){if(!this._suspendChanges){this.trigger("change",q);
}return this;
},setDataSource:function(r,q){if(this.dataSourceBinder){this.dataSourceBinder.destroy();
}this.dataSourceBinder=new l.spreadsheet.SheetDataSourceBinder({dataSource:r,sheet:this,columns:q});
},hideColumn:function(q){return this._property(this._columns.hide.bind(this._columns),q,{layout:true});
},unhideColumn:function(q){return this._property(this._columns.unhide.bind(this._columns),q,{layout:true});
},isHiddenColumn:function(q){return this._grid._columns.hidden(q);
},_copyRange:function(w,y){var q=this._grid;
var v=q.rowCount;
var u=q.normalize(w.topLeft);
var t=q.normalize(w.bottomRight);
var s=u.col*v+u.row;
var r=t.col*v+t.row;
var x=y.col*v+y.row;
this._properties.copy(s,r,x);
},_adjustReferences:function(t,v,r,s){this._mergedCells=s.reduce(function(w,x){x=x.adjust(null,null,null,null,t=="row",v,r);
if(x!==l.spreadsheet.NULLREF){w.push(x);
}return w;
},[]);
if(this._workbook){var q=this._name();
this._workbook._sheets.forEach(function(w){w._forFormulas(function(x){x.adjust(q,t,v,r);
});
w._forValidations(function(x){x.adjust(q,t,v,r);
});
});
this._workbook.adjustNames(q,t=="row",v,r);
}var u=this.select();
u=u.adjust(null,null,null,null,t=="row",v,r);
if(u!==l.spreadsheet.NULLREF){this.select(u);
}},_forFormulas:function(q){var t=this._properties;
var r=t.get("formula").values();
var s=r.length;
r.forEach(function(u,v){q.call(this,u.value,v,s);
},this);
},_forValidations:function(q){var r=this._properties;
r.get("validation").values().forEach(function(s){q.call(this,s.value);
},this);
},canInsertRow:function(t,q){q=q||1;
var r=this._grid;
var s=this.range(r.rowCount-q,0,q,r.columnCount);
return !s.hasValue();
},insertRow:function(q){if(!this.canInsertRow(q)){throw new Error("Shifting nonblank cells off the worksheet is not supported!");
}this.batch(function(){var v=this._grid;
var t=v.columnCount;
var z=v.rowCount;
var u=this.frozenRows();
if(q<u){this.frozenRows(u+1);
}var w=this._mergedCells.slice();
for(var s=0;
s<t;
s++){var y=new n(new k(q,s),new k(q,s));
var A=v.normalize(y.topLeft);
var r=v.normalize(y.bottomRight);
var x=new n(new k(A.row,A.col),new k(z-2,r.col));
this._copyRange(x,new k(A.row+1,A.col));
new m(y,this).clear();
}this._adjustReferences("row",q,1,w);
},{recalc:true,layout:true});
this.trigger("insertRow",{index:q});
return this;
},isEnabledRow:function(r){var q=new n(new k(r,0),new k(r,this._grid.columnCount));
return new m(q,this).enable();
},deleteRow:function(q){if(!this.isEnabledRow(q)){return this;
}this.batch(function(){var v=this._grid;
var t=v.columnCount;
var u=this.frozenRows();
if(q<u){this.frozenRows(u-1);
}var w=this._mergedCells.slice();
for(var s=0;
s<t;
s++){var z=new n(new k(q,s),new k(q,s));
new m(z,this).clear();
var A=v.normalize(z.topLeft);
var r=v.normalize(z.bottomRight);
var x=new n(new k(A.row+1,A.col),new k(Infinity,r.col));
this._copyRange(x,A);
var y=v.normalize(x.bottomRight);
new m(new n(y,y),this).clear();
}this._adjustReferences("row",q,-1,w);
},{recalc:true,layout:true});
this.trigger("deleteRow",{index:q});
return this;
},insertColumn:function(q){this.batch(function(){var v=this._grid;
var t=v.columnCount;
var u=this.frozenColumns();
if(q<u){this.frozenColumns(u+1);
}var w=this._mergedCells.slice();
for(var s=t;
s>=q;
s--){var y=new n(new k(0,s),new k(Infinity,s));
new m(y,this).clear();
if(s==q){break;
}var z=v.normalize(y.topLeft);
var r=v.normalize(y.bottomRight);
var x=new n(new k(z.row,z.col-1),new k(r.row,r.col-1));
this._copyRange(x,z);
}this._adjustReferences("col",q,1,w);
},{recalc:true,layout:true});
return this;
},isEnabledColumn:function(q){var r=new n(new k(0,q),new k(Infinity,q));
return new m(r,this).enable();
},deleteColumn:function(q){if(!this.isEnabledColumn(q)){return this;
}this.batch(function(){var v=this._grid;
var t=v.columnCount;
var u=this.frozenColumns();
if(q<u){this.frozenColumns(u-1);
}var w=this._mergedCells.slice();
for(var s=q;
s<t;
s++){var y=new n(new k(0,s),new k(Infinity,s));
new m(y,this).clear();
if(s==t-1){break;
}var z=v.normalize(y.topLeft);
var r=v.normalize(y.bottomRight);
var x=new n(new k(z.row,z.col+1),new k(r.row,r.col+1));
this._copyRange(x,z);
}this._adjustReferences("col",q,-1,w);
},{recalc:true,layout:true});
return this;
},hideRow:function(q){return this._property(this._rows.hide.bind(this._rows),q,{layout:true});
},unhideRow:function(q){return this._property(this._rows.unhide.bind(this._rows),q,{layout:true});
},isHiddenRow:function(q){return this._grid._rows.hidden(q);
},columnWidth:function(q,r){return this._property(this._columns.value.bind(this._columns,q,q),r,{layout:true});
},rowHeight:function(r,q){return this._property(this._rows.value.bind(this._rows,r,r),q,{layout:true});
},frozenRows:function(q){return this._field("_frozenRows",q,{layout:true});
},frozenColumns:function(q){return this._field("_frozenColumns",q,{layout:true});
},_ref:function(u,q,s,r){var t=null;
if(u instanceof l.spreadsheet.Ref){return u;
}if(u instanceof l.spreadsheet.Range){return u._ref.toRangeRef();
}if(typeof u==="string"){t=l.spreadsheet.calc.parseReference(u);
}else{if(!s){s=1;
}if(!r){r=1;
}t=new n(new k(u,q),new k(u+s-1,q+r-1));
}return t;
},range:function(t,q,s,r){return new m(this._ref(t,q,s,r),this);
},forEachMergedCell:function(r,q){var s=false;
if(typeof q==="undefined"){q=r;
s=true;
}this._mergedCells.forEach(function(t){if(s||t.intersects(r)){q(t);
}});
},forEachFilterHeader:function(r,q){var t=false;
if(typeof q==="undefined"){q=r;
t=true;
}if(this._filter){var s=[];
this._filter.ref.forEachColumn(function(v){if(t||v.intersects(r)){s.push(v.topLeft);
}});
this._mergedCells.forEach(function(v){s=s.map(function(w){if(v.intersects(w)){return v;
}return w;
});
});
s.reduce(function u(w,v){if(w.indexOf(v)<0){w.push(v);
}return w;
},[]).forEach(q);
}},forEach:function(u,r){if(!(u instanceof n)){u=this._ref(u);
}var x=this._grid.normalize(u.topLeft);
var q=this._grid.normalize(u.bottomRight);
for(var s=x.col;
s<=q.col;
s++){var v=x.row;
var w=this._grid.index(v,s);
var t=this._grid.index(q.row,s);
this._properties.forEach(w,t,function(y){r(v++,s,y);
});
}},startResizing:function(q){this._initialPosition=q;
this._resizeInProgress=true;
},startAutoFill:function(){this._autoFillInProgress=true;
var q=this.select();
this._autoFillOrigin=q;
this._autoFillDest=q;
this.triggerChange({selection:true});
},updateAutoFill:function(q,t,s,r){this._autoFillDest=q;
this._autoFillPunch=t;
this._autoFillHint=s;
this._autoFillDirection=r;
this.triggerChange({selection:true});
},autoFillRef:function(){return this._autoFillDest;
},autoFillPunch:function(){return this._autoFillPunch;
},autoFillInProgress:function(){return this._autoFillInProgress;
},resizingInProgress:function(){return this._resizeInProgress;
},completeResizing:function(){if(this._resizeInProgress){this._resizeInProgress=false;
var r=this.resizeHintPosition();
if(this._initialPosition&&r){var q=this.resizeHandlePosition();
if(q.col!==-Infinity){this.columnWidth(q.col,this.columnWidth(q.col)-(this._initialPosition.x-r.x));
}else{this.rowHeight(q.row,this.rowHeight(q.row)-(this._initialPosition.y-r.y));
}}else{this.trigger("change",{resize:true});
}}},resizeHandlePosition:function(){return this._resizeHandlePosition;
},resizeHintPosition:function(q){if(q!==j){this._resizeHintPosition=q;
this.trigger("change",{resize:true});
}return this._resizeHintPosition;
},removeResizeHandle:function(){if(this._resizeHandlePosition){this._resizeHintPosition=j;
this._resizeHandlePosition=j;
this._initialPosition=j;
this.trigger("change",{resize:true});
}},positionResizeHandle:function(q){this._resizeHandlePosition=q;
this.trigger("change",{resize:true});
},startSelection:function(){this._selectionInProgress=true;
},completeSelection:function(){if(this._selectionInProgress){this._selectionInProgress=false;
this._resizeHintPosition=j;
this.trigger("change",{selection:true});
}if(this._autoFillInProgress){this._autoFillInProgress=false;
var q=this._autoFillDest;
var r=this._autoFillOrigin;
if(this._autoFillPunch){this._workbook.execute({command:"ClearContentCommand",options:{operatingRange:this.range(this._autoFillPunch)}});
}else{if(!q.eq(r)){this._workbook.execute({command:"AutoFillCommand",options:{operatingRange:this.range(q),origin:this.range(r)}});
}else{this.triggerChange({selection:true});
}}this._autoFillDest=null;
this._autoFillPunch=null;
this._autoFillOrigin=null;
this.select(q);
}},selectionInProgress:function(){return this._selectionInProgress;
},select:function(s,q){var t=this._selectionState();
var r;
if(s){s=this._ref(s);
r=this._grid.isAxis(s)?s:this.unionWithMerged(s);
}return t.select(s,r,q);
},originalSelect:function(){return this._selectionState().originalSelection;
},currentSelectionRange:function(){return this._selectionState().currentSelectionRange();
},currentOriginalSelectionRange:function(){return this._selectionState().currentOriginalNavigationRange();
},currentNavigationRange:function(){return this._selectionState().currentNavigationRange();
},nextNavigationRange:function(){return this._selectionState().nextNavigationRange();
},previousNavigationRange:function(){return this._selectionState().previousNavigationRange();
},selectionRangeIndex:function(){return this._selectionState().selectionRangeIndex;
},activeCell:function(q){return this._selectionState().activeCell(q);
},originalActiveCell:function(){return this._selectionState().originalActiveCell;
},singleCellSelection:function(){return this._selectionState().singleCellSelection();
},unionWithMerged:function(r){var q=this._mergedCells;
return r.map(function(s){return s.toRangeRef().union(q);
});
},trim:function(r){var s=[];
var q=this._grid;
this._properties.forEachProperty(function(t){s.push(q.trim(r,t.list));
});
return this.unionWithMerged(r.topLeft.toRangeRef().union(s));
},focus:function(r){if(r){this._focus=r.toRangeRef();
}else{var q=this._focus;
this._focus=null;
return q;
}},activeCellSelection:function(){return new m(this._grid.normalize(this.activeCell()),this);
},selection:function(){return new m(this._grid.normalize(this._selectionState().selection),this);
},selectedHeaders:function(){var u=this.select();
var t={};
var s={};
var q=false;
var r=false;
u.forEach(function(z){var y;
var B="partial";
var x="partial";
z=z.toRangeRef();
var v=z.bottomRight;
var A=v.col===Infinity;
var w=v.row===Infinity;
if(w){r=true;
x="full";
}if(A){q=true;
B="full";
}if(!w){for(y=z.topLeft.row;
y<=v.row;
y++){if(t[y]!=="full"){t[y]=B;
}}}if(!A){for(y=z.topLeft.col;
y<=v.col;
y++){if(s[y]!=="full"){s[y]=x;
}}}});
return{rows:t,cols:s,allRows:r,allCols:q,all:r&&q};
},isInEditMode:function(q){if(q===j){return this._inEdit;
}this._inEdit=q;
if(q){this._editSelection.selection=this._viewSelection.selection.clone();
this._editSelection.originalSelection=this._viewSelection.originalSelection.clone();
this._editSelection._activeCell=this._viewSelection._activeCell.clone();
this._editSelection.originalActiveCell=this._viewSelection.originalActiveCell.clone();
}},_setFormulaSelections:function(q){this._formulaSelections=(q||[]).slice();
this.triggerChange({selection:true});
},_viewActiveCell:function(){return this._viewSelection._activeCell.toRangeRef();
},toJSON:function(){var s={};
var t=this._rows.toJSON("height",s);
var q=this._columns.toJSON("width",{});
var u=this._viewSelection;
this.forEach(l.spreadsheet.SHEETREF,function(y,w,v){if(Object.keys(v).length===0){return;
}var x=s[y];
if(x===j){x=t.length;
t.push({index:y});
s[y]=x;
}y=t[x];
v.index=w;
if(y.cells===j){y.cells=[];
}if(v.formula){v.formula=v.formula.toString();
}if(v.validation){v.validation=v.validation.toJSON();
}if(v.color){v.color=l.parseColor(v.color).toCss();
}if(v.background){v.background=l.parseColor(v.background).toCss();
}if(v.borderTop&&v.borderTop.color){v.borderTop.color=l.parseColor(v.borderTop.color).toCss();
}if(v.borderBottom&&v.borderBottom.color){v.borderBottom.color=l.parseColor(v.borderBottom.color).toCss();
}if(v.borderRight&&v.borderRight.color){v.borderRight.color=l.parseColor(v.borderRight.color).toCss();
}if(v.borderLeft&&v.borderLeft.color){v.borderLeft.color=l.parseColor(v.borderLeft.color).toCss();
}y.cells.push(v);
});
var r={name:this._name(),rows:t,columns:q,selection:u.selection.toString(),activeCell:u.activeCell().toString(),frozenRows:this.frozenRows(),frozenColumns:this.frozenColumns(),mergedCells:this._mergedCells.map(function(v){return v.toString();
})};
if(this._sort){r.sort={ref:this._sort.ref.toString(),columns:this._sort.columns.map(function(v){return{index:v.index,ascending:v.ascending};
})};
}if(this._filter){r.filter={ref:this._filter.ref.toString(),columns:this._filter.columns.map(function(v){var w=v.filter.toJSON();
w.index=v.index;
return w;
})};
}return r;
},fromJSON:function(q){this.batch(function(){if(q.name!==j){this._name(q.name);
}if(q.frozenColumns!==j){this.frozenColumns(q.frozenColumns);
}if(q.frozenRows!==j){this.frozenRows(q.frozenRows);
}if(q.columns!==j){this._columns.fromJSON("width",q.columns);
}if(q.rows!==j){this._rows.fromJSON("height",q.rows);
for(var x=0;
x<q.rows.length;
x++){var y=q.rows[x];
var z=y.index;
if(z===j){z=x;
}if(y.cells){for(var t=0;
t<y.cells.length;
t++){var s=y.cells[t];
var u=s.index;
if(u===j){u=t;
}if(s.formula){s.formula=this._compileFormula(z,u,s.formula);
}if(s.validation){s.validation=this._compileValidation(z,u,s.validation);
}this._properties.fromJSON(this._grid.index(z,u),s);
}}}}if(q.selection){this._viewSelection.selection=this._viewSelection.originalSelection=this._ref(q.selection);
}if(q.activeCell){var r=this._ref(q.activeCell);
this._viewSelection._activeCell=r.toRangeRef();
this._viewSelection.originalActiveCell=r;
}if(q.mergedCells){q.mergedCells.forEach(function(A){this.range(A).merge();
},this);
}if(q.sort){this._sort={ref:this._ref(q.sort.ref),columns:q.sort.columns.slice(0)};
}if(q.filter){var w=q.filter.ref;
var v=q.filter.columns===j?[]:q.filter.columns;
if(!w){l.logToConsole("Dropping filter for sheet '"+q.name+"' due to missing ref");
}else{this._filter={ref:this._ref(w),columns:v.map(function(A){return{index:A.index,filter:l.spreadsheet.Filter.create(A)};
})};
this._refreshFilter();
}}});
},formula:function(q){return this._properties.get("formula",this._grid.cellRefIndex(q));
},validation:function(q){return this._properties.get("validation",this._grid.cellRefIndex(q));
},resetFormulas:function(){this._forFormulas(function(q){q.reset();
});
},resetValidations:function(){this._forValidations(function(q){q.reset();
});
},recalc:function(r,q){var t=this._properties.get("formula").values();
var s=t.length,w=0,u=0;
if(!s&&q){return q();
}function v(){w--;
if(u==s&&!w){q();
}}while(u<s){w++;
t[u++].value.exec(r,q?v:null);
}},revalidate:function(q){var r=this;
this._forValidations(function(u){var s=new k(u.row,u.col);
var t=new n(s,s);
u.exec(q,r._get(t,"value"),r._get(t,"format"));
});
},_value:function(s,q,t){var r=this._grid.index(s,q);
if(t!==j){this._properties.set("value",r,r,t);
}else{return this._properties.get("value",r);
}},_validation:function(s,q){var r=this._grid.index(s,q);
return this._properties.get("validation",r);
},_compileValidation:function(r,q,s){if(s.from!==null||s.from!==j){s.from=(s.from+"").replace(/^=/,"");
}if(s.to!==null||s.to!==j){s.to=(s.to+"").replace(/^=/,"");
}return l.spreadsheet.validation.compile(this._name(),r,q,s);
},_compileFormula:function(s,q,r){r=r.replace(/^=/,"");
r=l.spreadsheet.calc.parseFormula(this._name(),s,q,r);
return l.spreadsheet.calc.compile(r);
},_copyValuesInRange:function(x,q,y,u){var r,w,s;
for(r=x.col;
r<=q.col;
r++){w=this._grid.index(x.row,r);
s=this._grid.index(q.row,r);
for(var t=w,v=x.row;
t<=s;
++t,++v){y=y.clone(this._name(),v,r);
this._properties.set(u,t,t,y);
}}return y;
},_set:function(u,t,x){var w=this._grid.normalize(u.topLeft);
var q=this._grid.normalize(u.bottomRight);
var r,v,s;
if(x&&t=="formula"){if(typeof x=="string"){x=this._compileFormula(w.row,w.col,x);
}x=this._copyValuesInRange(w,q,x,"formula");
}else{if(x&&t=="validation"){x=this._compileValidation(w.row,w.col,x);
x=this._copyValuesInRange(w,q,x,"validation");
}else{for(r=w.col;
r<=q.col;
r++){v=this._grid.index(w.row,r);
s=this._grid.index(q.row,r);
this._properties.set(t,v,s,x);
if(t=="formula"){this._properties.set("value",v,s,null);
}}}}},_get:function(s,r){var t=this._grid.normalize(s.topLeft);
var q=this._grid.index(t.row,t.col);
return this._properties.get(r,q);
},batch:function(q,r){var s=this.suspendChanges();
this.suspendChanges(true);
q.call(this);
return this.suspendChanges(s).triggerChange(r);
},_sortBy:function(s,q){var r=null;
q.forEach(function(t){r=this._sorter.sortBy(s,t.index,this._properties.get("value"),t.ascending,r);
},this);
this._sort={ref:s,columns:q};
this._refreshFilter();
this.triggerChange({recalc:true});
},_refreshFilter:function(){if(this._filter){this._filterBy(this._filter.ref,this._filter.columns);
}},_filterBy:function(r,q){this.batch(function(){for(var s=r.topLeft.row;
s<=r.bottomRight.row;
s++){if(this._rows.hidden(s)){this._rows.unhide(s);
}}q.forEach(function(w){var x=r.resize({top:1}).toColumn(w.index);
var u=[];
if(x===l.spreadsheet.NULLREF){return;
}this.forEach(x,function(B,A,z){z.row=B;
u.push(z);
});
w.filter.prepare(u);
for(var v=0;
v<u.length;
v++){var t=u[v];
var y=w.filter.value(t);
if(w.filter.matches(y)===false){this.hideRow(t.row);
}}},this);
this._filter={ref:r,columns:q};
},{layout:true,filter:true});
},filterColumn:function(r){var q=this.filter().ref;
return r.toRangeRef().topLeft.col-q.topLeft.col;
},filter:function(){return this._filter;
},clearFilter:function(q){this._clearFilter(q instanceof Array?q:[q]);
},_clearFilter:function(q){if(this._filter){this.batch(function(){this._filter.columns=this._filter.columns.filter(function(r){return q.indexOf(r.index)<0;
});
this._refreshFilter();
},{layout:true,filter:true});
}},getAxisState:function(){return{rows:this._rows.getState(),columns:this._columns.getState()};
},setAxisState:function(q){this._rows.setState(q.rows);
this._columns.setState(q.columns);
this.triggerChange({layout:true});
},getState:function(){return{rows:this._rows.getState(),columns:this._columns.getState(),mergedCells:this._mergedCells.map(function(q){return q.clone();
}),properties:this._properties.getState()};
},setState:function(q){this._rows.setState(q.rows);
this._columns.setState(q.columns);
this._mergedCells=q.mergedCells;
this._properties.setState(q.properties);
this.triggerChange(l.spreadsheet.ALL_REASONS);
},_merge:function(s){var q=this._mergedCells;
var t=this;
var r;
this.batch(function(){r=s.map(function(A){if(A instanceof l.spreadsheet.CellRef){return A;
}var w=A.toRangeRef().union(q,function(D){q.splice(q.indexOf(D),1);
});
var z=new m(w,t);
var y=z._get("formula");
var C=z.value();
var x=z.format();
var v=z.background();
z.value(null);
z.format(null);
z.background(null);
var B=new m(w.collapse(),t);
if(y){B._set("formula",y);
}else{B.value(C);
}B.format(x);
B.background(v);
q.push(w);
return w;
});
var u=t._viewSelection;
u.selection=t.unionWithMerged(u.originalSelection);
u._activeCell=t.unionWithMerged(u.originalActiveCell);
},{activeCell:true,selection:true});
return r;
}});
l.spreadsheet.Sheet=p;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/sheetsbar",["kendo.core","kendo.sortable"],l);
}(function(){(function(n){if(n.support.browser.msie&&n.support.browser.version<9){return;
}var k=n.jQuery;
var l=".";
var m=" ";
var p={sheetsBarWrapper:"k-widget k-header",sheetsBarSheetsWrapper:"k-tabstrip k-floatwrap k-tabstrip-bottom",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",sheetsBarAdd:"k-spreadsheet-sheets-bar-add",sheetsBarRemove:"k-spreadsheet-sheets-remove",sheetsBarItems:"k-spreadsheet-sheets-items",sheetsBarEditor:"k-spreadsheet-sheets-editor",sheetsBarScrollable:"k-tabstrip-scrollable",sheetsBarNext:"k-tabstrip-next",sheetsBarPrev:"k-tabstrip-prev",sheetsBarKItem:"k-item k-state-default",sheetsBarKActive:"k-state-active k-state-tab-on-top",sheetsBarKTextbox:"k-textbox",sheetsBarKLink:"k-link",sheetsBarKIcon:"k-icon",sheetsBarKFontIcon:"k-font-icon",sheetsBarKButton:"k-button k-button-icon",sheetsBarKButtonBare:"k-button-bare",sheetsBarKArrowW:"k-i-arrow-w",sheetsBarKArrowE:"k-i-arrow-e",sheetsBarKReset:"k-reset k-tabstrip-items",sheetsBarKIconX:"k-i-x",sheetsBarKSprite:"k-sprite",sheetsBarKIconPlus:"k-i-plus",sheetsBarHintWrapper:"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint",sheetsBarKResetItems:"k-reset k-tabstrip-items"};
var o=n.ui.Widget.extend({init:function(r,s){var q=o.classNames;
n.ui.Widget.call(this,r,s);
r=this.element;
r.addClass(q.sheetsBarWrapper);
this._tree=new n.dom.Tree(r[0]);
this._tree.render([this._addButton(),this._createSheetsWrapper([])]);
this._toggleScrollEvents(true);
this._createSortable();
this._sortable.bind("start",this._onSheetReorderStart.bind(this));
this._sortable.bind("end",this._onSheetReorderEnd.bind(this));
r.on("click",l+q.sheetsBarRemove,this._onSheetRemove.bind(this));
r.on("click","li",this._onSheetSelect.bind(this));
r.on("dblclick","li"+l+q.sheetsBarActive,this._createEditor.bind(this));
r.on("click",l+q.sheetsBarAdd,this._onAddSelect.bind(this));
},options:{name:"SheetsBar",scrollable:{distance:200}},events:["select","reorder","rename"],_createEditor:function(){if(this._editor){return;
}this._renderSheets(this._sheets,this._selectedIndex,true);
this._editor=this.element.find(n.format("input{0}{1}",l,o.classNames.sheetsBarEditor)).focus().on("keydown",this._onEditorKeydown.bind(this)).on("blur",this._onEditorBlur.bind(this));
},_destroyEditor:function(){this._editor.off();
this._editor=null;
this._renderSheets(this._sheets,this._selectedIndex,false);
},renderSheets:function(r,q){if(!r||q<0){return;
}this._renderSheets(r,q,false);
},_renderSheets:function(A,z,u){var E=this;
var F;
var C;
var s=o.classNames;
E._isRtl=n.support.isRtl(E.element);
E._sheets=A;
E._selectedIndex=z;
E._renderHtml(u,true);
if(!E._scrollableAllowed()){return;
}var D=E._sheetsWrapper();
var x=D.children(l+s.sheetsBarPrev);
var v=D.children(l+s.sheetsBarNext);
var t=2;
var q=E.element.find(l+s.sheetsBarAdd);
var r=q.outerWidth()+q.position().left+t;
var y=x.outerWidth()+t;
var B=E._sheetsGroup();
x.css({left:r});
D.addClass(s.sheetsBarScrollable+m+s.sheetsBarSheetsWrapper);
B.css({marginLeft:r});
F=D[0].offsetWidth;
C=B[0].scrollWidth;
if(C+r>F){var w=Math.ceil(n.parseFloat(v.css("right")));
if(!E._scrollableModeActive){E._nowScrollingSheets=false;
E._scrollableModeActive=true;
}B.css({marginLeft:y+r,marginRight:v.outerWidth()+w+t});
}else{if(E._scrollableModeActive&&C<=F){E._scrollableModeActive=false;
B.css({marginLeft:r,marginRight:""});
}else{B.css({marginLeft:r});
}}E._toggleScrollButtons();
},_toggleScrollButtons:function(u){var t=this;
var v=t._sheetsGroup();
var w=t._sheetsWrapper();
var s=v.scrollLeft();
var r=w.find(l+o.classNames.sheetsBarPrev);
var q=w.find(l+o.classNames.sheetsBarNext);
if(u===false){r.toggle(false);
q.toggle(false);
}else{r.toggle(t._isRtl?s<v[0].scrollWidth-v[0].offsetWidth-1:s!==0);
q.toggle(t._isRtl?s!==0:s<v[0].scrollWidth-v[0].offsetWidth-1);
}},_toggleScrollEvents:function(w){var v=this;
var q=o.classNames;
var r=v.options;
var t;
var s;
var u=v._sheetsWrapper();
t=u.children(l+q.sheetsBarPrev);
s=u.children(l+q.sheetsBarNext);
if(w){t.on("mousedown",function(){v._nowScrollingSheets=true;
v._scrollSheetsByDelta(r.scrollable.distance*(v._isRtl?1:-1));
});
s.on("mousedown",function(){v._nowScrollingSheets=true;
v._scrollSheetsByDelta(r.scrollable.distance*(v._isRtl?-1:1));
});
t.add(s).on("mouseup",function(){v._nowScrollingSheets=false;
});
}else{t.off();
s.off();
}},_renderHtml:function(x,z){var w;
var C=[];
var t=n.dom;
var u=t.element;
var D=this._sheets;
var A=this._selectedIndex;
var r=o.classNames;
for(w=0;
w<D.length;
w++){var B=D[w];
var y=w===A;
var q={className:r.sheetsBarKItem+m};
var v=[];
if(y){q.className+=r.sheetsBarKActive+m+r.sheetsBarActive;
}else{q.className+=r.sheetsBarInactive;
}if(y&&x){v.push(u("input",{type:"text",value:B.name(),className:r.sheetsBarKTextbox+m+r.sheetsBarEditor,maxlength:50},[]));
}else{v.push(u("span",{className:r.sheetsBarKLink,title:B.name()},[t.text(B.name())]));
var s=u("span",{className:r.sheetsBarKIcon+m+r.sheetsBarKFontIcon+m+r.sheetsBarKIconX},[]);
v.push(u("span",{className:r.sheetsBarKLink+m+r.sheetsBarRemove},[s]));
}C.push(u("li",q,v));
}this._tree.render([this._addButton(),this._createSheetsWrapper(C,z)]);
},_createSheetsWrapper:function(v,u){var t=n.dom.element;
var s=o.classNames;
var r=[t("ul",{className:s.sheetsBarKReset},v)];
u=true;
if(u){var q=s.sheetsBarKButton+m+s.sheetsBarKButtonBare+m;
r.push(t("span",{className:q+s.sheetsBarPrev},[t("span",{className:s.sheetsBarKIcon+m+s.sheetsBarKArrowW},[])]));
r.push(t("span",{className:q+s.sheetsBarNext},[t("span",{className:s.sheetsBarKIcon+m+s.sheetsBarKArrowE},[])]));
}return t("div",{className:s.sheetsBarItems},r);
},_createSortable:function(){var q=o.classNames;
this._sortable=new n.ui.Sortable(this.element,{filter:n.format("ul li.{0},ul li.{1}",q.sheetsBarActive,q.sheetsBarInactive),container:l+q.sheetsBarItems,axis:"x",animation:false,ignore:"input",end:function(){if(this.draggable.hint){this.draggable.hint.remove();
}},hint:function(r){var s=k(r).clone();
return s.wrap("<div class='"+q.sheetsBarHintWrapper+"'><ul class='"+q.sheetsBarKResetItems+"'></ul></div>").closest("div");
}});
},_onEditorKeydown:function(q){if(this._editor){if(q.which===13){this._destroyEditor();
this._onSheetRename(k(q.target).val());
}if(q.which===27){this._destroyEditor();
this._onSheetRename();
}}},_onEditorBlur:function(q){if(this._editor){this._destroyEditor();
this._onSheetRename(k(q.target).val());
}},_onSheetReorderEnd:function(q){q.preventDefault();
this.trigger("reorder",{oldIndex:q.oldIndex,newIndex:q.newIndex});
},_onSheetReorderStart:function(q){if(this._editor){q.preventDefault();
}},_onSheetRemove:function(q){var r=k(q.target).closest("li").text();
if(this._editor){this._destroyEditor();
this._onSheetRename(this._editor.val());
}this.trigger("remove",{name:r});
},_onSheetSelect:function(q){var s=k(q.target).text();
if(k(q.target).is(l+o.classNames.sheetsBarEditor)||!s){q.preventDefault();
return;
}if(this._editor){var r=this._editor.val();
this._destroyEditor();
this._onSheetRename(r);
}this._scrollSheetsToItem(k(q.target).closest("li"));
this.trigger("select",{name:s,isAddButton:false});
},_onSheetRename:function(q){this.trigger("rename",{name:q,sheetIndex:this._selectedIndex});
},_onAddSelect:function(){this.trigger("select",{isAddButton:true});
},_addButton:function(){var r=n.dom.element;
var q=o.classNames;
return r("a",{className:q.sheetsBarAdd+m+q.sheetsBarKButton},[r("span",{className:q.sheetsBarKSprite+m+q.sheetsBarKIcon+m+q.sheetsBarKFontIcon+m+q.sheetsBarKIconPlus},[])]);
},destroy:function(){this._sortable.destroy();
},_scrollableAllowed:function(){var q=this.options;
return q.scrollable&&!isNaN(q.scrollable.distance);
},_scrollSheetsToItem:function(r){var y=this;
if(!y._scrollableModeActive){return;
}var v=y._sheetsGroup();
var q=v.scrollLeft();
var u=r.outerWidth();
var s=y._isRtl?r.position().left:r.position().left-v.children().first().position().left;
var x=v[0].offsetWidth;
var w=Math.ceil(parseFloat(v.css("padding-left")));
var t;
if(y._isRtl){if(s<0){t=q+s-(x-q)-w;
}else{if(s+u>x){t=q+s-u+w*2;
}}}else{if(q+x<s+u){t=s+u-x+w*2;
}else{if(q>s){t=s-w;
}}}v.finish().animate({scrollLeft:t},"fast","linear",function(){y._toggleScrollButtons();
});
},_sheetsGroup:function(){return this._sheetsWrapper().children("ul");
},_sheetsWrapper:function(){return this.element.find(l+o.classNames.sheetsBarItems);
},_scrollSheetsByDelta:function(q){var t=this;
var s=t._sheetsGroup();
var r=s.scrollLeft();
s.finish().animate({scrollLeft:r+q},"fast","linear",function(){if(t._nowScrollingSheets){t._scrollSheetsByDelta(q);
}else{t._toggleScrollButtons();
}});
}});
n.spreadsheet.SheetsBar=o;
k.extend(true,o,{classNames:p});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/calc",["spreadsheet/runtime"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var E=kendo.spreadsheet;
var B=E.RangeRef;
var k=E.CellRef;
var w=E.NameRef;
var m=E.calc;
var D=m.runtime;
var x=Object.create(null);
var y=kendo.Class.extend({init:function y(J,K){this.message=J;
this.pos=K;
},toString:function(){return this.message;
}});
(function(J){J.forEach(function(K,L){K.forEach(function(M){x[M]=J.length-L;
});
});
}([[":"],[" "],[","],["%"],["^"],["*","/"],["+","-"],["&"],["=","<",">","<=",">=","<>"]]));
var I={type:"bool",value:true};
var n={type:"bool",value:false};
function p(L){L=L.toUpperCase();
for(var J=0,K=0;
K<L.length;
++K){J=J*26+L.charCodeAt(K)-64;
}return J-1;
}function q(J){return parseInt(J,10)-1;
}function A(M,N){if(M.toLowerCase()=="#sheet"){return E.SHEETREF;
}OUT:{var L;
if(L=/^(\$)?([a-z]+)(\$)?(\d+)$/i.exec(M)){var P=q(L[4]),K=p(L[2]);
if(P<=1048576&&K<=16383){return new k(q(L[4]),p(L[2]));
}break OUT;
}var Q=H(M,{});
var J=[];
while(true){var O=Q.next();
if(O instanceof k){O.rel=0;
}else{if(O instanceof B){O.topLeft.rel=0;
O.bottomRight.rel=0;
}else{break OUT;
}}J.push(O);
if(Q.eof()){break;
}if(!Q.is("op",",")){break OUT;
}Q.next();
}return J.length==1?J[0]:new E.UnionRef(J);
}if(!N){throw new Error("Cannot parse reference: "+M);
}}function z(Y,X,K,M){var W=[];
M=H(M,{row:X,col:K});
var N=M.is;
return{type:"exp",ast:T(true),refs:W,sheet:Y,row:X,col:K};
function J(aa){aa.index=W.length;
W.push(aa);
return aa;
}function Z(ab,ac){if(N(ab,ac)){return M.next();
}else{var aa=M.peek();
if(aa){M.croak("Expected "+ab+" \xAB"+ac+"\xBB but found "+aa.type+" \xAB"+aa.value+"\xBB");
}else{M.croak("Expected "+ab+" \xAB"+ac+"\xBB");
}}}function T(aa){return O(P(S(aa)),0,aa);
}function V(aa){if(aa.upper=="TRUE"||aa.upper=="FALSE"){return aa.upper=="TRUE"?I:n;
}return J(new w(aa.value));
}function U(){var ab=M.next();
ab=ab.value;
Z("punc","(");
var aa=[];
if(!N("punc",")")){while(1){if(N("op",",")){aa.push({type:"null"});
M.next();
continue;
}aa.push(T(false));
if(M.eof()||N("punc",")")){break;
}Z("op",",");
}}Z("punc",")");
return{type:"func",func:ab,args:aa};
}function L(aa){if(!aa.hasSheet()){aa.setSheet(Y);
}return J(aa);
}function S(aa){var ab;
if(N("ref")){ab=L(M.next());
}else{if(N("func")){ab=U();
}else{if(N("punc","(")){M.next();
ab=T(true);
Z("punc",")");
}else{if(N("punc","{")){M.next();
ab=R();
Z("punc","}");
}else{if(N("num")||N("str")){ab=M.next();
}else{if(N("sym")){ab=V(M.next());
}else{if(N("op","+")||N("op","-")){ab={type:"prefix",op:M.next().value,exp:T(aa)};
}else{if(!M.peek()){M.croak("Incomplete expression");
}else{M.croak("Parse error");
}}}}}}}}return Q(ab);
}function R(){var ab=[],ac=[ab],aa=true;
while(!M.eof()&&!N("punc","}")){if(aa){aa=false;
}else{if(N("punc",";")){ac.push(ab=[]);
M.next();
}else{Z("op",",");
}}ab.push(T(false));
}return{type:"matrix",value:ac};
}function P(aa){if(N("punc","(")||N("ref")||N("num")||N("func")){return{type:"binary",op:" ",left:aa,right:T(false)};
}else{return aa;
}}function Q(aa){if(N("op","%")){M.next();
return Q({type:"postfix",op:"%",exp:aa});
}else{return aa;
}}function O(ac,ad,aa){var af=N("op");
if(af&&(aa||af.value!=",")){var ab=x[af.value];
if(ab>ad){M.next();
var ae=O(S(aa),ab,aa);
return O({type:"binary",op:af.value,left:ac,right:ae},ad,aa);
}}return ac;
}}function v(J){return t("function(row, col){return("+L(J.ast,0)+")}");
function L(N,O){switch(N.type){case"num":case"bool":return JSON.stringify(N.value);
case"str":return JSON.stringify(JSON.stringify(N.value));
case"ref":return"this.refs["+N.index+"].print(row, col)";
case"prefix":return M(N.op,O,function(){return JSON.stringify(N.op)+" + "+L(N.exp,x[N.op]);
});
case"postfix":return M(N.op,O,function(){return L(N.exp,x[N.op])+" + "+JSON.stringify(N.op);
});
case"binary":return M(N.op,O,function(){var P=K(L(N.left,x[N.op]),N.left instanceof w&&N.op==":");
var Q=K(L(N.right,x[N.op]),N.right instanceof w&&N.op==":");
return P+" + "+JSON.stringify(N.op)+" + "+Q;
});
case"func":return JSON.stringify(N.func+"(")+" + "+(N.args.length>0?N.args.map(function(P){return L(P,0);
}).join(" + ', ' + "):"''")+" + ')'";
case"matrix":return"'{ ' + "+N.value.map(function(P){return P.map(function(Q){return L(Q,0);
}).join(" + ', ' + ");
}).join(" + '; ' + ")+"+ ' }'";
case"null":return"''";
}throw new Error("Cannot make printer for node "+N.type);
}function K(N,O){return O?"'(' + "+N+" + ')'":N;
}function M(P,Q,N){var O=x[P]<Q||!Q&&P==",";
return K(N(),O);
}}function F(J,W){var V=0;
return K(J,W);
function K(Z,Y){switch(Z.type){case"ref":case"num":case"str":case"null":case"bool":return M(Z,Y);
case"prefix":case"postfix":return T(Z,Y);
case"binary":return N(Z,Y);
case"func":return O(Z,Y);
case"lambda":return Q(Z,Y);
case"matrix":return R(Z.value,Y,true);
}throw new Error("Cannot CPS "+Z.type);
}function M(Z,Y){return Y(Z);
}function T(Z,Y){return K({type:"func",func:"unary"+Z.op,args:[Z.exp]},Y);
}function N(Z,Y){return K({type:"func",func:"binary"+Z.op,args:[Z.left,Z.right]},Y);
}function P(Y,ab,Z,aa){return K(Y,function(ac){var ae=X(aa);
var af=U("T");
var ad=U("E");
return{type:"func",func:"if",args:[ae,ac,{type:"lambda",vars:[af],body:K(ab||I,function(ag){return{type:"call",func:{type:"var",name:af},args:[ag]};
})},{type:"lambda",vars:[ad],body:K(Z||n,function(ag){return{type:"call",func:{type:"var",name:ad},args:[ag]};
})}]};
});
}function L(Y,Z){if(Y.length===0){return M(I,Z);
}return K({type:"func",func:"IF",args:[Y[0],{type:"func",func:"AND",args:Y.slice(1)},n]},Z);
}function S(Y,Z){if(Y.length===0){return M(n,Z);
}return K({type:"func",func:"IF",args:[Y[0],I,{type:"func",func:"OR",args:Y.slice(1)}]},Z);
}function O(aa,Y){switch(aa.func.toLowerCase()){case"if":return P(aa.args[0],aa.args[1],aa.args[2],Y);
case"and":return L(aa.args,Y);
case"or":return S(aa.args,Y);
case"true":return Y(I);
case"false":return Y(n);
}return function Z(ab,ac){if(ac==aa.args.length){return{type:"func",func:aa.func,args:ab};
}else{return K(aa.args[ac],function(ad){return Z(ab.concat([ad]),ac+1);
});
}}([X(Y)],0);
}function Q(ab,aa){var Z=U("K");
var Y=K(ab.body,function(ac){return{type:"call",func:{type:"var",value:Z},args:[ac]};
});
return aa({type:"lambda",vars:[Z].concat(ab.vars),body:Y});
}function R(Z,ab,aa){var Y=[];
return function ac(ad){if(ad==Z.length){return ab({type:"matrix",value:Y});
}else{return(aa?R:K)(Z[ad],function(ae){Y[ad]=ae;
return ac(ad+1);
});
}}(0);
}function X(Z){var Y=U("R");
return{type:"lambda",vars:[Y],body:Z({type:"var",name:Y})};
}function U(Y){if(!Y){Y="";
}Y="_"+Y;
return Y+ ++V;
}}var t=function(J){return function(K){var L=J[K];
if(!L){L=J[K]=new Function("'use strict';return("+K+")")();
}return L;
};
}(Object.create(null));
var o=Object.create(null);
function u(K){var P=v(K);
var M=P.call(K);
var L=o[M];
if(L){return L.clone(K.sheet,K.row,K.col);
}var J=N(F(K.ast,function(Q){return{type:"return",value:Q};
}));
J=["function(){","var context = this, refs = context.formula.absrefs",J,"}"].join(";\n");
L=new D.Formula(K.refs,t(J),P,K.sheet,K.row,K.col);
o[M]=L;
return L;
function N(Q){var R=Q.type;
if(R=="num"){return Q.value+"";
}else{if(R=="str"){return JSON.stringify(Q.value);
}else{if(R=="return"){return"context.resolve("+N(Q.value)+")";
}else{if(R=="func"){return"context.func("+JSON.stringify(Q.func)+", "+N(Q.args[0])+", "+O(Q.args.slice(1))+")";
}else{if(R=="call"){return N(Q.func)+"("+Q.args.map(N).join(", ")+")";
}else{if(R=="ref"){return"refs["+Q.index+"]";
}else{if(R=="bool"){return""+Q.value;
}else{if(R=="if"){return"(context.bool("+N(Q.co)+") ? "+N(Q.th)+" : "+N(Q.el)+")";
}else{if(R=="lambda"){return"(function("+Q.vars.join(", ")+"){ return("+N(Q.body)+") })";
}else{if(R=="var"){return Q.name;
}else{if(R=="matrix"){return O(Q.value);
}else{if(R=="null"){return"null";
}else{throw new Error("Cannot compile expression "+R);
}}}}}}}}}}}}}function O(Q){return"[ "+Q.map(N).join(", ")+" ]";
}}function r(J){return J;
}function H(N,Q){N=C(s(N),Q);
var K=N.ahead;
var Z=N.skip;
var ab=null;
var L=Q.row!=null&&Q.col!=null?function(ac){if(ac.rel&1){ac.col-=Q.col;
}if(ac.rel&2){ac.row-=Q.row;
}return ac;
}:r;
var J=Q.forEditor?function(ae,ad,ac){ae.begin=ad.begin;
ae.end=ac.end;
return ae;
}:r;
return{peek:R,next:P,croak:N.croak,eof:N.eof,is:O};
function O(ad,ae){var ac=R();
return ac!=null&&(ad==null||ac.type===ad)&&(ae==null||ac.value===ae)?ac:null;
}function R(){if(ab==null){ab=S();
}return ab;
}function P(){if(ab!=null){var ac=ab;
ab=null;
return ac;
}return S();
}function S(){var ac;
var ad=N.peek();
if(ad){if(ad.type=="sym"||ad.type=="rc"||ad.type=="num"){ac=K(8,W)||K(6,U)||K(6,Y)||K(4,X)||K(4,V)||K(2,T)||K(2,M);
}if(!ac){ac=N.next();
}}return ac;
}function aa(ai,ae){if(ai.type=="rc"){if(ai.rel&&!Q.forEditor&&(Q.row==null||Q.col==null)){N.croak("Cannot read relative cell in RC notation");
}return new k(ai.row,ai.col,ai.rel);
}if(ai.type=="num"){if(ai.value<=1048577){return L(new k(q(ai.value),ae?-Infinity:+Infinity,2));
}else{return null;
}}var ag=ai.value;
var af=/^(\$)?([a-z]+)(\$)?(\d+)$/i.exec(ag);
if(af){var ah=q(af[4]),ad=p(af[2]);
if(ah<=1048576&&ad<=16383){return L(new k(q(af[4]),p(af[2]),(af[1]?0:1)|(af[3]?0:2)));
}else{return null;
}}var ac=ag.charAt(0)=="$";
if(ac){ag=ag.substr(1);
}if(/^\d+$/.test(ag)){var ah=q(ag);
if(ah<=1048576){return L(new k(q(ag),ae?-Infinity:+Infinity,ac?0:2));
}}else{var ad=p(ag);
if(ad<=16383){return L(new k(ae?-Infinity:+Infinity,p(ag),ac?0:1));
}}}function W(ac,ad,af,ag,ah,ai,aj,ak){if(ac.type=="sym"&&ad.type=="op"&&ad.value==":"&&af.type=="sym"&&ag.type=="punc"&&ag.value=="!"&&(ah.type=="sym"||ah.type=="rc"||ah.type=="num"&&ah.value==ah.value|0)&&ai.type=="op"&&ai.value==":"&&(aj.type=="sym"||aj.type=="rc"||aj.type=="num"&&aj.value==aj.value|0)&&aj.type==ah.type&&!(ak.type=="punc"&&ak.value=="("&&!aj.space)){var al=aa(ah,true),ae=aa(aj,false);
if(al&&ae){Z(7);
return J(new B(al.setSheet(ac.value,true),ae.setSheet(af.value,true)).setSheet(ac.value,true),ac,aj);
}}}function U(ac,ad,af,ag,ah,ai){if(ac.type=="sym"&&ad.type=="op"&&ad.value==":"&&af.type=="sym"&&ag.type=="punc"&&ag.value=="!"&&(ah.type=="sym"||ah.type=="rc"||ah.type=="num"&&ah.value==ah.value|0)&&!(ai.type=="punc"&&ai.value=="("&&!ah.space)){var aj=aa(ah);
if(aj){Z(5);
var ae=aj.clone();
return J(new B(aj.setSheet(ac.value,true),ae.setSheet(af.value,true)).setSheet(ac.value,true),ac,ah);
}}}function Y(ac,ad,af,ag,ah,ai){if(ac.type=="sym"&&ad.type=="punc"&&ad.value=="!"&&(af.type=="sym"||af.type=="rc"||af.type=="num"&&af.value==af.value|0)&&ag.type=="op"&&ag.value==":"&&(ah.type=="sym"||ah.type=="rc"||ah.type=="num"&&ah.value==ah.value|0)&&!(ai.type=="punc"&&ai.value=="("&&!ah.space)){var aj=aa(af,true),ae=aa(ah,false);
if(aj&&ae){Z(5);
return J(new B(aj,ae).setSheet(ac.value,true),ac,ah);
}}}function X(ac,ad,ae,af){if(ac.type=="sym"&&ad.type=="punc"&&ad.value=="!"&&(ae.type=="sym"||ae.type=="rc"||ae.type=="num"&&ae.value==ae.value|0)&&!(af.type=="punc"&&af.value=="("&&!ae.space)){Z(3);
var ag=aa(ae);
if(!ag){ag=new w(ae.value);
}return J(ag.setSheet(ac.value,true),ac,ae);
}}function V(ac,ad,af,ag){if((ac.type=="sym"||ac.type=="rc"||ac.type=="num"&&ac.value==ac.value|0)&&(ad.type=="op"&&ad.value==":")&&(af.type=="sym"||af.type=="rc"||af.type=="num"&&af.value==af.value|0)&&!(ag.type=="punc"&&ag.value=="("&&!af.space)){var ah=aa(ac,true),ae=aa(af,false);
if(ah&&ae){Z(3);
return J(new B(ah,ae),ac,af);
}}}function T(ac,ad){if((ac.type=="sym"||ac.type=="rc")&&!(ad.type=="punc"&&ad.value=="("&&!ac.space)){var ae=aa(ac);
if(ae&&isFinite(ae.row)&&isFinite(ae.col)){Z(1);
return J(ae,ac,ac);
}}}function M(ac,ad){if(ac.type=="sym"&&ad.type=="punc"&&ad.value=="("&&!ac.space){ac.type="func";
Z(1);
return ac;
}}}function C(N,V){var ah=[],M=0;
var ae=N.readWhile;
return{next:U,peek:W,eof:K,croak:N.croak,ahead:J,skip:af};
function O(ai){return/[0-9]/i.test(ai);
}function Q(ai){return/[a-z$_]/i.test(ai)||ai.toLowerCase()!=ai.toUpperCase();
}function P(ai){return Q(ai)||O(ai)||ai==".";
}function R(ai){return ai in x;
}function S(ai){return"!;(){}[]".indexOf(ai)>=0;
}function T(ai){return" \t\n\xA0".indexOf(ai)>=0;
}function Y(){var ai=false;
var aj=ae(function(ak){if(ak=="."){if(ai){return false;
}ai=true;
return true;
}return O(ak);
});
return{type:"num",value:parseFloat(aj)};
}function ag(ai,aj){return{type:"sym",value:ai,upper:ai.toUpperCase(),space:T(N.peek()),quote:aj};
}function L(ai,aj,ak){if(!ai&&!ak||ai&&ak){var al=ai&&/-$/.test(ai);
var am=parseInt(aj,10);
if(al){am=-am;
}if(!ai){am--;
}return am;
}}function ad(){var aj=N.lookingAt(/^R(\[-?)?([0-9]+)(\])?C(\[-?)?([0-9]+)(\])?/i);
if(aj){var ak=L(aj[1],aj[2],aj[3]);
var ai=L(aj[4],aj[5],aj[6]);
if(ak!=null&&ai!=null){N.skip(aj);
return{type:"rc",row:ak,col:ai,rel:(aj[4]?1:0)|(aj[1]?2:0)};
}}return ag(ae(P));
}function ac(){N.next();
return{type:"str",value:N.readEscaped('"')};
}function ab(){N.next();
return ag(N.readEscaped("'"),true);
}function Z(){return{type:"op",value:ae(function(ai,aj){return aj+ai in x;
})};
}function aa(){return{type:"punc",value:N.next()};
}function X(){if(N.eof()){return null;
}var ai=N.peek(),aj;
if(ai=='"'){return ac();
}if(ai=="'"){return ab();
}if(O(ai)){return Y();
}if(Q(ai)){return ad();
}if(R(ai)){return Z();
}if(S(ai)){return aa();
}if(aj=N.lookingAt(/^#([a-z\/]+)[?!]/i)){N.skip(aj);
return{type:"error",value:aj[1]};
}if(!V.forEditor){N.croak("Can't handle character: "+ai);
}return{type:"error",value:N.next()};
}function W(){while(ah.length<=M){ae(T);
var ai=N.pos();
var aj=X();
if(V.forEditor&&aj){aj.begin=ai;
aj.end=N.pos();
}ah.push(aj);
}return ah[M];
}function U(){var ai=W();
if(ai){M++;
}return ai;
}function J(ak,aj){var al=M,ai=[];
while(ak-->0){ai.push(U()||l);
}M=al;
return aj.apply(ai,ai);
}function af(ai){M+=ai;
}function K(){return W()==null;
}}var l={type:"eof"};
function s(N){var T=0,O=1,J=0;
return{next:R,peek:S,eof:L,croak:K,readWhile:V,readEscaped:U,lookingAt:Q,skip:W,forward:M,pos:P};
function P(){return T;
}function R(){var X=N.charAt(T++);
if(X=="\n"){O++;
J=0;
}else{J++;
}return X;
}function S(){return N.charAt(T);
}function L(){return S()==="";
}function K(X){throw new y(X,T);
}function W(X){if(typeof X=="string"){if(N.substr(T,X.length)!=X){K("Expected "+X);
}M(X.length);
}else{if(X instanceof RegExp){var Y=X.exec(N.substr(T));
if(Y){M(Y[0].length);
return Y;
}}else{M(X[0].length);
}}}function M(X){while(X-->0){R();
}}function U(Y){var Z=false,aa="";
while(!L()){var X=R();
if(Z){aa+=X;
Z=false;
}else{if(X=="\\"){Z=true;
}else{if(X==Y){break;
}else{aa+=X;
}}}}return aa;
}function V(X){var Y="";
while(!L()&&X(S(),Y)){Y+=R();
}return Y;
}function Q(X){return X.exec(N.substr(T));
}}m.parse=function(O,N,J,L){if(L instanceof Date){return{type:"date",value:D.dateToSerial(L)};
}if(typeof L=="number"){return{type:"number",value:L};
}if(typeof L=="boolean"){return{type:"boolean",value:L};
}L+="";
if(/^'/.test(L)){return{type:"string",value:L.substr(1)};
}if(/^[0-9.]+%$/.test(L)){var P=L.substr(0,L.length-1);
var M=parseFloat(P);
if(!isNaN(M)&&M==P){return{type:"percent",value:M/100};
}}if(/^=/.test(L)){L=L.substr(1);
if(/\S/.test(L)){return z(O,N,J,L);
}else{return{type:"string",value:"="+L};
}}if(L.toLowerCase()=="true"){return{type:"boolean",value:true};
}if(L.toLowerCase()=="false"){return{type:"boolean",value:false};
}var K=D.parseDate(L);
if(K){return{type:"date",value:D.dateToSerial(K)};
}var M=parseFloat(L);
if(!isNaN(M)&&L.length>0&&M==L){return{type:"number",value:M};
}return{type:"string",value:L};
};
function G(K,M,J){var O=[];
K=H(K,{forEditor:true,row:M,col:J});
while(!K.eof()){O.push(L());
}var N=O[0];
if(N.type=="op"&&N.value=="="){N.type="startexp";
}return O;
function L(){var P=K.next();
if(P.type=="sym"){if(P.upper=="TRUE"){P.type="bool";
P.value=true;
}else{if(P.upper=="FALSE"){P.type="bool";
P.value=false;
}}}else{if(P.type=="ref"){P={type:"ref",ref:M!=null&&J!=null?P.absolute(M,J):P,begin:P.begin,end:P.end};
}}return P;
}}m.parseFormula=z;
m.parseReference=A;
m.compile=u;
m.InputStream=s;
m.ParseError=y;
m.tokenize=G;
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/excel-reader",["kendo.core","kendo.color","util/parse-xml","spreadsheet/calc"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var k=kendo.jQuery;
var u=kendo.util.parseXML;
var t=kendo.spreadsheet.calc.parseReference;
function w(ag,ai,af){var ah=new FileReader();
ah.onload=function(aj){var ak=new JSZip(aj.target.result);
C(ak,ai,af);
};
ah.readAsArrayBuffer(ag);
}var F=["sheetData","row","c"];
var G=["cols","col"];
var H=["definedNames","definedName"];
var K=["sheetData","row","c","f"];
var M=["mergeCells","mergeCell"];
var P=["sheetViews","sheetView","pane"];
var Q=["sheetData","row"];
var T=["sheetViews","sheetView","selection"];
var V=["sheets","sheet"];
var X=["sheetData","row","c","is"];
var Y=["t"];
var U=["si"];
var Z=["sheetData","row","c","v"];
var aa=["bookViews","workbookView"];
var W=["sheetViews","sheetView"];
function C(an,am,ag){var aj=z(an);
var ai=x(an,"workbook.xml");
var al=B(an,ai.byType.theme[0]);
var ak=A(an,al);
var ah=[];
var af=0;
s(an,"xl/workbook.xml",{enter:function(au,ao){if(this.is(V)){var at=ao["r:id"];
var aq=ai.byId[at];
var ar=ao.name;
var ap=ab(an,aq);
ah.push({workbook:am,zip:an,strings:aj,styles:ak,file:aq,options:{name:ar,rows:Math.max(am.options.rows||0,ap.rows),columns:Math.max(am.options.columns||0,ap.cols),columnWidth:ap.columnWidth,rowHeight:ap.rowHeight}});
}else{if(this.is(aa)){if(ao.activeTab){af=q(ao.activeTab);
}}}},text:function(aq){var ao=this.is(H);
if(ao&&!(m(ao["function"])||m(ao.vbProcedure))){var ap=t(aq,true);
am.defineName(ao.name,ap,m(ao.hidden));
}}});
r(ah,am,ag).then(function(){var ao=am.sheets();
D(ao);
am.activeSheet(ao[af]);
});
}function r(ah,aj,af){var ai=new k.Deferred().resolve();
for(var ag=0;
ag<ah.length;
ag++){(function(ak,al){ai=ai.then(function(){var ao=aj.insertSheet(ak.options);
ao.suspendChanges(true);
var an=v(ao,ak);
if(af){var am={sheet:ao,progress:al/(ah.length-1)};
an.then(function(){af.notify(am);
});
}return an;
});
}(ah[ag],ag));
}if(af){ai.then(function(){af.resolve();
});
}return ai;
}function v(ah,af){var ag=new k.Deferred();
setTimeout(function(){y(af.zip,af.file,ah,af.strings,af.styles);
ag.resolve();
},0);
return ag;
}function D(ag){for(var af=0;
af<ag.length;
af++){ag[af].suspendChanges(false).triggerChange({recalc:true});
}}function ab(ah,ag){var af={rows:0,cols:0};
s(ah,"xl/"+ag,{enter:function(ak,ai){if(ak=="dimension"){var aj=t(ai.ref);
if(aj.bottomRight){af.cols=aj.bottomRight.col+1;
af.rows=aj.bottomRight.row+1;
}}else{if(ak==="sheetFormatPr"){if(ai.defaultColWidth){af.columnWidth=ac(parseFloat(ai.defaultColWidth));
}if(ai.defaultRowHeight){af.rowHeight=ae(parseFloat(ai.defaultRowHeight));
}}else{if(this.is(Q)){this.exit();
}}}}});
return af;
}function ac(ah){var ag=7;
var af=(256*ah+Math.floor(128/ag))/256;
return Math.floor(af)*ag;
}function ae(af){return af*1.5625;
}function y(aq,af,al,am,an){var ak,ao,ap,ag,ah;
var ai=al._columns._count;
var aj=null;
s(aq,"xl/"+af,{enter:function(aA,at){if(this.is(F)){ap=null;
ag=null;
ah=null;
ak=at.r;
if(ak==null){ak=t(aj);
ak.col++;
ak=ak.toString();
}aj=ak;
ao=at.t;
var az=at.s;
if(az!=null){l(al,ak,an,az);
}}else{if(this.is(M)){al.range(at.ref).merge();
}else{if(this.is(G)){var ax=q(at.min)-1;
var ay=Math.min(ai,q(at.max))-1;
if(at.width){var aB=ac(parseFloat(at.width));
al._columns.values.value(ax,ay,aB);
}if(at.hidden==="1"){for(var au=ax;
au<=ay;
au++){al.hideColumn(au);
}}}else{if(this.is(Q)){var aw=q(at.r)-1;
if(at.ht){var av=ae(parseFloat(at.ht));
al._rows.values.value(aw,aw,av);
}if(at.hidden==="1"){al.hideRow(aw);
}}else{if(this.is(T)){if(at.activeCell){var ar=t(at.activeCell);
al.select(ar,true);
}}else{if(this.is(P)){if(at.state=="frozen"){if(at.xSplit){al.frozenColumns(q(at.xSplit));
}if(at.ySplit){al.frozenRows(q(at.ySplit));
}}}else{if(this.is(W)){al.options.showGridLines=m(at.showGridLines,true);
}}}}}}}},leave:function(au){if(this.is(F)){if(ag!=null){try{al.range(ah||ak).formula(ag);
}catch(ar){al.range(ah||ak).value(ag).background("#ffaaaa");
}}else{if(ap!=null){var at=al.range(ak);
if(ao=="str"){at.formula(ap);
}else{if(!at._get("formula")){if(!ao||ao=="n"){ap=parseFloat(ap);
}else{if(ao=="s"){ap=am[q(ap)];
}else{if(ao=="b"){ap=ap==="1";
}else{if(ao=="d"){ap=kendo.parseDate(ap);
}}}}at.value(ap);
}}}}}else{if(au=="cols"){al._columns._refresh();
}else{if(au=="sheetData"){al._rows._refresh();
}}}},text:function(at){var ar;
if(this.is(Z)||this.is(X)){ap=at;
}else{if(ar=this.is(K)){ag=at;
if(ar.t=="shared"){ah=ar.ref;
}}}}});
}var n={none:0,thin:1,medium:2,dashed:1,dotted:1,thick:3,"double":3,hair:1,mediumDashed:2,dashDot:1,mediumDashDot:2,dashDotDot:1,mediumDashDotDot:2,slantDashDot:1};
var o={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"mm-dd-yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"};
function l(am,ah,ap,ao){var ag=am.range(ah);
var ar=ap.inlineStyles[ao],af,aq;
if(ar.xfId){af=ap.namedStyles[ar.xfId];
}if(an("applyBorder","borderId")){ai(ap.borders[aq]);
}if(an("applyFont","fontId")){ak(ap.fonts[aq]);
}if(an("applyAlignment","textAlign")){ag.textAlign(aq);
}if(an("applyAlignment","verticalAlign")){ag.verticalAlign(aq);
}if(an("applyAlignment","wrapText")){ag._property("wrap",aq);
}if(an("applyFill","fillId")){aj(ap.fills[aq]);
}if(an("applyNumberFormat","numFmtId")){al(ap.numFmts[aq]||o[aq]);
}function al(at){var au=typeof at=="string"?at:at.formatCode;
if(au!=null&&!/^general$/i.test(au)){au=au.replace(/^\[\$-[0-9]+\]/,"");
ag.format(au);
}}function aj(at){if(at.type=="solid"){ag.background(at.color);
}}function ak(at){ag.fontFamily(at.name);
ag._property("fontSize",at.size);
if(at.bold){ag.bold(true);
}if(at.italic){ag.italic(true);
}}function ai(at){function au(ay,ax){var av=at[ay];
if(!av){return;
}var az=n[av.style];
if(az===0){return;
}var aw=av.color;
if(aw==null){aw="#000";
}ag._property(ax,{size:az,color:aw});
}au("left","borderLeft");
au("top","borderTop");
au("right","borderRight");
au("bottom","borderBottom");
}function an(at,au){var av=ar[at];
if(av!=null&&!av){return false;
}aq=ar[au];
if(af&&aq==null){av=af[at];
if(av!=null&&!av){return false;
}aq=af[au];
}return aq!=null;
}}function s(ai,ag,af){var ah=ai.files[ag];
if(ah){u(ah.asUint8Array(),af);
}}function z(ah){var ag=[];
var af;
s(ah,"xl/sharedStrings.xml",{enter:function(){if(this.is(U)){af="";
}},leave:function(){if(this.is(U)){ag.push(af);
}},text:function(ai){if(this.is(Y)){af+=ai;
}}});
return ag;
}function x(ah,af){var ag={byId:{},byType:{theme:[]}};
s(ah,"xl/_rels/"+af+".rels",{enter:function(ak,ai){if(ak=="Relationship"){ag.byId[ai.Id]=ai.Target;
var al=ai.Type.match(/\w+$/)[0];
var aj=ag.byType[al]||[];
aj.push(ai.Target);
ag.byType[al]=aj;
}}});
return ag;
}var E=["borders","border"];
var I=["fills","fill"];
var J=["fonts","font"];
var L=["cellXfs","xf"];
var N=["cellStyleXfs","xf"];
var O=["numFmts","numFmt"];
var p=[ad("FF000000"),ad("FFFFFFFF"),ad("FFFF0000"),ad("FF00FF00"),ad("FF0000FF"),ad("FFFFFF00"),ad("FFFF00FF"),ad("FF00FFFF"),ad("FF000000"),ad("FFFFFFFF"),ad("FFFF0000"),ad("FF00FF00"),ad("FF0000FF"),ad("FFFFFF00"),ad("FFFF00FF"),ad("FF00FFFF"),ad("FF800000"),ad("FF008000"),ad("FF000080"),ad("FF808000"),ad("FF800080"),ad("FF008080"),ad("FFC0C0C0"),ad("FF808080"),ad("FF9999FF"),ad("FF993366"),ad("FFFFFFCC"),ad("FFCCFFFF"),ad("FF660066"),ad("FFFF8080"),ad("FF0066CC"),ad("FFCCCCFF"),ad("FF000080"),ad("FFFF00FF"),ad("FFFFFF00"),ad("FF00FFFF"),ad("FF800080"),ad("FF800000"),ad("FF008080"),ad("FF0000FF"),ad("FF00CCFF"),ad("FFCCFFFF"),ad("FFCCFFCC"),ad("FFFFFF99"),ad("FF99CCFF"),ad("FFFF99CC"),ad("FFCC99FF"),ad("FFFFCC99"),ad("FF3366FF"),ad("FF33CCCC"),ad("FF99CC00"),ad("FFFFCC00"),ad("FFFF9900"),ad("FFFF6600"),ad("FF666699"),ad("FF969696"),ad("FF003366"),ad("FF339966"),ad("FF003300"),ad("FF333300"),ad("FF993300"),ad("FF993366"),ad("FF333399"),ad("FF333333"),ad("FF000000"),ad("FFFFFFFF")];
function A(an,al){var ak={fonts:[],numFmts:{},fills:[],borders:[],namedStyles:[],inlineStyles:[]};
var ah=null;
var ag=null;
var af=null;
var am=null;
s(an,"xl/styles.xml",{enter:function(ar,ao,ap){if(this.is(O)){ak.numFmts[ao.numFmtId]=ao;
}else{if(this.is(J)){ak.fonts.push(ah={});
}else{if(ah){if(ar=="sz"){ah.size=parseFloat(ao.val);
}else{if(ar=="name"){ah.name=ao.val;
}else{if(ar=="b"){ah.bold=m(ao.val,true);
}else{if(ar=="i"){ah.italic=m(ao.val,true);
}}}}}else{if(this.is(I)){ak.fills.push(ag={});
}else{if(ag){if(ar=="patternFill"){ag.type=ao.patternType;
}else{if(ar=="fgColor"&&ag.type==="solid"){ag.color=ai(ao);
}else{if(ar=="bgColor"&&ag.type!=="solid"){ag.color=ai(ao);
}}}}else{if(this.is(E)){ak.borders.push(af={});
}else{if(af){if(/^(?:left|top|right|bottom)$/.test(ar)&&ao.style){af[ar]={style:ao.style};
}if(ar=="color"){var aq=this.stack[this.stack.length-2].$tag;
af[aq].color=ai(ao);
}}else{if(this.is(N)){am=aj(ao);
ak.namedStyles.push(am);
if(ap){am=null;
}}else{if(this.is(L)){am=aj(ao);
ak.inlineStyles.push(am);
if(ap){am=null;
}}else{if(am){if(ar=="alignment"){if(/^(?:left|center|right|justify)$/.test(ao.horizontal)){am.textAlign=ao.horizontal;
}if(/^(?:top|center|bottom)$/.test(ao.vertical)){am.verticalAlign=ao.vertical;
}if(ao.wrapText!=null){am.wrapText=m(ao.wrapText);
}}}}}}}}}}}}},leave:function(ao){if(this.is(J)){ah=null;
}else{if(this.is(I)){ag=null;
}else{if(this.is(E)){af=null;
}else{if(ao=="xf"){am=null;
}}}}}});
function aj(ap){var aq={borderId:q(ap.borderId),fillId:q(ap.fillId),fontId:q(ap.fontId),numFmtId:q(ap.numFmtId),pivotButton:m(ap.pivotButton),quotePrefix:m(ap.quotePrefix),xfId:q(ap.xfId)};
ao("applyAlignment");
ao("applyBorder");
ao("applyFill");
ao("applyFont");
ao("applyNumberFormat");
ao("applyProtection");
function ao(ar){if(ap[ar]!=null){aq[ar]=m(ap[ar]);
}}return aq;
}function ai(ao){if(ao.rgb){return ad(ao.rgb);
}else{if(ao.indexed){return p[q(ao.indexed)];
}else{if(ao.theme){var aq=al.colorScheme[q(ao.theme)];
var ap=kendo.parseColor(aq);
if(ao.tint){ap=ap.toHSL();
var ar=parseFloat(ao.tint);
if(ar<0){ap.l=ap.l*(1+ar);
}else{ap.l=ap.l*(1-ar)+(100-100*(1-ar));
}}return ap.toCssRgba();
}}}}return ak;
}var R=["a:clrScheme","*","a:srgbClr"];
var S=["a:clrScheme","*","a:sysClr"];
function B(ak,ag){var ah=[];
var aj={colorScheme:ah};
var af="xl/"+ag;
if(ak.files[af]){s(ak,af,{enter:function(am,al){if(this.is(S)){ah.push(ad(al.val=="window"?"FFFFFFFF":"FF000000"));
}else{if(this.is(R)){ah.push(ad("FF"+al.val));
}}}});
if(ah.length>3){ai(ah,0,1);
ai(ah,2,3);
}}function ai(am,al,an){var ao=am[al];
am[al]=am[an];
am[an]=ao;
}return aj;
}function q(af){return af==null?null:parseInt(af,10);
}function m(ag,af){if(ag==null){return af;
}return ag=="true"||ag===true||ag==1;
}function ad(ag){var af=/^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(ag);
return"rgba("+parseInt(af[2],16)+", "+parseInt(af[3],16)+", "+parseInt(af[4],16)+", "+parseInt(af[1],16)/255+")";
}kendo.spreadsheet.readExcel=w;
kendo.spreadsheet._readSheet=y;
kendo.spreadsheet._readStrings=z;
kendo.spreadsheet._readStyles=A;
kendo.spreadsheet._readTheme=B;
kendo.spreadsheet._readWorkbook=C;
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/workbook",["kendo.core","spreadsheet/runtime","spreadsheet/references","spreadsheet/excel-reader"],l);
}(function(){(function(l){if(l.support.browser.msie&&l.support.browser.version<9){return;
}var k=l.jQuery;
var m=l.Observable.extend({init:function(n,o){l.Observable.fn.init.call(this);
this.options=n;
this._view=o;
this._sheets=[];
this._sheetsSearchCache={};
this._sheet=this.insertSheet({rows:this.options.rows,columns:this.options.columns,rowHeight:this.options.rowHeight,columnWidth:this.options.columnWidth,headerHeight:this.options.headerHeight,headerWidth:this.options.headerWidth,dataSource:this.options.dataSource});
this.undoRedoStack=new l.util.UndoRedoStack();
this.undoRedoStack.bind(["undo","redo"],this._onUndoRedo.bind(this));
this._context=new l.spreadsheet.FormulaContext(this);
this._validationContext=new l.spreadsheet.ValidationFormulaContext(this);
this._names=Object.create(null);
this.fromJSON(this.options);
},clipboard:function(){if(!this._clipboard){this._clipboard=new l.spreadsheet.Clipboard(this);
}return this._clipboard;
},destroy:function(){this.unbind();
if(this._clipboard){this._clipboard.destroy();
}},events:["change","excelImport","excelExport"],_sheetChange:function(n){this.trigger("change",n);
},_inputForRef:function(n){return new l.spreadsheet.Range(n,this._sheet).input();
},_onUndoRedo:function(n){n.command.range().select();
},execute:function(p){var o=k.extend({workbook:this},p.options);
var n=new l.spreadsheet[p.command](o);
var r=this.activeSheet();
if(o.origin){n.origin(o.origin);
}if(o.operatingRange){n.range(o.operatingRange);
}else{if(o.editActiveCell){n.range(r.activeCellSelection());
}else{n.range(r.selection());
}}var q=n.exec();
if(!q||q.reason!=="error"){this.undoRedoStack.push(n);
}return q;
},resetFormulas:function(){this._sheets.forEach(function(n){n.resetFormulas();
});
},resetValidations:function(){this._sheets.forEach(function(n){n.resetValidations();
});
},refresh:function(n){if(n.recalc){this.resetFormulas();
this.resetValidations();
this._sheet.recalc(this._context);
this._sheet.revalidate(this._validationContext);
}},activeSheet:function(n){if(n===j){return this._sheet;
}if(!this.sheetByName(n.name())){return;
}this._sheet=n;
n.triggerChange(l.spreadsheet.ALL_REASONS);
},moveSheetToIndex:function(o,q){var n=this.sheetIndex(o);
var p=this._sheets;
if(n===-1){return;
}this._sheetsSearchCache={};
p.splice(q,0,p.splice(n,1)[0]);
this.trigger("change",{sheetSelection:true});
},insertSheet:function(p){p=p||{};
var t=this;
var o=typeof p.index==="number"?p.index:t._sheets.length;
var r;
var s=t._sheets;
var n=function(v){v=v?v:1;
var u="Sheet"+v;
if(!t.sheetByName(u)){return u;
}return n(v+1);
};
if(p.name&&t.sheetByName(p.name)){return;
}this._sheetsSearchCache={};
r=p.name||n();
var q=new l.spreadsheet.Sheet(p.rows||this.options.rows,p.columns||this.options.columns,p.rowHeight||this.options.rowHeight,p.columnWidth||this.options.columnWidth,p.headerHeight||this.options.headerHeight,p.headerWidth||this.options.headerWidth);
q._workbook=this;
q._name(r);
q.bind("change",this._sheetChange.bind(this));
s.splice(o,0,q);
if(p.data){q.fromJSON(p.data);
}if(p.dataSource){q.setDataSource(p.dataSource);
}this.trigger("change",{sheetSelection:true});
return q;
},sheets:function(){return this._sheets.slice();
},sheetByName:function(n){return this._sheets[this.sheetIndex(n)];
},sheetByIndex:function(n){return this._sheets[n];
},sheetIndex:function(p){var r=this._sheets;
var q=(typeof p=="string"?p:p.name()).toLowerCase();
var n=this._sheetsSearchCache[q];
if(n>=0){return n;
}for(n=0;
n<r.length;
n++){var o=r[n].name().toLowerCase();
this._sheetsSearchCache[o]=n;
if(o===q){return n;
}}return -1;
},renameSheet:function(p,n){var o=p.name();
if(!n||o===n){return;
}p=this.sheetByName(o);
if(!p){return;
}this._sheetsSearchCache={};
this._sheets.forEach(function(q){q._forFormulas(function(r){r.renameSheet(o,n);
});
});
p._name(n);
this.trigger("change",{sheetSelection:true});
return p;
},removeSheet:function(q){var s=this;
var r=s._sheets;
var o=q.name();
var n=s.sheetIndex(q);
if(r.length===1){return;
}this._sheetsSearchCache={};
if(n>-1){q.unbind();
r.splice(n,1);
if(s.activeSheet().name()===o){var p=r[n===r.length?n-1:n];
s.activeSheet(p);
}else{this.trigger("change",{recalc:true,sheetSelection:true});
}}},fromJSON:function(p){if(p.sheets){for(var o=0;
o<p.sheets.length;
o++){var q=this.sheetByIndex(o);
if(!q){q=this.insertSheet();
}q.fromJSON(p.sheets[o]);
var n=p.sheets[o].dataSource;
if(n){q.setDataSource(n);
}}}if(p.activeSheet){this.activeSheet(this.sheetByName(p.activeSheet));
}},toJSON:function(){this.resetFormulas();
this.resetValidations();
return{activeSheet:this.activeSheet().name(),sheets:this._sheets.map(function(n){n.recalc(this._context);
return n.toJSON();
},this)};
},fromFile:function(p){var o=new k.Deferred();
var r=o.promise();
var n={file:p,promise:r};
if(p&&!this.trigger("excelImport",n)){for(var q=0;
q<this._sheets.length;
q++){this._sheets[q].unbind();
}this._sheets=[];
this._sheetsSearchCache={};
l.spreadsheet.readExcel(p,this,o);
}else{o.reject();
}return r;
},saveAsExcel:function(o){o=k.extend({},this.options.excel,o);
var n=this.toJSON();
if(!this.trigger("excelExport",{workbook:n})){var p=new l.ooxml.Workbook(n);
l.saveAs({dataURI:p.toDataURL(),fileName:n.fileName||o.fileName,proxyURL:o.proxyURL,forceProxy:o.forceProxy});
}},draw:function(p,n){if(typeof p=="function"&&!n){n=p;
p={};
}var q=[],r=this._sheets;
(function o(t){if(t<r.length){r[t].draw(l.spreadsheet.SHEETREF,p,function(u){q.push(u);
o(t+1);
});
}else{var s=q[0];
for(t=1;
t<q.length;
++t){s.children=s.children.concat(q[t].children);
}n(s);
}}(0));
},defineName:function(o,p,n){this._names[o]={value:p,hidden:n};
},undefineName:function(n){delete this._names[n];
},nameValue:function(n){if(n in this._names){return this._names[n].value;
}return null;
},adjustNames:function(n,p,q,o){n=n.toLowerCase();
Object.keys(this._names).forEach(function(r){var s=this.nameValue(r);
if(s instanceof l.spreadsheet.Ref&&s.sheet.toLowerCase()==n){s=s.adjust(null,null,null,null,p,q,o);
this.defineName(r,s);
}},this);
},options:{}});
l.spreadsheet.Workbook=m;
if(l.PDFMixin){l.PDFMixin.extend(m.prototype);
m.prototype.saveAsPDF=function(o){var p=new k.Deferred();
var q=p.promise();
var n={promise:q};
if(this.trigger("pdfExport",n)){return;
}this._drawPDF(o,p).then(function(r){return l.drawing.exportPDF(r);
}).done(function(r){l.saveAs({dataURI:r,fileName:o.fileName,proxyURL:o.proxyURL,forceProxy:o.forceProxy,proxyTarget:o.proxyTarget});
p.resolve();
}).fail(function(r){p.reject(r);
});
return q;
};
m.prototype._drawPDF=function(o){var p=new k.Deferred();
var n=function(q){p.resolve(q);
};
switch(o.area){case"workbook":o.workbook.draw(o,n);
break;
case"sheet":o.workbook.activeSheet().draw(o,n);
break;
case"selection":o.workbook.activeSheet().selection().draw(o,n);
break;
}return p.promise();
};
}}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/formulacontext",["kendo.core"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var p=kendo.spreadsheet;
var k=p.CellRef;
var n=p.RangeRef;
var q=p.UnionRef;
var m=p.NameRef;
var o=p.Ref;
var l=kendo.Class.extend({init:function(s){this.workbook=s;
},getRefCells:function(B,x){var D,w,J,y;
if(B instanceof k){D=this.workbook.sheetByName(B.sheet);
if(!D||!B.valid()){return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];
}w=D.formula(B);
J=D.range(B.row,B.col).value();
if(w!=null||J!=null){return[{formula:w,value:J,row:B.row,col:B.col,sheet:B.sheet,hidden:x?D.columnWidth(B.col)===0||D.rowHeight(B.row)===0:false}];
}else{return[];
}}if(B instanceof n){y=this.workbook.sheetIndex(B.sheet);
var F=[],A=y;
if(B.endSheet){A=this.workbook.sheetIndex(B.endSheet);
if(y>A){var H=y;
y=A;
A=H;
}}if(y<0||A<0||!B.valid()){return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];
}while(y<=A){D=this.workbook.sheetByIndex(y++);
var G=D._grid.normalize(B.topLeft);
var t=D._grid.normalize(B.bottomRight);
var E=D._grid.cellRefIndex(G);
var v=D._grid.cellRefIndex(t);
var K=D._properties.iterator("value",E,v);
for(var u=G.col;
u<=t.col;
++u){for(var C=G.row;
C<=t.row;
++C){var z=D._grid.index(C,u);
w=D._properties.get("formula",z);
J=K.at(z);
if(w!=null||J!=null){F.push({formula:w,value:J,row:C,col:u,sheet:D.name(),hidden:x?D.columnWidth(u)===0||D.rowHeight(C)===0:false});
}}}}return F;
}if(B instanceof q){var s=[];
for(y=0;
y<B.refs.length;
++y){s=s.concat(this.getRefCells(B.refs[y],x));
}return s;
}if(B instanceof m){var I=this.workbook.nameValue(B.name);
if(I instanceof o){return this.getRefCells(I,x);
}return[{value:new kendo.spreadsheet.calc.runtime.CalcError("NAME")}];
}return[];
},getData:function(t){var u=t instanceof k;
if(t instanceof m){u=this.workbook.nameValue(t) instanceof k;
}var s=this.getRefCells(t).map(function(v){return v.value;
});
return u?s[0]:s;
},onFormula:function(u){var w=this.workbook.sheetByName(u.sheet);
var v=u.row,s=u.col,x=u.value;
var t=w.formula({row:v,col:s});
if(t!==u){return false;
}if(x instanceof kendo.spreadsheet.calc.runtime.Matrix){x.each(function(A,z,y){w._value(v+z,s+y,A);
});
}else{w._value(v,s,x);
}return true;
}});
var r=l.extend({onFormula:function(){return true;
}});
p.FormulaContext=l;
p.ValidationFormulaContext=r;
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/controller",["kendo.core"],l);
}(function(){(function(x){if(x.support.browser.msie&&x.support.browser.version<9){return;
}var k=x.jQuery;
var n=/:alphanum$/;
var m={up:"up",down:"down",left:"left",right:"right",home:"first-col","ctrl+left":"first-col",end:"last-col","ctrl+right":"last-col","ctrl+up":"first-row","ctrl+down":"last-row","ctrl+home":"first","ctrl+end":"last",pageup:"prev-page",pagedown:"next-page"};
var u={tab:"next","shift+tab":"previous",enter:"lower","shift+enter":"upper","delete":"clearContents",backspace:"clearContents","shift+:alphanum":"edit",":alphanum":"edit","ctrl+:alphanum":"ctrl",":edit":"edit"};
var q={wheel:"onWheel","*+mousedown":"onMouseDown",contextmenu:"onContextMenu","*+mousedrag":"onMouseDrag","*+mouseup":"onMouseUp","*+dblclick":"onDblClick",mousemove:"onMouseMove"};
var o={"*+pageup":"onPageUp","*+pagedown":"onPageDown",mouseup:"onMouseUp","*+cut":"onCut","*+paste":"onPaste","*+copy":"onCopy"};
var s={esc:"onEditorEsc",enter:"onEditorBlur","shift+enter":"onEditorBlur",tab:"onEditorBlur","shift+tab":"onEditorBlur"};
var v=k.extend({focus:"onEditorBarFocus"},s);
var w=k.extend({focus:"onEditorCellFocus"},s);
var z={cell:"range",rowheader:"row",columnheader:"column",topcorner:"sheet",autofill:"autofill"};
function B(D){return D.map(function(E){return'[data-action="'+E+'"]';
}).join(",");
}var p=B(["cut","copy","paste","insert-left","insert-right","insert-above","insert-below"]);
var C=B(["unhide-row","unhide-column"]);
var l=[];
var A=[];
var t=[];
for(var y in m){l.push(y);
A.push("shift+"+y);
}for(y in u){t.push(y);
}o[l]="onAction";
o[A]="onShiftAction";
o[t]="onEntryAction";
w[l]="onEditorAction";
w[A]="onEditorShiftAction";
var r=x.Class.extend({init:function(D,E){this.view=D;
this.workbook(E);
this.container=k(D.container);
this.clipboardElement=k(D.clipboard);
this.cellContextMenu=D.cellContextMenu;
this.rowHeaderContextMenu=D.rowHeaderContextMenu;
this.colHeaderContextMenu=D.colHeaderContextMenu;
this.scroller=D.scroller;
this.tabstrip=D.tabstrip;
this.sheetsbar=D.sheetsbar;
this.editor=D.editor;
this.editor.bind("change",this.onEditorChange.bind(this));
this.editor.bind("activate",this.onEditorActivate.bind(this));
this.editor.bind("deactivate",this.onEditorDeactivate.bind(this));
this.editor.bind("update",this.onEditorUpdate.bind(this));
k(D.scroller).on("scroll",this.onScroll.bind(this));
this.listener=new x.spreadsheet.EventListener(this.container,this,q);
this.keyListener=new x.spreadsheet.EventListener(this.clipboardElement,this,o);
this.barKeyListener=new x.spreadsheet.EventListener(this.editor.barElement(),this,v);
this.inputKeyListener=new x.spreadsheet.EventListener(this.editor.cellElement(),this,w);
if(this.sheetsbar){this.sheetsbar.bind("select",this.onSheetBarSelect.bind(this));
this.sheetsbar.bind("reorder",this.onSheetBarReorder.bind(this));
this.sheetsbar.bind("rename",this.onSheetBarRename.bind(this));
this.sheetsbar.bind("remove",this.onSheetBarRemove.bind(this));
}this.cellContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.rowHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.colHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on("contextmenu",false);
if(this.tabstrip){this.tabstrip.bind("action",this.onCommandRequest.bind(this));
this.tabstrip.bind("dialog",this.onDialogRequest.bind(this));
}},_execute:function(D){var E=this._workbook.execute(D);
if(D.command==="EditCommand"&&!E){this._workbook.trigger("change",{editorClose:true});
}if(E){if(E.reason==="error"){this.view.showError(E);
}else{this.view.openDialog(E.reason);
}}return E;
},_activeTooltip:function(){return this._workbook.activeSheet().activeCell().simplify().toString();
},onContextMenuSelect:function(F){var D=k(F.item).data("action");
var E;
switch(D){case"cut":E={command:"ToolbarCutCommand",options:{workbook:this._workbook}};
break;
case"copy":E={command:"ToolbarCopyCommand",options:{workbook:this._workbook}};
break;
case"paste":E={command:"ToolbarPasteCommand",options:{workbook:this._workbook}};
break;
case"unmerge":E={command:"MergeCellCommand",options:{value:"unmerge"}};
break;
case"merge":this.view.openDialog("merge");
break;
case"hide-row":E={command:"HideLineCommand",options:{axis:"row"}};
break;
case"hide-column":E={command:"HideLineCommand",options:{axis:"column"}};
break;
case"unhide-row":E={command:"UnHideLineCommand",options:{axis:"row"}};
break;
case"unhide-column":E={command:"UnHideLineCommand",options:{axis:"column"}};
break;
case"delete-row":E={command:"DeleteRowCommand"};
break;
case"delete-column":E={command:"DeleteColumnCommand"};
break;
}if(E){this._execute(E);
}},onSheetBarRemove:function(D){var E=this._workbook.sheetByName(D.name);
if(!E){return;
}this._workbook.removeSheet(E);
},destroy:function(){this.listener.destroy();
this.keyListener.destroy();
this.inputKeyListener.destroy();
},onSheetBarSelect:function(D){var E;
var F=this._workbook;
if(D.isAddButton){E=F.insertSheet();
}else{E=F.sheetByName(D.name);
}if(F.activeSheet().name()!==E.name()){F.activeSheet(E);
}},onSheetBarReorder:function(D){var E=this._workbook.sheetByIndex(D.oldIndex);
this._workbook.moveSheetToIndex(E,D.newIndex);
this._workbook.activeSheet(E);
},onSheetBarRename:function(D){var E=this._workbook.sheetByIndex(D.sheetIndex);
this._workbook.renameSheet(E,D.name);
this.clipboardElement.focus();
},sheet:function(D){this.navigator=D.navigator();
this.axisManager=D.axisManager();
},workbook:function(D){this._workbook=D;
this.clipboard=D.clipboard();
},refresh:function(){var D=this.editor;
var F=this._workbook;
var E=F.activeSheet();
this._viewPortHeight=this.view.scroller.clientHeight;
this.navigator.height(this._viewPortHeight);
if(!D.isActive()){D.enable(E.selection().enable()!==false);
D.value(F._inputForRef(E.activeCell()));
}},onScroll:function(){this.view.render();
},onWheel:function(F){var D=F.originalEvent.deltaX;
var E=F.originalEvent.deltaY;
if(F.originalEvent.deltaMode===1){D*=10;
E*=10;
}this.scrollWith(D,E);
F.preventDefault();
},onAction:function(E,D){this.navigator.moveActiveCell(m[D]);
E.preventDefault();
},onPageUp:function(){this.scrollDown(-this._viewPortHeight);
},onPageDown:function(){this.scrollDown(this._viewPortHeight);
},onEntryAction:function(F,D){if(F.mod){var H=true;
var G=String.fromCharCode(F.keyCode);
switch(G){case"A":this.navigator.selectAll();
break;
case"Y":this._workbook.undoRedoStack.redo();
break;
case"Z":this._workbook.undoRedoStack.undo();
break;
default:H=false;
break;
}if(H){F.preventDefault();
}}else{var E=this._workbook.activeSheet().selection().enable()===false;
if(D=="delete"||D=="backspace"){if(E){return;
}this._execute({command:"ClearContentCommand"});
F.preventDefault();
}else{if(n.test(D)||D===":edit"){if(E){return;
}if(D!==":edit"){this.editor.value("");
}this.editor.activate({range:this._workbook.activeSheet()._viewActiveCell(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()}).focus();
}else{this.navigator.navigateInSelection(u[D]);
F.preventDefault();
}}}},onShiftAction:function(E,D){this.navigator.modifySelection(m[D.replace("shift+","")],this.appendSelection);
E.preventDefault();
},onMouseMove:function(D){var F=this._workbook.activeSheet();
if(F.resizingInProgress()||F.selectionInProgress()){return;
}var E=this.objectAt(D);
if(E.type==="columnresizehandle"||E.type==="rowresizehandle"){F.positionResizeHandle(E.ref);
}else{F.removeResizeHandle();
}},onMouseDown:function(D){var E=this.objectAt(D);
if(E.pane){this.originFrame=E.pane;
}if(this.editor.canInsertRef(false)&&E.ref){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());
this.navigator.startSelection(E.ref,this._selectionMode,this.appendSelection);
D.preventDefault();
return;
}else{this.editor.deactivate();
if(this.editor.isActive()){D.preventDefault();
return;
}}var F=this._workbook.activeSheet();
if(E.type==="columnresizehandle"||E.type==="rowresizehandle"){F.startResizing({x:E.x,y:E.y});
D.preventDefault();
return;
}if(E.type==="filtericon"){this.openFilterMenu(D);
D.preventDefault();
return;
}this._selectionMode=z[E.type];
this.appendSelection=D.mod;
this.navigator.startSelection(E.ref,this._selectionMode,this.appendSelection);
},onContextMenu:function(D){var I=this._workbook.activeSheet();
if(I.resizingInProgress()){return;
}D.preventDefault();
this.cellContextMenu.close();
this.colHeaderContextMenu.close();
this.rowHeaderContextMenu.close();
var G;
var F={pageX:D.pageX,pageY:D.pageY};
var H=this.objectAt(F);
if(H.type==="columnresizehandle"||H.type==="rowresizehandle"){return;
}this.navigator.selectForContextMenu(H.ref,z[H.type]);
var E=this.navigator._sheet.select() instanceof x.spreadsheet.UnionRef;
var J=false;
var K=false;
if(H.type=="columnheader"){G=this.colHeaderContextMenu;
J=!E&&this.axisManager.selectionIncludesHiddenColumns();
}else{if(H.type=="rowheader"){G=this.rowHeaderContextMenu;
J=!E&&this.axisManager.selectionIncludesHiddenRows();
}else{G=this.cellContextMenu;
K=this.navigator.selectionIncludesMergedCells();
}}G.element.find(p).toggle(!E);
G.element.find(C).toggle(J);
G.element.find("[data-action=unmerge]").toggle(K);
setTimeout(function(){G.open(D.pageX,D.pageY);
});
},prevent:function(D){D.preventDefault();
},constrainResize:function(G,D){var F=this._workbook.activeSheet();
var E=F.resizeHandlePosition();
return !E||G==="outside"||G==="topcorner"||D.col<E.col||D.row<E.row;
},onMouseDrag:function(D){if(this._selectionMode==="sheet"){return;
}var F={pageX:D.pageX,pageY:D.pageY};
var G=this.objectAt(F);
var H=this._workbook.activeSheet();
if(H.resizingInProgress()){if(!this.constrainResize(G.type,G.ref)){H.resizeHintPosition({x:G.x,y:G.y});
}return;
}if(G.type==="outside"){this.startAutoScroll(G);
return;
}if(this.originFrame===G.pane){this.selectToLocation(F);
}else{var E=this.originFrame._grid;
if(G.x>E.right){this.scrollLeft();
}if(G.y>E.bottom){this.scrollTop();
}if(G.y<E.top||G.x<E.left){this.startAutoScroll(G,F);
}else{this.selectToLocation(F);
}}D.preventDefault();
},onMouseUp:function(F){var H=this._workbook.activeSheet();
H.completeResizing();
this.navigator.completeSelection();
this.stopAutoScroll();
var D=this.editor.activeEditor();
if(!D){return;
}var E=F.target;
while(E){if(E===D.element[0]){return;
}E=E.parentNode;
}var G=this.objectAt(F);
if(G&&G.ref&&D.canInsertRef(false)){D.refAtPoint(H.selection()._ref);
H._setFormulaSelections(D.highlightedRefs());
}},onDblClick:function(E){var F=this.objectAt(E);
var D=this._workbook.activeSheet().selection().enable()===false;
if(F.type!=="cell"||D){return;
}this.editor.activate({range:this._workbook.activeSheet()._viewActiveCell(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()}).focus();
this.onEditorUpdate();
},onCut:function(D){if(D){var E=this.clipboardElement.find("table.kendo-clipboard-"+this.clipboard._uid).detach();
this.clipboardElement.append(E.clone(false));
setTimeout(function(){this.clipboardElement.empty().append(E);
}.bind(this));
}this._execute({command:"CutCommand",options:{workbook:this.view._workbook}});
},clipBoardValue:function(){return this.clipboardElement.html();
},onPaste:function(D){var G="";
var H="";
this.clipboard.menuInvoked=D===j;
if(D){if(D.originalEvent.clipboardData&&D.originalEvent.clipboardData.getData){D.preventDefault();
var E=false;
var F=false;
if(window.DOMStringList&&D.originalEvent.clipboardData.types instanceof window.DOMStringList){E=D.originalEvent.clipboardData.types.contains("text/html");
F=D.originalEvent.clipboardData.types.contains("text/plain");
}else{E=/text\/html/.test(D.originalEvent.clipboardData.types);
F=/text\/plain/.test(D.originalEvent.clipboardData.types);
}if(E){G=D.originalEvent.clipboardData.getData("text/html");
}if(F){H=D.originalEvent.clipboardData.getData("text/plain").trim();
}}else{var I=this.clipboardElement.find("table.kendo-clipboard-"+this.clipboard._uid).detach();
this.clipboardElement.empty();
setTimeout(function(){var J=this.clipboardElement.html();
var K=window.clipboardData.getData("Text").trim();
if(!J&&!K){return;
}this.clipboard.external({html:J,plain:K});
this.clipboardElement.empty().append(I);
this._execute({command:"PasteCommand",options:{workbook:this.view._workbook}});
this.clipboard.menuInvoked=true;
}.bind(this));
return;
}}else{if(x.support.browser.msie){this.clipboardElement.focus().select();
document.execCommand("paste");
return;
}else{this.clipboard.menuInvoked=true;
}}if(!G&&!H){return;
}this.clipboard.external({html:G,plain:H});
this._execute({command:"PasteCommand",options:{workbook:this.view._workbook}});
},onCopy:function(D){this.clipboard.menuInvoked=D===j;
this._execute({command:"CopyCommand",options:{workbook:this.view._workbook}});
},scrollTop:function(){this.scroller.scrollTop=0;
},scrollLeft:function(){this.scroller.scrollLeft=0;
},scrollDown:function(D){this.scroller.scrollTop+=D;
},scrollRight:function(D){this.scroller.scrollLeft+=D;
},scrollWith:function(E,D){this.scroller.scrollTop+=D;
this.scroller.scrollLeft+=E;
},objectAt:function(E){var F=this.container.offset();
var D={left:E.pageX-F.left,top:E.pageY-F.top};
return this.view.objectAt(D.left,D.top);
},selectToLocation:function(D){var E=this.objectAt(D);
if(E.pane){this.extendSelection(E);
this.lastKnownCellLocation=D;
this.originFrame=E.pane;
}this.stopAutoScroll();
},extendSelection:function(D){this.navigator.extendSelection(D.ref,this._selectionMode,this.appendSelection);
},autoScroll:function(){var I=this._autoScrollTarget.x;
var J=this._autoScrollTarget.y;
var D=this.originFrame._grid;
var E=this.view.scroller;
var G=8;
var F=E.scrollLeft;
var H=E.scrollTop;
if(I<D.left){this.scrollRight(-G);
}if(I>D.right){this.scrollRight(G);
}if(J<D.top){this.scrollDown(-G);
}if(J>D.bottom){this.scrollDown(G);
}if(H===E.scrollTop&&F===E.scrollLeft){this.selectToLocation(this.finalLocation);
}else{this.extendSelection(this.objectAt(this.lastKnownCellLocation));
}},startAutoScroll:function(E,D){if(!this._scrollInterval){this._scrollInterval=setInterval(this.autoScroll.bind(this),50);
}this.finalLocation=D||this.lastKnownCellLocation;
this._autoScrollTarget=E;
},stopAutoScroll:function(){clearInterval(this._scrollInterval);
this._scrollInterval=null;
},openFilterMenu:function(E){var G=this.objectAt(E);
var H=this._workbook.activeSheet();
var D=H.filterColumn(G.ref);
var F=this.view.createFilterMenu(D);
F.bind("action",this.onCommandRequest.bind(this));
F.bind("action",F.close.bind(F));
F.openFor(E.target);
},onEditorChange:function(D){this._workbook.activeSheet().isInEditMode(false);
var E=this._execute({command:"EditCommand",options:{editActiveCell:true,value:D.value}});
if(E&&E.reason==="error"){D.preventDefault();
}},onEditorActivate:function(){var E=this._workbook;
var D=E.activeSheet();
D._setFormulaSelections(this.editor.highlightedRefs());
D.isInEditMode(true);
},onEditorDeactivate:function(){var D=this._workbook.activeSheet();
D.isInEditMode(false);
D._setFormulaSelections([]);
},onEditorUpdate:function(){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());
},onEditorBarFocus:function(){this.editor.activate({range:this._workbook.activeSheet()._viewActiveCell(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()});
},onEditorCellFocus:function(){this.editor.scale();
},onEditorEsc:function(){this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));
this.editor.deactivate();
this.clipboardElement.focus();
},onEditorBlur:function(D,E){if(this.editor.isFiltered()){return;
}this.editor.deactivate();
if(!this.editor.isActive()){this.clipboardElement.focus();
this.navigator.navigateInSelection(u[E]);
}},onEditorAction:function(F,D){var E=this.editor;
var G=this._workbook.activeSheet();
if(E.canInsertRef(true)){this.navigator.moveActiveCell(m[D]);
E.activeEditor().refAtPoint(G.selection()._ref);
G._setFormulaSelections(E.highlightedRefs());
F.preventDefault();
}},onEditorShiftAction:function(F,D){var E=this.editor;
var G=this._workbook.activeSheet();
if(E.canInsertRef(true)){this.navigator.modifySelection(m[D.replace("shift+","")],this.appendSelection);
E.activeEditor().refAtPoint(G.selection()._ref);
G._setFormulaSelections(E.highlightedRefs());
F.preventDefault();
}},onCommandRequest:function(D){if(D.command){this._execute(D);
}else{this._workbook.undoRedoStack[D.action]();
}},onDialogRequest:function(D){var E={pdfExport:this._workbook.options.pdf,excelExport:this._workbook.options.excel};
if(D.options){k.extend(true,D.options,E);
}else{D.options=E;
}this.view.openDialog(D.name,D.options);
}});
x.spreadsheet.Controller=r;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/view",["kendo.core","kendo.menu","spreadsheet/sheetsbar"],l);
}(function(){(function(v){if(v.support.browser.msie&&v.support.browser.version<9){return;
}var k=v.jQuery;
var q=v.spreadsheet.CellRef;
var s=".";
var y=7;
var E={view:"k-spreadsheet-view",fixedContainer:"k-spreadsheet-fixed-container",scroller:"k-spreadsheet-scroller",viewSize:"k-spreadsheet-view-size",clipboard:"k-spreadsheet-clipboard",cellEditor:"k-spreadsheet-cell-editor",barEditor:"k-spreadsheet-editor",topCorner:"k-spreadsheet-top-corner",filterHeadersWrapper:"k-filter-wrapper",filterRange:"k-filter-range",filterButton:"k-spreadsheet-filter",filterButtonActive:"k-state-active",icon:"k-icon k-font-icon",iconFilterDefault:"k-i-arrow-s",sheetsBar:"k-spreadsheet-sheets-bar",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",cellContextMenu:"k-spreadsheet-cell-context-menu",rowHeaderContextMenu:"k-spreadsheet-row-header-context-menu",colHeaderContextMenu:"k-spreadsheet-col-header-context-menu"};
var D=v.spreadsheet.messages.view={errors:{openUnsupported:"Unsupported format. Please select an .xlsx file.",shiftingNonblankCells:"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.",filterRangeContainingMerges:"Cannot create a filter within a range containing merges",sortRangeContainingMerges:"Cannot sort a range containing merges",validationError:"The value that you entered violates the validation rules set on the cell."},tabs:{home:"Home",insert:"Insert",data:"Data"}};
function A(G){var I=window.getSelection();
I.removeAllRanges();
var H=document.createRange();
H.selectNodeContents(G);
I.addRange(H);
}function o(I,H){var G=I.trs[H].children;
return G[G.length-2];
}function n(J,I){var H=J.trs[I-1];
var G=J.trs[I].children.length-1;
if(H&&G>=0){return H.children[G];
}}function p(G){return["solid",(G.size||1)+"px",G.color||"#000"].join(" ");
}function t(L,H,K,P,Y,T){if(!K&&!v.spreadsheet.draw.shouldDrawCell(H)){return;
}var R=H.left;
var V=H.top;
var aa=H.width+1;
var Q=H.height+1;
var U={};
var G=H.background;
var N=null;
if(G){N=G;
if(T){N=v.parseColor(N).toHSV();
N.v*=0.9;
N=N.toCssRgba();
}N=p({color:N});
}if(G){U.backgroundColor=G;
}if(H.color){U.color=H.color;
}if(H.fontFamily){U.fontFamily=H.fontFamily;
}if(H.underline){U.textDecoration="underline";
}if(H.italic){U.fontStyle="italic";
}if(H.textAlign){U.textAlign=H.textAlign;
}if(H.bold){U.fontWeight="bold";
}if(H.fontSize){U.fontSize=H.fontSize+"px";
}if(H.wrap===true){U.whiteSpace="pre-wrap";
U.wordBreak="break-all";
}if(H.borderLeft){U.borderLeft=p(H.borderLeft);
if(Y){Y[H.left]=true;
}}else{if(N&&Y&&!Y[H.left]){U.borderLeft=N;
}else{R++;
aa--;
}}if(H.borderTop){U.borderTop=p(H.borderTop);
if(P){P[H.top]=true;
}}else{if(N&&P&&!P[H.top]){U.borderTop=N;
}else{V++;
Q--;
}}if(H.borderRight){U.borderRight=p(H.borderRight);
if(Y){Y[H.right]=true;
}}else{if(N&&Y&&!Y[H.right]){U.borderRight=N;
}else{aa--;
}}if(H.borderBottom){U.borderBottom=p(H.borderBottom);
if(P){P[H.bottom]=true;
}}else{if(N&&P&&!P[H.bottom]){U.borderBottom=N;
}else{Q--;
}}U.left=R+"px";
U.top=V+"px";
U.width=aa+"px";
U.height=Q+"px";
var M=H.value,W=typeof M;
if(H.format&&M!==null){M=v.spreadsheet.formatting.format(M,H.format);
if(M.__dataType){W=M.__dataType;
}}else{if(M!==null&&M!==j){M=v.dom.text(M);
}}if(!U.textAlign){switch(W){case"number":case"date":case"percent":U.textAlign="right";
break;
case"boolean":U.textAlign="center";
break;
}}var J=[x.cell];
if(K){J.push(K);
}if(H.enable===false){J.push("k-state-disabled");
}if(H.merged){J.push("k-spreadsheet-merged-cell");
}var Z=H.verticalAlign||"bottom";
if(Z&&M){M=v.dom.element("div",{className:"k-vertical-align-"+Z},[M]);
}var I=M?[M]:[];
var S={style:U};
var X=H.validation;
if(X&&!X.value){I.push(v.dom.element("span",{className:"k-dirty"}));
J.push("k-dirty-cell");
S.title=X._getOptions().messageTemplate;
}S.className=J.join(" ");
var O=v.dom.element("div",S,I);
L.push(O);
return O;
}function l(N,K,H){var M={};
if(H.background){M.backgroundColor=H.background;
}if(H.color){M.color=H.color;
}if(H.fontFamily){M.fontFamily=H.fontFamily;
}if(H.underline){M.textDecoration="underline";
}if(H.italic){M.fontStyle="italic";
}if(H.textAlign){M.textAlign=H.textAlign;
}if(H.verticalAlign){M.verticalAlign=H.verticalAlign==="center"?"middle":H.verticalAlign;
}if(H.bold){M.fontWeight="bold";
}if(H.fontSize){M.fontSize=H.fontSize+"px";
}if(H.wrap===true){M.whiteSpace="pre-wrap";
M.wordBreak="break-all";
}if(H.borderRight){M.borderRight=p(H.borderRight);
}else{if(H.background){M.borderRightColor=H.background;
}}if(H.borderBottom){M.borderBottom=p(H.borderBottom);
}else{if(H.background){M.borderBottomColor=H.background;
}}var J=H.value,P=typeof J;
if(H.format&&J!==null){J=v.spreadsheet.formatting.format(J,H.format);
if(J.__dataType){P=J.__dataType;
}}if(!M.textAlign){switch(P){case"number":case"date":case"percent":M.textAlign="right";
break;
case"boolean":M.textAlign="center";
break;
}}var I=null;
if(H.enable===false){I="k-state-disabled";
}var O=N.addCell(K,J,M,I,H.validation);
var G,L;
if(H.borderLeft){L=o(N,K);
G=p(H.borderLeft);
if(L&&G){L.attr.style.borderRight=G;
}}else{if(H.background){M.borderLeftColor=H.background;
}}if(H.borderTop){L=n(N,K);
G=p(H.borderTop);
if(L&&G){L.attr.style.borderBottom=G;
}}else{if(H.background){M.borderTopColor=H.background;
}}return O;
}var u=v.Class.extend({init:function(){this.cols=[];
this.trs=[];
this._height=0;
this._width=0;
},addColumn:function(H){this._width+=H;
var G=v.dom.element("col",{style:{width:H+"px"}});
G.visible=H>0;
this.cols.push(G);
},addRow:function(H){var G=null;
G={style:{height:H+"px"}};
this._height+=H;
var I=v.dom.element("tr",G);
I.visible=H>0;
this.trs.push(I);
},addCell:function(J,M,K,H,N){if(M===null||M===j){M="";
}if(!(M instanceof v.dom.Node)){M=v.dom.text(M);
}var G=[M];
var I={style:K};
if(N&&!N.value){G.push(v.dom.element("span",{className:"k-dirty"}));
H=(H||"")+(H?" ":"")+"k-dirty-cell";
I.title=N._getOptions().messageTemplate;
}if(H){I.className=H;
}var L=v.dom.element("td",I,G);
this.trs[J].children.push(L);
return L;
},toDomTree:function(I,J,G){this.trs=this.trs.filter(function(K){return K.visible;
});
var H=0;
this.cols=this.cols.filter(function(L,K){if(!L.visible){this.trs.forEach(function(M){M.children.splice(K-H,1);
});
H++;
}return L.visible;
},this);
return v.dom.element("table",{style:{left:I+"px",top:J+"px",height:this._height+"px",width:this._width+"px"},className:G},[v.dom.element("colgroup",null,this.cols),v.dom.element("tbody",null,this.trs)]);
}});
var m='<ul class="#=classNames.cellContextMenu#"><li data-action=cut>Cut</li><li data-action=copy>Copy</li><li data-action=paste>Paste</li><li class="k-separator"></li><li data-action=merge>Merge</li><li data-action=unmerge>Unmerge</li></ul>';
var z='<ul class="#=classNames.rowHeaderContextMenu#"><li data-action=cut>Cut</li><li data-action=copy>Copy</li><li data-action=paste>Paste</li><li class="k-separator"></li><li data-action="delete-row">Delete</li><li data-action="hide-row">Hide</li><li data-action="unhide-row">Unhide</li></ul>';
var r='<ul class="#=classNames.colHeaderContextMenu#"><li data-action=cut>Cut</li><li data-action=copy>Copy</li><li data-action=paste>Paste</li><li class="k-separator"></li><li data-action="delete-column">Delete</li><li data-action="hide-column">Hide</li><li data-action="unhide-column">Unhide</li></ul>';
v.spreadsheet.ContextMenu=v.ui.ContextMenu;
var C=v.template('<div class="#=classNames.view#"><div class="#=classNames.fixedContainer#"></div><div class="#=classNames.scroller#"><div class="#=classNames.viewSize#"></div></div><div tabindex="0" class="#=classNames.clipboard#" contenteditable=true></div><div class="#=classNames.cellEditor#"></div></div><div class="#=classNames.sheetsBar#"></div>'+m+z+r);
function F(I,H,G){return I>=H&&I<=G;
}var B=v.Class.extend({init:function(I,J){var G=B.classNames;
this.element=I;
this.options=k.extend(true,{},this.options,J);
this._chrome();
this._dialogs=[];
I.append(C({classNames:G}));
this._formulaInput();
this.wrapper=I.find(s+G.view);
this.container=I.find(s+G.fixedContainer)[0];
this.scroller=I.find(s+G.scroller)[0];
this.clipboard=I.find(s+G.clipboard);
this.viewSize=k(this.scroller.firstChild);
this.tree=new v.dom.Tree(this.container);
this.clipboardContents=new v.dom.Tree(this.clipboard[0]);
this.editor=new v.spreadsheet.SheetEditor(this);
this._sheetsbar();
var H={target:I,animation:false,showOn:"never"};
this.cellContextMenu=new v.spreadsheet.ContextMenu(I.find(s+G.cellContextMenu),H);
this.colHeaderContextMenu=new v.spreadsheet.ContextMenu(I.find(s+G.colHeaderContextMenu),H);
this.rowHeaderContextMenu=new v.spreadsheet.ContextMenu(I.find(s+G.rowHeaderContextMenu),H);
var K=v.support.scrollbar();
k(this.container).css({width:this.wrapper[0].clientWidth-K,height:this.wrapper[0].clientHeight-K});
},_resize:function(){var I=this.tabstrip?this.tabstrip.element.outerHeight():0;
var G=this.formulaBar?this.formulaBar.element.outerHeight():0;
var H=this.sheetsbar?this.sheetsbar.element.outerHeight():0;
this.wrapper.height(this.element.height()-(I+G+H));
if(this.tabstrip){this.tabstrip.quickAccessAdjust();
}},_chrome:function(){var G=k("<div />").prependTo(this.element);
this.formulaBar=new v.spreadsheet.FormulaBar(G);
if(this.options.toolbar){this._tabstrip();
}},_formulaInput:function(){var G=this.element.find(s+B.classNames.cellEditor);
this.formulaInput=new v.spreadsheet.FormulaInput(G,{autoScale:true});
},_sheetsbar:function(){if(this.options.sheetsbar){this.sheetsbar=new v.spreadsheet.SheetsBar(this.element.find(s+B.classNames.sheetsBar),k.extend(true,{},this.options.sheetsbar));
}},_tabstrip:function(){var G=D.tabs;
var I=k.extend(true,{home:true,insert:true,data:true},this.options.toolbar);
var J=[];
if(this.tabstrip){this.tabstrip.destroy();
this.element.children(".k-tabstrip").remove();
}for(var H in I){if(I[H]===true||I[H] instanceof Array){J.push({id:H,text:G[H],content:""});
}}this.tabstrip=new v.spreadsheet.TabStrip(k("<div />").prependTo(this.element),{animation:false,dataTextField:"text",dataContentField:"content",dataSource:J,toolbarOptions:I,view:this});
this.tabstrip.select(0);
},_executeCommand:function(G){this._workbook.execute(G);
},workbook:function(G){this._workbook=G;
},sheet:function(G){this._sheet=G;
},activeCellRectangle:function(){return this.cellRectangle(this._sheet._viewActiveCell());
},_rectangle:function(G,H){return G._grid.boundingRectangle(H.toRangeRef());
},isColumnResizer:function(L,H,J){var I=this._rectangle(H,J);
L-=this._sheet._grid._headerWidth;
var G=y/2;
var K=I.right-this.scroller.scrollLeft;
return K-G<=L&&L<=K+G;
},isRowResizer:function(L,I,K){var J=this._rectangle(I,K);
L-=this._sheet._grid._headerHeight;
var H=y/2;
var G=J.bottom-this.scroller.scrollTop;
return G-H<=L&&L<=G+H;
},isFilterIcon:function(J,K,G,H){var I=false;
J-=this._sheet._grid._headerWidth-this.scroller.scrollLeft;
K-=this._sheet._grid._headerHeight-this.scroller.scrollTop;
this._sheet.forEachFilterHeader(H,function(M){var L=this._rectangle(G,M);
I=I||G.filterIconRect(L).intersects(J,K);
}.bind(this));
return I;
},isAutoFill:function(J,K,G){var I=this._sheet.select();
if(I.size>1){return false;
}J-=this._sheet._grid._headerWidth;
K-=this._sheet._grid._headerHeight;
if(!G._grid.columns.frozen){J+=this.scroller.scrollLeft;
}if(!G._grid.rows.frozen){K+=this.scroller.scrollTop;
}var H=this._rectangle(G,I);
return Math.abs(H.right-J)<8&&Math.abs(H.bottom-K)<8;
},objectAt:function(N,O){var H=this._sheet._grid;
var I,J;
if(N<0||O<0||N>this.scroller.clientWidth||O>this.scroller.clientHeight){I={type:"outside"};
}else{if(N<H._headerWidth&&O<H._headerHeight){I={type:"topcorner"};
}else{J=this.paneAt(N,O);
var L=J._grid.rows.index(O,this.scroller.scrollTop);
var G=J._grid.columns.index(N,this.scroller.scrollLeft);
var M="cell";
var K=new q(L,G);
if(this.isAutoFill(N,O,J)){M="autofill";
}else{if(this.isFilterIcon(N,O,J,K)){M="filtericon";
}else{if(N<H._headerWidth){K=new q(L,-Infinity);
M=this.isRowResizer(O,J,K)?"rowresizehandle":"rowheader";
}else{if(O<H._headerHeight){K=new q(-Infinity,G);
M=this.isColumnResizer(N,J,K)?"columnresizehandle":"columnheader";
}}}}I={type:M,ref:K};
}}I.pane=J;
I.x=N;
I.y=O;
return I;
},paneAt:function(H,I){return this.panes.filter(function G(K){var J=K._grid;
return F(I,J.top,J.bottom)&&F(H,J.left,J.right);
})[0];
},containingPane:function(G){return this.panes.filter(function(H){if(H._grid.contains(G)){return true;
}return false;
})[0];
},cellRectangle:function(G){var I=this.containingPane(G)._grid;
var H=this._sheet._grid.rectangle(G);
return H.offset(I.headerWidth-this.scroller.scrollLeft,I.headerHeight-this.scroller.scrollTop);
},refresh:function(I){var J=this._sheet;
if(this.tabstrip){this.tabstrip.refreshTools(J.range(J.activeCell()));
}if(I.sheetSelection&&this.sheetsbar){this.sheetsbar.renderSheets(this._workbook.sheets(),this._workbook.sheetIndex(this._sheet));
}this._resize();
this.viewSize[0].style.height=J._grid.totalHeight()+"px";
this.viewSize[0].style.width=J._grid.totalWidth()+"px";
if(I.layout){var G=J.frozenColumns();
var H=J.frozenRows();
this.panes=[this._pane(H,G)];
if(G>0){this.panes.push(this._pane(H,0,null,G));
}if(H>0){this.panes.push(this._pane(0,G,H,null));
}if(H>0&&G>0){this.panes.push(this._pane(0,0,H,G));
}}if(I.filter){this._destroyFilterMenu();
}if(I.activeCell){this._focus=J.activeCell().toRangeRef();
}},createFilterMenu:function(G){if(this._filterMenu&&this._filterMenu.options.column==G){return this._filterMenu;
}this._destroyFilterMenu();
var M=this._sheet;
var L=M.filter().ref;
var K=new v.spreadsheet.Range(L,M);
var H=k("<div />").appendTo(this.element);
var J={column:G,range:K};
var I=new v.spreadsheet.FilterMenu(H,J);
this._filterMenu=I;
return I;
},selectClipBoardContents:function(){this.clipboard.focus();
A(this.clipboard[0]);
},scrollIntoView:function(H){var M=false;
var L=this.containingPane(H)._grid;
var G=L.scrollBoundaries(H);
var I=this.scroller;
var K=L.rows.frozen?0:I.scrollTop;
var J=L.columns.frozen?0:I.scrollLeft;
if(G.top<K){M=true;
I.scrollTop=G.scrollTop;
}if(G.bottom>K){M=true;
I.scrollTop=G.scrollBottom;
}if(G.left<J){M=true;
I.scrollLeft=G.scrollLeft;
}if(G.right>J){M=true;
I.scrollLeft=G.scrollRight;
}return M;
},_destroyDialog:function(){this._dialogs.pop();
},openDialog:function(H,I){var L=this._sheet;
var K=L.activeCell();
var J=new v.spreadsheet.Range(K,L);
var G=v.spreadsheet.dialogs.create(H,I);
if(G){G.bind("action",this._executeCommand.bind(this));
G.bind("deactivate",this._destroyDialog.bind(this));
this._dialogs.push(G);
G.open(J);
return G;
}},showError:function(H){var G=D.errors;
this.openDialog("message",{title:H.title||"Error",text:H.body?H.body:G[H.type],activate:function(){this.dialog().element.find(".k-button").focus();
},close:function(){this.editor.focusLastActive();
}.bind(this)});
},destroy:function(){this._dialogs.forEach(function(G){G.destroy();
});
this.cellContextMenu.destroy();
this.rowHeaderContextMenu.destroy();
this.colHeaderContextMenu.destroy();
if(this.tabstrip){this.tabstrip.destroy();
}this._destroyFilterMenu();
},_destroyFilterMenu:function(){if(this._filterMenu){this._filterMenu.destroy();
this._filterMenu=j;
this._filterMenuColumn=j;
}},render:function(){if(!this.element.is(":visible")){return;
}var M=this._sheet;
var G=M.focus();
if(G&&this.scrollIntoView(G)){return;
}var H=M._grid;
var L=this.scroller.scrollTop;
var K=this.scroller.scrollLeft;
if(L<0){L=0;
}if(K<0){K=0;
}var J=this.panes.map(function(O){return O.render(K,L);
},this);
var I=[];
I=Array.prototype.concat.apply(I,J);
var N=v.dom.element("div",{style:{width:H._headerWidth+"px",height:H._headerHeight+"px"},className:B.classNames.topCorner});
I.push(N);
if(M.resizeHandlePosition()&&M.resizeHintPosition()){I.push(this.renderResizeHint());
}this.tree.render(I);
if(this.editor.isActive()){this.editor.toggleTooltip(this.activeCellRectangle());
}else{if(!M.selectionInProgress()&&!M.resizingInProgress()&&!M.isInEditMode()){this.renderClipboardContents();
}}},renderResizeHint:function(){var J=this._sheet;
var I=J.resizeHandlePosition();
var H=I.col!==-Infinity;
var K;
if(H){K={height:this.scroller.clientHeight+"px",width:y+"px",left:J.resizeHintPosition().x+"px",top:"0px"};
}else{K={height:y+"px",width:this.scroller.clientWidth+"px",top:J.resizeHintPosition().y+"px",left:"0px"};
}var G=w.classNames;
return v.dom.element("div",{className:G.resizeHint+(!H?" "+G.resizeHintVertical:""),style:K},[v.dom.element("div",{className:G.resizeHintHandle}),v.dom.element("div",{className:G.resizeHintMarker})]);
},renderClipboardContents:function(){var L=this._sheet;
var G=L._grid;
var J=L.select().toRangeRef();
var M=this._workbook.clipboard().canCopy();
if(M.canCopy===false&&M.multiSelection){this.clipboardContents.render([]);
this.selectClipBoardContents();
return;
}J=L.trim(J);
var N=new u();
var K=G.rangeDimensions(J);
K.rows.forEach(function(O){N.addRow(O);
});
K.columns.forEach(function(O){N.addColumn(O);
});
var H={};
var I={};
L.forEachMergedCell(J,function(O){var P=O.topLeft;
G.forEach(O,function(Q){if(P.eq(Q)){H[Q.print()]=O;
}else{I[Q.print()]=true;
}});
});
L.forEach(J,function(S,P,O){var Q=new q(S,P).print();
if(!I[Q]){var T=l(N,S-J.topLeft.row,O);
var R=H[Q];
if(R){T.attr.colspan=R.width();
T.attr.rowspan=R.height();
}}});
this.clipboardContents.render([N.toDomTree(0,0,"kendo-clipboard-"+this._workbook.clipboard()._uid)]);
this.selectClipBoardContents();
},_pane:function(J,G,K,H){var I=new w(this._sheet,this._sheet._grid.pane({row:J,column:G,rowCount:K,columnCount:H}));
I.refresh(this.scroller.clientWidth,this.scroller.clientHeight);
return I;
}});
var x={cell:"k-spreadsheet-cell",vaxis:"k-spreadsheet-vaxis",haxis:"k-spreadsheet-haxis",rowHeader:"k-spreadsheet-row-header",columnHeader:"k-spreadsheet-column-header",pane:"k-spreadsheet-pane",data:"k-spreadsheet-data",mergedCell:"k-spreadsheet-merged-cell",mergedCellsWrapper:"k-merged-cells-wrapper",activeCell:"k-spreadsheet-active-cell",selection:"k-spreadsheet-selection",selectionWrapper:"k-selection-wrapper",autoFillWrapper:"k-auto-fill-wrapper",single:"k-single",top:"k-top",right:"k-right",bottom:"k-bottom",left:"k-left",resizeHandle:"k-resize-handle",resizeHint:"k-resize-hint",resizeHintHandle:"k-resize-hint-handle",resizeHintMarker:"k-resize-hint-marker",resizeHintVertical:"k-resize-hint-vertical",selectionHighlight:"k-spreadsheet-selection-highlight",series:["k-series-a","k-series-b","k-series-c","k-series-d","k-series-e","k-series-f"]};
var w=v.Class.extend({init:function(H,G){this._sheet=H;
this._grid=G;
},refresh:function(H,G){this._grid.refresh(H,G);
},isVisible:function(H,I,G){return this._grid.view(H,I).ref.intersects(G);
},render:function(O,P){var H=w.classNames;
var Q=this._sheet;
var J=this._grid;
var R=J.view(O,P);
this._currentView=R;
this._currentRect=this._rectangle(R.ref);
this._selectedHeaders=Q.selectedHeaders();
var G=[];
G.push(this.renderData());
G.push(this.renderSelection());
G.push(this.renderAutoFill());
G.push(this.renderEditorSelection());
G.push(this.renderFilterHeaders());
if(J.hasRowHeader){var N=v.dom.element("div",{className:H.rowHeader,style:{width:J.headerWidth+"px",top:R.rowOffset+"px"}});
G.push(N);
Q.forEach(R.ref.leftColumn(),function(T){if(!Q.isHiddenRow(T)){var U=T+1,S=Q.rowHeight(T);
N.children.push(v.dom.element("div",{className:this.headerClassName(T,"row"),style:{width:J.headerWidth+"px",height:S+"px"}},[v.dom.element("div",{className:"k-vertical-align-center"},[v.dom.text(U+"")])]));
}}.bind(this));
}if(J.hasColumnHeader){var I=v.dom.element("div",{className:H.columnHeader,style:{top:"0px",left:R.columnOffset+"px",width:this._currentRect.width+"px",height:J.headerHeight+"px"}});
G.push(I);
var K=0;
Q.forEach(R.ref.topRow(),function(T,S){if(!Q.isHiddenColumn(S)){var U=v.spreadsheet.Ref.display(null,Infinity,S),V=Q.columnWidth(S);
I.children.push(v.dom.element("div",{className:this.headerClassName(S,"col"),style:{position:"absolute",left:K+"px",width:V+"px",height:J.headerHeight+"px"}},[v.dom.element("div",{className:"k-vertical-align-center"},[v.dom.text(U+"")])]));
K+=V;
}}.bind(this));
}if(Q.resizeHandlePosition()&&(J.hasColumnHeader||J.hasRowHeader)){var M=Q._grid.normalize(Q.resizeHandlePosition());
if(R.ref.intersects(M)){if(!Q.resizeHintPosition()){G.push(this.renderResizeHandler());
}}}var L=[H.pane];
if(J.hasColumnHeader){L.push(H.top);
}if(J.hasRowHeader){L.push(H.left);
}return v.dom.element("div",{style:J.style,className:L.join(" ")},G);
},headerClassName:function(I,L){var K=this._selectedHeaders;
var J;
var G;
if(L==="row"){J=K.rows[I];
G=K.allRows;
}else{J=K.cols[I];
G=K.allCols;
}var H=J||(K.all?"full":G?"partial":"none");
if(H){H="k-selection-"+H;
}return H;
},renderData:function(){var N=this._currentView;
var G=v.dom.element("div",{className:w.classNames.data,style:{position:"relative",left:N.columnOffset+"px",top:N.rowOffset+"px"}});
var K=this._currentRect;
var I=v.spreadsheet.draw.doLayout(this._sheet,N.ref,{forScreen:true}),J;
var L=this._sheet.options.showGridLines;
if(L){J=null;
I.xCoords.forEach(function(O){if(O!==J){J=O;
G.children.push(v.dom.element("div",{className:x.vaxis,style:{left:O+"px",height:K.height+"px"}}));
}});
J=null;
I.yCoords.forEach(function(O){if(O!==J){J=O;
G.children.push(v.dom.element("div",{className:x.haxis,style:{top:O+"px",width:K.width+"px"}}));
}});
}var M={},H={};
I.cells.forEach(function(O){var P=H[O.col]||(H[O.col]={});
var Q=M[O.row]||(M[O.row]={});
t(G.children,O,null,P,Q,L);
});
return G;
},renderResizeHandler:function(){var I=this._sheet;
var H=I.resizeHandlePosition();
var G=this._rectangle(H);
var J;
if(H.col!==-Infinity){J={height:this._grid.headerHeight+"px",width:y+"px",left:G.right-y/2+"px",top:"0px"};
}else{J={height:y+"px",width:this._grid.headerWidth+"px",top:G.bottom-y/2+"px",left:"0px"};
}return v.dom.element("div",{className:w.classNames.resizeHandle,style:J});
},filterIconRect:function(I){var H=16;
var G=3;
return new v.spreadsheet.Rectangle(I.right-H-G,I.top+G,H,H);
},renderFilterHeaders:function(){var L=this._sheet;
var G=[];
var H=B.classNames;
var I=L.filter();
function K(M){return v.dom.element("span",{className:H.icon+" "+M});
}function J(O,R,Q){var S={left:R.left+"px",top:R.top+"px"};
var P=I&&I.columns.some(function(T){return T.index===Q;
});
var N=O.filterButton;
if(P){N+=" "+O.filterButtonActive;
}var M=v.dom.element("span",{className:N,style:S},[K(O.iconFilterDefault)]);
return M;
}if(I){this._addDiv(G,I.ref,H.filterRange);
}L.forEachFilterHeader(this._currentView.ref,function(Q){var P=this._rectangle(Q);
var O=this.filterIconRect(P);
var N=this._sheet.filterColumn(Q);
var M=J(H,O,N);
G.push(M);
}.bind(this));
return v.dom.element("div",{className:H.filterHeadersWrapper},G);
},renderEditorSelection:function(){var G=w.classNames;
var I=this._sheet;
var H=[];
I._formulaSelections.forEach(function(J){var K=J.ref;
if(K===v.spreadsheet.NULLREF){return;
}this._addDiv(H,K,G.selectionHighlight+" "+J.colorClass);
}.bind(this));
return v.dom.element("div",{className:G.selectionWrapper},H);
},renderSelection:function(){var J=w.classNames;
var M=[];
var H=[J.activeCell];
var L=[J.selection];
var N=this._sheet;
var G=N.activeCell().toRangeRef();
var I=this._activeFormulaColor();
var K=N.select();
H=H.concat(I,this._directionClasses(G));
L=L.concat(I);
if(N.singleCellSelection()){H.push(J.single);
}if(K.size()===1){L.push("k-single-selection");
}if(this._sheet.autoFillPunch()){L.push("k-dim-auto-fill-handle");
}K.forEach(function(O){if(O!==v.spreadsheet.NULLREF){this._addDiv(M,O,L.join(" "));
}}.bind(this));
this._addTable(M,G,H.join(" "));
return v.dom.element("div",{className:J.selectionWrapper},M);
},renderAutoFill:function(){var G=[];
if(this._sheet.autoFillInProgress()){var H=this._sheet.autoFillRef();
var L=this._sheet.autoFillPunch();
var J=this._sheet._autoFillDirection;
this._addDiv(G,H,"k-auto-fill");
if(L){this._addDiv(G,L,"k-auto-fill-punch");
}else{if(J!==j){var N,I;
switch(J){case 0:N=H.bottomRight;
I="k-auto-fill-br-hint";
break;
case 1:N=H.bottomRight;
I="k-auto-fill-br-hint";
break;
case 2:N=new q(H.topLeft.row,H.bottomRight.col);
I="k-auto-fill-tr-hint";
break;
case 3:N=new q(H.bottomRight.row,H.topLeft.col);
I="k-auto-fill-bl-hint";
break;
}var K=v.dom.element("span",{className:"k-tooltip"},[v.dom.text(this._sheet._autoFillHint)]);
var M=this._addDiv(G,N,I);
if(M){M.children.push(K);
}}}}return v.dom.element("div",{className:w.classNames.autoFillWrapper},G);
},_addDiv:function(H,J,G){var K=this._currentView,I;
if(K.ref.intersects(J)){I=this._rectangle(J).resize(1,1).toDiv(G);
H.push(I);
}return I;
},_addTable:function(H,I,G){var J=this._sheet;
var K=this._currentView;
if(K.ref.intersects(I)){J.forEach(I.collapse(),function(O,M,L){var N=this._rectangle(I);
L.left=N.left;
L.top=N.top;
L.width=N.width;
L.height=N.height;
t(H,L,G,null,null,true);
}.bind(this));
}},_activeFormulaColor:function(){var G;
var H=[];
if(this._sheet.isInEditMode()){G=this._sheet._formulaSelections.filter(function(I){return I.active&&I.type=="ref";
})[0];
if(G){H.push(G.colorClass);
}}return H;
},_directionClasses:function(G){var H=[];
var I=w.classNames;
var J=this._currentView.ref;
if(!G.move(0,-1).intersects(J)){H.push(I.left);
}if(!G.move(-1,0).intersects(J)){H.push(I.top);
}if(!G.move(0,1).intersects(J)){H.push(I.right);
}if(!G.move(1,0).intersects(J)){H.push(I.bottom);
}return H;
},_rectangle:function(G){return this._grid.boundingRectangle(G.toRangeRef()).offset(-this._currentView.mergedCellLeft,-this._currentView.mergedCellTop);
}});
v.spreadsheet.View=B;
v.spreadsheet.Pane=w;
v.spreadsheet.drawCell=t;
k.extend(true,B,{classNames:E});
k.extend(true,w,{classNames:x});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/grid",["kendo.core","spreadsheet/references"],l);
}(function(){(function(m){if(m.support.browser.msie&&m.support.browser.version<9){return;
}var k=m.spreadsheet.CellRef;
var o=m.spreadsheet.RangeRef;
var q=m.spreadsheet.UnionRef;
var p=m.Class.extend({init:function(s,t,u,r){this.left=s;
this.width=u;
this.right=s+u;
this.top=t;
this.height=r;
this.bottom=t+r;
},offset:function(r,s){return new p(this.left+r,this.top+s,this.width,this.height);
},resize:function(s,r){return new p(this.left,this.top,this.width+s,this.height+r);
},intersects:function(r,s){return this.left<r&&r<this.left+this.width&&this.top<s&&s<this.top+this.height;
},toDiv:function(r){return m.dom.element("div",{className:r,style:{width:this.width+"px",height:this.height+"px",top:this.top+"px",left:this.left+"px"}});
}});
var l=m.Class.extend({init:function(w,s,v,r,t,u){this.rowCount=v;
this.columnCount=r;
this._columns=s;
this._rows=w;
this._headerHeight=t;
this._headerWidth=u;
},isAxis:function(s){s=s.toRangeRef();
var t=s.topLeft;
var r=s.bottomRight;
return t.row===0&&r.row===this.rowCount-1||t.col===0&&r.col===this.columnCount-1;
},width:function(s,r){return this._columns.sum(s,r);
},height:function(s,r){return this._rows.sum(s,r);
},totalHeight:function(){return this._rows.total+this._headerHeight;
},totalWidth:function(){return this._columns.total+this._headerWidth;
},index:function(s,r){return r*this.rowCount+s;
},cellRef:function(r){return new k(r%this.rowCount,r/this.rowCount>>0);
},rowRef:function(r){return new o(new k(r,0),new k(r,this.columnCount-1));
},colRef:function(r){return new o(new k(0,r),new k(this.rowCount-1,r));
},cellRefIndex:function(r){return this.index(r.row,r.col);
},normalize:function(s){if(s instanceof o){return new o(this.normalize(s.topLeft),this.normalize(s.bottomRight)).setSheet(s.sheet,s.hasSheet());
}if(s instanceof q){return s.map(function(t){return this.normalize(t);
},this);
}var r=s.clone();
r.col=Math.max(0,Math.min(this.columnCount-1,s.col));
r.row=Math.max(0,Math.min(this.rowCount-1,s.row));
return r;
},rectangle:function(s){var t=this.normalize(s.topLeft);
var r=this.normalize(s.bottomRight);
return new p(this.width(0,t.col-1),this.height(0,t.row-1),this.width(t.col,r.col),this.height(t.row,r.row));
},pane:function(r){return new n(new m.spreadsheet.PaneAxis(this._rows,r.row,r.rowCount,this._headerHeight),new m.spreadsheet.PaneAxis(this._columns,r.column,r.columnCount,this._headerWidth),this);
},rangeDimensions:function(r){return{rows:this._rows.values.iterator(r.topLeft.row,r.bottomRight.row),columns:this._columns.values.iterator(r.topLeft.col,r.bottomRight.col)};
},forEach:function(u,s){var w=this.normalize(u.topLeft);
var r=this.normalize(u.bottomRight);
for(var t=w.col;
t<=r.col;
t++){for(var v=w.row;
v<=r.row;
v++){s(new k(v,t));
}}},trim:function(y,x){var A=y.topLeft;
var r=y.bottomRight;
var t=A.row;
var s=A.col;
for(var v=A.col;
v<=r.col;
v++){var z=this.index(A.row,v);
var w=this.index(r.row,v);
var B=x.tree.intersecting(z,w);
if(B.length){var u=this.cellRef(B[B.length-1].end);
t=Math.max(t,u.row);
s=v;
}}return new o(y.topLeft,new k(Math.min(t,y.bottomRight.row),s));
}});
var n=m.Class.extend({init:function(t,r,s){this.rows=t;
this.columns=r;
this._grid=s;
this.headerHeight=t.headerSize;
this.headerWidth=r.headerSize;
this.hasRowHeader=r.hasHeader;
this.hasColumnHeader=t.hasHeader;
},refresh:function(s,r){this.columns.viewSize(s);
this.rows.viewSize(r);
var t=this.columns.paneSegment();
var u=this.rows.paneSegment();
this.left=t.offset;
this.top=u.offset;
this.right=t.offset+t.length;
this.bottom=u.offset+u.length;
this.style={top:u.offset+"px",left:t.offset+"px",height:u.length+"px",width:t.length+"px"};
},view:function(s,u){var t=this.rows.visible(u);
var r=this.columns.visible(s);
return{rows:t,columns:r,rowOffset:t.offset,columnOffset:r.offset,mergedCellLeft:r.start,mergedCellTop:t.start,ref:new o(new k(t.values.start,r.values.start),new k(t.values.end,r.values.end))};
},contains:function(r){return this.rows.contains(r.topLeft.row,r.bottomRight.row)&&this.columns.contains(r.topLeft.col,r.bottomRight.col);
},index:function(s,r){return this._grid.index(s,r);
},boundingRectangle:function(r){return this._grid.rectangle(r);
},cellRefIndex:function(r){return this._grid.cellRefIndex(r);
},scrollBoundaries:function(s){var u=this.boundingRectangle(s);
var r={top:Math.max(0,u.top-this.top+(this.hasColumnHeader?0:this.headerHeight)),left:Math.max(0,u.left-this.left+(this.hasRowHeader?0:this.headerWidth)),right:u.right-this.columns._viewSize+this.headerWidth,bottom:u.bottom-this.rows._viewSize+this.headerHeight};
var v=this.columns.defaultValue/2;
var t=this.rows.defaultValue/2;
r.scrollTop=r.top-t;
r.scrollBottom=r.bottom+t;
r.scrollLeft=r.left-v;
r.scrollRight=r.right+v;
return r;
}});
m.spreadsheet.Grid=l;
m.spreadsheet.PaneGrid=n;
m.spreadsheet.Rectangle=p;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/axis",["kendo.core"],l);
}(function(){(function(l){if(l.support.browser.msie&&l.support.browser.version<9){return;
}var k=l.Class.extend({init:function(n,o){this._value=o;
this._count=n;
this.values=new l.spreadsheet.RangeList(0,n-1,o);
this._hidden=new l.spreadsheet.RangeList(0,n-1,0);
this.scrollBarSize=l.support.scrollbar();
this._refresh();
},toJSON:function(n,s){var u=[];
var q=this.values.iterator(0,this._count-1);
for(var o=0;
o<this._count;
o++){var t=q.at(o);
if(t===this._value){continue;
}var r=s[o];
if(r===j){r=u.length;
var p={index:o};
p[n]=t;
u.push(p);
s[o]=r;
}}return u;
},fromJSON:function(n,r){for(var o=0;
o<r.length;
o++){var q=r[o][n];
var p=r[o].index;
if(p===j){p=o;
}this.value(p,p,q);
}},hide:function(n){if(!this.hidden(n)){var o=this.value(n,n);
this._hidden.value(n,n,o);
this.value(n,n,0);
}},hidden:function(n){return this._hidden.value(n,n)!==0;
},includesHidden:function(o,n){return this._hidden.intersecting(o,n).length>1;
},nextVisible:function(o,p){var n=this._count-1;
if(o===n){return p?o+1:o;
}o+=1;
var q=this._hidden.intersecting(o,o)[0];
if(q.value!==0){if(q.end===n){return o-1;
}else{return q.end+1;
}}else{return o;
}},nextPage:function(n,o){return this.index(this.sum(0,n-1)+o);
},prevPage:function(n,o){return this.index(this.sum(0,n)-o);
},firstVisible:function(){var n=this._hidden.first();
if(n.value===0){return 0;
}else{return n.end+1;
}},lastVisible:function(){var n=this._hidden.last();
if(n.value===0){return this._count-1;
}else{return n.start-1;
}},prevVisible:function(n,o){if(n===0){return o?-1:0;
}n-=1;
var p=this._hidden.intersecting(n,n)[0];
if(p.value!==0){if(p.start===0){return n+1;
}else{return p.start-1;
}}else{return n;
}},unhide:function(n){if(this.hidden(n)){var o=this._hidden.value(n,n);
this._hidden.value(n,n,0);
this.value(n,n,o);
}},value:function(o,n,p){if(p!==j){this.values.value(o,n,p);
this._refresh();
}else{return this.values.iterator(o,n).at(0);
}},sum:function(p,n){var r=this.values.iterator(p,n);
var q=0;
for(var o=p;
o<=n;
o++){q+=r.at(o);
}return q;
},visible:function(u,n){var x=null;
var q=null;
var r=false;
if(n>=this.total+this.scrollBarSize){r=true;
}var t=this._pixelValues.intersecting(u,n);
x=t[0];
q=t[t.length-1];
var w=u-x.start;
var v=(w/x.value.value>>0)+x.value.start;
var s=w-(v-x.value.start)*x.value.value;
var p=n-q.start;
var o=(p/q.value.value>>0)+q.value.start;
if(o>q.value.end){o=q.value.end;
}if(r){s+=q.value.value-(p-(o-q.value.start)*q.value.value);
}s=Math.min(-s,0);
return{values:this.values.iterator(v,o),offset:s};
},index:function(q){var o=0;
var p=this.values.iterator(0,this._count-1);
var n=p.at(0);
while(n<q&&o<this._count-1){n+=p.at(++o);
}return o;
},_refresh:function(){var n=0;
this._pixelValues=this.values.map(function(p){var q=n;
n+=(p.end-p.start+1)*p.value;
var o=n-1;
return new l.spreadsheet.ValueRange(q,o,p);
});
this.total=n;
},getState:function(){return{values:this.values.getState(),hidden:this._hidden.getState()};
},setState:function(n){this.values.setState(n.values);
this._hidden.setState(n.hidden);
this._refresh();
}});
var m=l.Class.extend({init:function(n,q,o,p){this._axis=n;
this._start=q;
this._count=o;
this.hasHeader=q===0;
this.headerSize=p;
this.defaultValue=n._value;
this.frozen=o>0;
},viewSize:function(n){this._viewSize=n;
},sum:function(o,n){return this._axis.sum(o,n-1);
},start:function(){return this.sum(0,this._start);
},size:function(){return this.sum(this._start,this._start+this._count);
},index:function(o,n){return this._axis.index(o+(this.frozen?0:n)-this.headerSize);
},paneSegment:function(){var o=this.start();
var n;
if(!this.hasHeader){o+=this.headerSize;
}if(this.frozen){n=this.size();
if(this.hasHeader){n+=this.headerSize;
}else{n-=this.headerSize;
}}else{n=this._viewSize-o;
}return{offset:o,length:n};
},visible:function(n){var q=this.start();
var p;
if(this.frozen){p=this.size();
if(!this.hasHeader){p-=this.headerSize;
}}else{p=this._viewSize-q-this.headerSize;
q+=n;
}var o=this._axis.visible(q,q+p-1);
if(this.frozen){o.offset=0;
}o.start=q;
if(this.hasHeader){o.offset+=this.headerSize;
o.start-=this.headerSize;
}return o;
},contains:function(o,n){if(this.frozen){if(o>this._start+this._count){return false;
}if(n<this._start){return false;
}return true;
}else{return n>=this._start;
}}});
l.spreadsheet.Axis=k;
l.spreadsheet.PaneAxis=m;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/filter",["kendo.core","kendo.data"],l);
}(function(){(function(l){if(l.support.browser.msie&&l.support.browser.version<9){return;
}var k=l.spreadsheet.Filter=l.Class.extend({prepare:function(){},value:function(q){return q.value;
},matches:function(){throw new Error("The 'matches' method is not implemented.");
},toJSON:function(){throw new Error("The 'toJSON' method is not implemented.");
}});
k.create=function(s){var r=s.filter;
if(!r){throw new Error("Filter type not specified.");
}var q=l.spreadsheet[r.charAt(0).toUpperCase()+r.substring(1)+"Filter"];
if(!q){throw new Error("Filter type not recognized.");
}return new q(s);
};
l.spreadsheet.ValueFilter=k.extend({_values:[],_dates:[],_blanks:false,init:function(q){if(q.values!==j){this._values=q.values;
}if(q.blanks!==j){this._blanks=q.blanks;
}if(q.dates!==j){this._dates=q.dates;
}},value:function(q){var s=q.value;
if(this._dates.length>0&&q.format&&typeof s==="number"){var r=l.spreadsheet.formatting.type(s,q.format);
if(r==="date"){s=l.spreadsheet.numberToDate(s);
}}return s;
},matches:function(q){if(q===null||q===j){return this._blanks;
}if(q instanceof Date){return this._dates.some(function(r){return r.year===q.getFullYear()&&(r.month===j||r.month===q.getMonth())&&(r.day===j||r.day===q.getDate())&&(r.hours===j||r.hours===q.getHours())&&(r.minutes===j||r.minutes===q.getMinutes())&&(r.seconds===j||r.seconds===q.getSeconds());
});
}return this._values.indexOf(q)>=0;
},toJSON:function(){return{filter:"value",values:this._values.slice(0)};
}});
l.spreadsheet.CustomFilter=k.extend({_logic:"and",init:function(r){if(r.logic!==j){this._logic=r.logic;
}if(r.criteria===j){throw new Error("Must specify criteria.");
}this._criteria=r.criteria;
var q=l.data.Query.filterExpr({logic:this._logic,filters:this._criteria}).expression;
this._matches=new Function("d","return "+q);
},matches:function(q){if(q===null){return false;
}return this._matches(q);
},value:function(q){var t=q.value;
var s=this._criteria[0].value;
var r=s instanceof Date?"date":typeof s;
var u=typeof t;
if(q.format){u=l.spreadsheet.formatting.type(t,q.format);
}if(u!=r){if(r=="string"){if(q.format){t=l.spreadsheet.formatting.text(t,q.format);
}t=t+"";
}}else{if(u=="date"){t=l.spreadsheet.numberToDate(t);
}}return t;
},toJSON:function(){return{filter:"custom",logic:this._logic,criteria:this._criteria};
}});
l.spreadsheet.TopFilter=k.extend({init:function(q){this._type=q.type;
this._value=q.value;
this._values=[];
},prepare:function(q){var s=q.map(this.value).sort().filter(function(v,u,t){return u===0||v!==t[u-1];
});
if(this._type==="topNumber"||this._type=="topPercent"){s.sort(function(t,u){return u-t;
});
}else{s.sort(function(t,u){return t-u;
});
}var r=this._value;
if(this._type==="topPercent"||this._type==="bottomPercent"){r=s.length*r/100>>0;
}this._values=s.slice(0,r);
},matches:function(q){return this._values.indexOf(q)>=0;
},toJSON:function(){return{filter:"top",type:this._type,value:this._value};
}});
l.spreadsheet.DynamicFilter=k.extend({init:function(q){this._type=q.type;
this._predicate=this[q.type];
if(typeof this._predicate!=="function"){throw new Error("DynamicFilter type '"+q.type+"' not recognized.");
}},value:function(q){var s=q.value;
if(q.format){var r=l.spreadsheet.formatting.type(s,q.format);
if(r==="date"){s=l.spreadsheet.numberToDate(s);
}}return s;
},prepare:function(q){var t=0;
var s=0;
for(var r=0;
r<q.length;
r++){var u=this.value(q[r]);
if(typeof u==="number"){t+=u;
s++;
}}if(s>0){this._average=t/s;
}else{this._average=0;
}},matches:function(q){return this._predicate(q);
},aboveAverage:function(q){if(q instanceof Date){q=l.spreadsheet.dateToNumber(q);
}if(typeof q!=="number"){return false;
}return q>this._average;
},belowAverage:function(q){if(q instanceof Date){q=l.spreadsheet.dateToNumber(q);
}if(typeof q!=="number"){return false;
}return q<this._average;
},tomorrow:function(r){if(r instanceof Date){var q=l.date.addDays(l.date.today(),1);
return l.date.getDate(r).getTime()===q.getTime();
}return false;
},today:function(q){if(q instanceof Date){return l.date.isToday(q);
}return false;
},yesterday:function(q){if(q instanceof Date){var r=l.date.addDays(l.date.today(),-1);
return l.date.getDate(q).getTime()===r.getTime();
}return false;
},nextWeek:function(q){return o(l.date.addDays(l.date.today(),7),q);
},thisWeek:function(q){return o(l.date.today(),q);
},lastWeek:function(q){return o(l.date.addDays(l.date.today(),-7),q);
},nextMonth:function(q){return n(q,1);
},thisMonth:function(q){return n(q,0);
},lastMonth:function(q){return n(q,-1);
},nextQuarter:function(s){if(s instanceof Date){var r=l.date.today();
var q=m(s)-m(r);
return q===1&&r.getFullYear()===s.getFullYear()||q==-3&&r.getFullYear()+1===s.getFullYear();
}return false;
},thisQuarter:function(s){if(s instanceof Date){var r=l.date.today();
var q=m(s)-m(r);
return q===0&&r.getFullYear()===s.getFullYear();
}return false;
},lastQuarter:function(s){if(s instanceof Date){var r=l.date.today();
var q=m(r)-m(s);
return q===1&&r.getFullYear()===s.getFullYear()||q==-3&&r.getFullYear()-1===s.getFullYear();
}return false;
},nextYear:function(q){return p(q,1);
},thisYear:function(q){return p(q,0);
},lastYear:function(q){return p(q,-1);
},yearToDate:function(r){if(r instanceof Date){var q=l.date.today();
return r.getFullYear()===q.getFullYear()&&r<=q;
}return false;
},toJSON:function(){return{filter:"dynamic",type:this._type};
}});
[1,2,3,4].forEach(function(q){l.spreadsheet.DynamicFilter.prototype["quarter"+q]=function(r){if(r instanceof Date){return m(r)===q;
}return false;
};
});
l.cultures["en-US"].calendar.months.names.forEach(function(r,q){l.spreadsheet.DynamicFilter.prototype[r.toLowerCase()]=function(s){if(s instanceof Date){return s.getMonth()===q;
}return false;
};
});
function m(r){var q=r.getMonth()+1;
if(q>=1&&q<=3){return 1;
}else{if(q>=4&&q<=6){return 2;
}else{if(q>=7&&q<=9){return 3;
}else{return 4;
}}}}function p(s,q){if(s instanceof Date){var r=l.date.today();
r.setFullYear(r.getFullYear()+q);
return r.getFullYear()===s.getFullYear();
}return false;
}function n(s,q){if(s instanceof Date){var r=l.date.firstDayOfMonth(l.date.today());
r.setMonth(r.getMonth()+q,1);
return r.getTime()===l.date.firstDayOfMonth(s).getTime();
}return false;
}function o(q,r){if(r instanceof Date){var s=l.date.dayOfWeek(l.date.getDate(q),1);
var t=l.date.dayOfWeek(l.date.getDate(r),1);
return s.getTime()===t.getTime();
}return false;
}}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/sorter",["kendo.core"],l);
}(function(){(function(k){if(k.support.browser.msie&&k.support.browser.version<9){return;
}var l=k.Class.extend({init:function(m,n){this._grid=m;
this._lists=n;
},indices:function(q,p,m,o){var n=l.ascendingComparer;
if(m===false){n=l.descendingComparer;
}return p.sortedIndices(this._grid.cellRefIndex(q.topLeft),this._grid.cellRefIndex(q.bottomRight),n,o);
},sortBy:function(t,o,s,m,q){var u=this.indices(t.toColumn(o),s,m,q);
for(var n=t.topLeft.col;
n<=t.bottomRight.col;
n++){var v=this._grid.index(t.topLeft.row,n);
var p=this._grid.index(t.bottomRight.row,n);
for(var r=0;
r<this._lists.length;
r++){if(v<this._lists[r].lastRangeStart()){this._lists[r].sort(v,p,u);
}}}return u;
}});
l.ascendingComparer=function(m,n){if(m===null&&n===null){return 0;
}if(m===null){return 1;
}if(n===null){return -1;
}var o=typeof m;
var p=typeof n;
if(o==="number"){if(p==="number"){return m-n;
}else{return -1;
}}if(o==="string"){switch(p){case"number":return 1;
case"string":return m.localeCompare(n);
default:return -1;
}}if(o==="boolean"){switch(p){case"number":return 1;
case"string":return 1;
case"boolean":return m-n;
default:return -1;
}}if(m instanceof k.spreadsheet.calc.runtime.CalcError){if(n instanceof k.spreadsheet.calc.runtime.CalcError){return 0;
}else{return 1;
}}throw new Error("Cannot compare "+m+" and "+n);
};
l.descendingComparer=function(m,n){if(m===null&&n===null){return 0;
}if(m===null){return 1;
}if(n===null){return -1;
}return l.ascendingComparer(n,m);
};
k.spreadsheet.Sorter=l;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/numformat",["spreadsheet/calc","kendo.dom"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var m=kendo.spreadsheet.calc;
var p=kendo.dom;
var u=/^\[(black|green|white|blue|magenta|yellow|cyan|red)\]/i;
var v=/^\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\]/;
function r(C){C=m.InputStream(C);
var J=[],B=false,A=false,z;
while(!C.eof()){var I=H();
J.push(I);
if(I.cond){A=true;
}}function y(){J.push({cond:"text",body:[{type:"text"}]});
}if(A){y();
}else{if(J.length==1){J[0].cond="num";
y();
}else{if(J.length==2){J[0].cond={op:">=",value:0};
J[1].cond={op:"<",value:0};
y();
}else{if(J.length>=3){J[0].cond={op:">",value:0};
J[1].cond={op:"<",value:0};
J[2].cond={op:"=",value:0};
y();
if(J.length>3){J[3].cond="text";
J=J.slice(0,4);
}}}}}return J;
function D(){var K=C.skip(u);
if(K){return K[1].toLowerCase();
}}function E(){var K=C.skip(v);
if(K){var L=parseFloat(K[2]);
if(!isNaN(L)){return{op:K[1],value:L};
}}}function F(){var K=[],L;
LOOP:while(!C.eof()&&(L=G())){K.push(L);
}return K;
}function G(){var K,L;
if(L=C.skip(/^([#0?]+),([#0?]+)/)){return{type:"digit",sep:true,format:L[1]+L[2],decimal:z};
}if(L=C.skip(/^[#0?]+/)){return{type:"digit",sep:false,format:L[0],decimal:z};
}if(L=C.skip(/^(e)([+-])/i)){return{type:"exp",ch:L[1],sign:L[2]};
}if(L=C.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)){var M="date",L=L[1].toLowerCase();
if(B&&(L=="m"||L=="mm")){M="time";
}B=false;
return{type:M,part:L.charAt(0),format:L.length};
}if(L=C.skip(/^(hh?|ss?)/i)){B=true;
L=L[1].toLowerCase();
return{type:"time",part:L.charAt(0),format:L.length};
}if(L=C.skip(/^\[(hh?|mm?|ss?)\]/i)){B=true;
L=L[1].toLowerCase();
return{type:"eltime",part:L.charAt(0),format:L.length};
}if(L=C.skip(/^(am\/pm|a\/p)/i)){L=L[1].split("/");
return{type:"ampm",am:L[0],pm:L[1]};
}switch(K=C.next()){case";":return null;
case"\\":return{type:"str",value:C.next()};
case'"':return{type:"str",value:C.readEscaped(K)};
case"@":return{type:"text"};
case"_":return{type:"space",value:C.next()};
case"*":return{type:"fill",value:C.next()};
case".":if(C.lookingAt(/^\s*[#0?]/)){z=true;
return{type:"dec"};
}return{type:"str",value:"."};
case"%":return{type:"percent"};
case",":return{type:"comma"};
}return{type:"str",value:K};
}function H(){z=false;
var K=D(),L=E();
if(!K&&L){K=D();
}return{color:K,cond:L,body:F()};
}}function s(A){return A.map(y).join(";");
function y(C){var B="";
if(C.color){B+="["+C.color+"]";
}if(C.cond){if(!(C.cond=="text"||C.cond=="num")){B+="["+C.cond.op+C.cond.value+"]";
}}B+=C.body.map(z).join("");
return B;
}function z(B){if(B.type=="digit"){if(B.sep){return B.format.charAt(0)+","+B.format.substr(1);
}else{return B.format;
}}else{if(B.type=="exp"){return B.ch+B.sign;
}else{if(B.type=="date"||B.type=="time"){return q("",B.format,B.part);
}else{if(B.type=="ampm"){return B.am+"/"+B.pm;
}else{if(B.type=="str"){return JSON.stringify(B.value);
}else{if(B.type=="text"){return"@";
}else{if(B.type=="space"){return"_"+B.value;
}else{if(B.type=="fill"){return"*"+B.value;
}else{if(B.type=="dec"){return".";
}else{if(B.type=="percent"){return"%";
}else{if(B.type=="comma"){return",";
}}}}}}}}}}}}}function k(y,z){y.forEach(function(E){var C=z;
if(E.cond=="text"){return;
}var B=E.body,A=false,D=B.length;
while(C!==0&&--D>=0){var G=B[D];
if(G.type=="digit"){if(G.decimal){A=true;
if(C>0){G.format+=q("",C,"0");
}else{if(C<0){var F=G.format.length;
G.format=G.format.substr(0,F+C);
C+=F-G.format.length;
}}if(G.format.length===0){B.splice(D,1);
while(--D>=0){G=B[D];
if(G.type=="digit"&&G.decimal){++D;
break;
}if(G.type=="dec"){B.splice(D,1);
break;
}}}}if(C>0){break;
}}}if(!A&&C>0){B.splice(D+1,0,{type:"dec"},{type:"digit",sep:false,decimal:true,format:q("",C,"0")});
}});
}function x(z){var y=0;
return{next:function(){return z[y++];
},eof:function(){return y>=z.length;
},ahead:function(B,A){if(y+B<=z.length){var C=A.apply(null,z.slice(y,y+B));
if(C){y+=B;
}return C;
}},restart:function(){y=0;
}};
}function o(D){var H=x(D.body);
var F=false;
var G=false;
var E=false;
var K=0;
var M=0;
var z="";
var N=false;
var C=0;
var I=[],B=[];
var A=D.cond;
var L="";
if(A=="text"){L="if (typeof value == 'string' || value instanceof kendo.spreadsheet.CalcError) { ";
}else{if(A=="num"){L="if (typeof value == 'number') { ";
}else{if(A){var J=A.op=="="?"==":A.op;
L="if (typeof value == 'number' && value "+J+" "+A.value+") { ";
z+="value = Math.abs(value); ";
}}}if(D.color){z+="result.color = "+JSON.stringify(D.color)+"; ";
}function y(P,Q){if(P.type=="digit"&&Q.type=="comma"||P.type=="comma"&&P.hidden&&Q.type=="comma"){Q.hidden=true;
M++;
}}while(!H.eof()){H.ahead(2,y);
var O=H.next();
if(O.type=="percent"){K++;
}else{if(O.type=="digit"){if(O.decimal){C+=O.format.length;
B.push(O.format);
}else{I.push(O.format);
if(O.sep){N=true;
}}}else{if(O.type=="time"){G=true;
}else{if(O.type=="date"){F=true;
}else{if(O.type=="ampm"){E=G=true;
}}}}}}if(K>0){z+="value *= "+Math.pow(100,K)+"; ";
}if(M>0){z+="value /= "+Math.pow(1000,M)+"; ";
}if(I.length){z+="var intPart = runtime.formatInt(culture, value, "+JSON.stringify(I)+", "+C+", "+N+"); ";
}if(B.length){z+="var decPart = runtime.formatDec(culture, value, "+JSON.stringify(B)+", "+C+"); ";
}if(I.length||B.length){z+="type = 'number'; ";
}if(F){z+="var date = runtime.unpackDate(value); ";
}if(G){z+="var time = runtime.unpackTime(value); ";
}if(F||G){z+="type = 'date'; ";
}if(K>0||M>0||I.length||B.length||F||G){if(!L){L="if (typeof value == 'number') { ";
}}H.restart();
while(!H.eof()){var O=H.next();
if(O.type=="dec"){z+="output += culture.numberFormat['.']; ";
}else{if(O.type=="comma"&&!O.hidden){z+="output += ','; ";
}else{if(O.type=="percent"){z+="type = 'percent'; ";
z+="output += culture.numberFormat.percent.symbol; ";
}else{if(O.type=="str"){z+="output += "+JSON.stringify(O.value)+"; ";
}else{if(O.type=="text"){z+="type = 'text'; ";
z+="output += value; ";
}else{if(O.type=="space"){z+="if (output) result.body.push(output); ";
z+="output = ''; ";
z+="result.body.push({ type: 'space', value: "+JSON.stringify(O.value)+" }); ";
}else{if(O.type=="fill"){z+="output += runtime.fill("+JSON.stringify(O.value)+"); ";
}else{if(O.type=="digit"){z+="output += "+(O.decimal?"decPart":"intPart")+".shift(); ";
}else{if(O.type=="date"){z+="output += runtime.date(culture, date, "+JSON.stringify(O.part)+", "+O.format+"); ";
}else{if(O.type=="time"){z+="output += runtime.time(culture, time, "+JSON.stringify(O.part)+", "+O.format+", "+E+"); ";
}else{if(O.type=="eltime"){z+="output += runtime.eltime(culture, value, "+JSON.stringify(O.part)+", "+O.format+"); ";
}else{if(O.type=="ampm"){z+="output += time.hours < 12 ? "+JSON.stringify(O.am)+" : "+JSON.stringify(O.pm)+"; ";
}}}}}}}}}}}}}z+="if (output) result.body.push(output); ";
z+="result.type = type; ";
z+="return result; ";
if(L){z=L+z+"}";
}return z;
}var l=Object.create(null);
function n(A){var z=l[A];
if(!z){var B=r(A);
var y=B.map(o).join("\n");
y="'use strict'; return function(value, culture){ if (!culture) culture = kendo.culture(); var output = '', type = null, result = { body: [] }; "+y+"; return result; };";
z=l[A]=new Function("runtime",y)(t);
}return z;
}var t={unpackDate:m.runtime.unpackDate,unpackTime:m.runtime.unpackTime,date:function(y,z,B,A){switch(B){case"d":switch(A){case 1:return z.date;
case 2:return q(z.date,2,"0");
case 3:return y.calendars.standard.days.namesAbbr[z.day];
case 4:return y.calendars.standard.days.names[z.day];
}break;
case"m":switch(A){case 1:return z.month+1;
case 2:return q(z.month+1,2,"0");
case 3:return y.calendars.standard.months.namesAbbr[z.month];
case 4:return y.calendars.standard.months.names[z.month];
case 5:return y.calendars.standard.months.names[z.month].charAt(0);
}break;
case"y":switch(A){case 2:return z.year%100;
case 4:return z.year;
}break;
}return"##";
},time:function(z,D,C,B,y){switch(C){case"h":var A=y?D.hours%12||12:D.hours;
switch(B){case 1:return A;
case 2:return q(A,2,"0");
}break;
case"m":switch(B){case 1:return D.minutes;
case 2:return q(D.minutes,2,"0");
}break;
case"s":switch(B){case 1:return D.seconds;
case 2:return q(D.seconds,2,"0");
}break;
}return"##";
},eltime:function(y,B,A,z){switch(A){case"h":B=B*24;
break;
case"m":B=B*24*60;
break;
case"s":B=B*24*60*60;
break;
}B|=0;
switch(z){case 1:return B;
case 2:return q(B,2,"0");
}return"##";
},fill:function(y){return y;
},formatInt:function(A,L,H,B,J){L=L.toFixed(B).replace(/\..*$/,"");
if(B>0){if(L==="0"){L="";
}else{if(L==="-0"){L="-";
}}}var D=L.length-1;
var I=[];
var G=0,K;
function y(M){if(J&&G&&G%3===0&&M!=" "){K=A.numberFormat[","]+K;
}K=M+K;
G++;
}for(var E=H.length;
--E>=0;
){var C=H[E];
K="";
for(var F=C.length;
--F>=0;
){var z=C.charAt(F);
if(D<0){if(z=="0"){y("0");
}else{if(z=="?"){y(" ");
}}}else{y(L.charAt(D--));
}}if(E===0){while(D>=0){y(L.charAt(D--));
}}I.unshift(K);
}return I;
},formatDec:function(z,J,F,A){J=J.toFixed(A);
var G=J.indexOf(".");
if(G>=0){J=J.substr(G+1).replace(/0+$/,"");
}else{J="";
}var C=0;
var H=[];
for(var D=0;
D<F.length;
++D){var B=F[D];
var I="";
for(var E=0;
E<B.length;
++E){var y=B.charAt(E);
if(C<J.length){I+=J.charAt(C++);
}else{if(y=="0"){I+="0";
}else{if(y=="?"){I+=" ";
}}}}H.push(I);
}return H;
}};
function q(z,A,y){z+="";
while(z.length<A){z=y+z;
}return z;
}function w(A){var y=A.body;
var C="";
for(var B=0;
B<y.length;
++B){var z=y[B];
if(typeof z=="string"){C+=z;
}else{if(z.type=="space"){C+=" ";
}}}return C;
}kendo.spreadsheet.formatting={compile:n,parse:r,format:function(F,C,z){var B=n(C)(F,z);
var E=p.element("span");
E.__dataType=B.type;
var y=B.body;
if(B.color){E.attr.style={color:B.color};
}for(var D=0;
D<y.length;
++D){var A=y[D];
if(typeof A=="string"){E.children.push(p.text(A));
}else{if(A.type=="space"){E.children.push(p.element("span",{style:{visibility:"hidden"}},[p.text(A.value)]));
}}}return E;
},text:function(B,A,y){var z=n(A)(B,y);
return w(z);
},textAndColor:function(B,A,y){var z=n(A)(B,y);
return{text:w(z),color:z.color,type:z.type};
},type:function(z,y){return n(y)(z).type;
},adjustDecimals:function(A,z){var y=r(A);
k(y,z);
return s(y);
}};
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/runtime.functions",["spreadsheet/runtime","util/main"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var ad=kendo.util;
var aa=kendo.spreadsheet;
var H=aa.calc;
var Y=H.runtime;
var N=Y.defineFunction;
var M=Y.defineAlias;
var I=Y.CalcError;
var W=aa.RangeRef;
var J=aa.CellRef;
var ab=aa.UnionRef;
var S=Y.Matrix;
var X=aa.Ref;
var K=Y.daysInMonth;
var U=Y.packDate;
var ac=Y.unpackDate;
var L=Y.daysInYear;
["abs","cos","sin","acos","asin","tan","atan","exp","sqrt"].forEach(function(af){N(af,Math[af]).args([["*n","number"]]);
});
N("ln",Math.log).args([["*n","number"]]);
N("log",function(ag,af){return Math.log(ag)/Math.log(af);
}).args([["*num","number++"],["*base",["or","number++",["null",10]]],["?",["assert","$base != 1","DIV/0"]]]);
N("log10",function(af){return Math.log(af)/Math.log(10);
}).args([["*num","number++"]]);
N("pi",function(){return Math.PI;
}).args([]);
N("sqrtpi",function(af){return Math.sqrt(af*Math.PI);
}).args([["*num","number+"]]);
N("degrees",function(af){return 180*af/Math.PI%360;
}).args([["*radians","number"]]);
N("radians",function(af){return Math.PI*af/180;
}).args([["*degrees","number"]]);
function n(af){return(Math.exp(af)+Math.exp(-af))/2;
}N("cosh",n).args([["*num","number"]]);
N("acosh",function(af){return Math.log(af+Math.sqrt(af-1)*Math.sqrt(af+1));
}).args([["*num","number"],["?",["assert","$num >= 1"]]]);
function x(af){return(Math.exp(af)-Math.exp(-af))/2;
}N("sinh",x).args([["*num","number"]]);
N("asinh",function(af){return Math.log(af+Math.sqrt(af*af+1));
}).args([["*num","number"]]);
N("sec",function(af){return 1/Math.cos(af);
}).args([["*num","number"]]);
N("sech",function(af){return 1/n(af);
}).args([["*num","number"]]);
N("csc",function(af){return 1/Math.sin(af);
}).args([["*num","number"]]);
N("csch",function(af){return 1/x(af);
}).args([["*num","number"]]);
N("atan2",function(af,ag){return Math.atan(ag/af);
}).args([["*x","divisor"],["*y","number"]]);
function z(af){return x(af)/n(af);
}N("tanh",z).args([["*num","number"]]);
N("atanh",function(af){return Math.log(Math.sqrt(1-af*af)/(1-af));
}).args([["*num",["and","number",["(between)",-1,1]]]]);
N("cot",function(af){return 1/Math.tan(af);
}).args([["*num","divisor"]]);
N("coth",function(af){return 1/z(af);
}).args([["*num","divisor"]]);
N("acot",function(af){return Math.PI/2-Math.atan(af);
}).args([["*num","number"]]);
N("acoth",function(af){return Math.log((af+1)/(af-1))/2;
}).args([["*num","number"],["?",["or",["assert","$num < -1"],["assert","$num > 1"]]]]);
N("power",function(af,ag){return Math.pow(af,ag);
}).args([["*a","number"],["*b","number"]]);
N("mod",function(af,ag){return af%ag;
}).args([["*a","number"],["*b","divisor"]]);
N("quotient",function(af,ag){return Math.floor(af/ag);
}).args([["*a","number"],["*b","divisor"]]);
N("ceiling",function(af,ag){return ag?ag*Math.ceil(af/ag):0;
}).args([["*number","number"],["*significance","number"],["?",["assert","$significance >= 0 || $number < 0"]]]);
N("ceiling.precise",function(af,ag){ag=Math.abs(ag);
return ag?ag*Math.ceil(af/ag):0;
}).args([["*number","number"],["*significance",["or","number",["null",1]]]]);
M("iso.ceiling","ceiling.precise");
N("ceiling.math",function(ag,ah,af){if(!ah||!ag){return 0;
}if(ag<0&&(!af&&ah<0||af&&ah>0)){ah=-ah;
}return ah?ah*Math.ceil(ag/ah):0;
}).args([["*number","number"],["*significance",["or","number",["null","$number < 0 ? -1 : 1"]]],["*mode",["or","logical",["null",0]]]]);
N("floor",function(af,ag){return ag?ag*Math.floor(af/ag):0;
}).args([["*number","number"],["*significance","number"],["?",["assert","$significance >= 0 || $number < 0"]]]);
N("floor.precise",function(af,ag){ag=Math.abs(ag);
return ag?ag*Math.floor(af/ag):0;
}).args([["*number","number"],["*significance",["or","number",["null",1]]]]);
N("floor.math",function(ag,ah,af){if(!ah||!ag){return 0;
}if(ag<0&&(!af&&ah<0||af&&ah>0)){ah=-ah;
}return ah?ah*Math.floor(ag/ah):0;
}).args([["*number","number"],["*significance",["or","number",["null","$number < 0 ? -1 : 1"]]],["*mode",["or","logical",["null",0]]]]);
N("int",Math.floor).args([["*number","number"]]);
N("mround",function(ag,af){return af?af*Math.round(ag/af):0;
}).args([["*number","number"],["*multiple","number"]]);
N("round",function(ag,af){var ah=ag<0?-1:1;
if(ah<0){ag=-ag;
}af=Math.pow(10,af);
ag*=af;
ag=Math.round(ag);
return ah*ag/af;
}).args([["*number","number"],["*digits","number"]]);
N("roundup",function(ag,af){af=Math.pow(10,af);
ag*=af;
ag=ag<0?Math.floor(ag):Math.ceil(ag);
return ag/af;
}).args([["*number","number"],["*digits","number"]]);
N("rounddown",function(ag,af){af=Math.pow(10,af);
ag*=af;
ag=ag<0?Math.ceil(ag):Math.floor(ag);
return ag/af;
}).args([["*number","number"],["*digits","number"]]);
N("even",function(ag){var af=ag<0?Math.floor(ag):Math.ceil(ag);
return af%2?af+(af<0?-1:1):af;
}).args([["*number","number"]]);
N("odd",function(ag){var af=ag<0?Math.floor(ag):Math.ceil(ag);
return af%2?af:af+(af<0?-1:1);
}).args([["*number","number"]]);
N("sign",function(af){return af<0?-1:af>0?1:0;
}).args([["*number","number"]]);
function r(af,ag){while(ag){var ah=af%ag;
af=ag;
ag=ah;
}return af;
}function s(af,ag){return Math.abs(af*ag)/r(af,ag);
}N("gcd",function(ag){var af=ag[0];
for(var ah=1;
ah<ag.length;
++ah){af=r(af,ag[ah]);
}return af;
}).args([["numbers",["collect","number"]]]);
N("lcm",function(ag){var af=ag[0];
for(var ah=1;
ah<ag.length;
++ah){af=s(af,ag[ah]);
}return af;
}).args([["numbers",["collect","number"]]]);
N("sum",function(af){return af.reduce(function(ah,ag){return ah+ag;
},0);
}).args([["numbers",["collect","number"]]]);
N("product",function(af){return af.reduce(function(ah,ag){return ah*ag;
},1);
}).args([["numbers",["collect","number"]]]);
N("sumproduct",function(af,ag){var ah=0;
af.each(function(ak,al,ai){if(typeof ak=="number"){for(var aj=0;
aj<ag.length;
++aj){var am=ag[aj].get(al,ai);
if(typeof am!="number"){return;
}ak*=am;
}ah+=ak;
}});
return ah;
}).args([["a1","matrix"],["+",["a2",["and","matrix",["assert","$a2.width == $a1.width"],["assert","$a2.height == $a1.height"]]]]]);
N("sumsq",function(af){return af.reduce(function(ah,ag){return ah+ag*ag;
},0);
}).args([["numbers",["collect","number"]]]);
N("sumx2my2",function(af,ag){var ah=0;
af.each(function(ak,aj,ai){var al=ag.get(aj,ai);
if(typeof ak=="number"&&typeof al=="number"){ah+=ak*ak-al*al;
}});
return ah;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
N("sumx2py2",function(af,ag){var ah=0;
af.each(function(ak,aj,ai){var al=ag.get(aj,ai);
if(typeof ak=="number"&&typeof al=="number"){ah+=ak*ak+al*al;
}});
return ah;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
N("sumxmy2",function(af,ag){var ah=0;
af.each(function(ak,aj,ai){var al=ag.get(aj,ai);
if(typeof ak=="number"&&typeof al=="number"){ah+=(ak-al)*(ak-al);
}});
return ah;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
N("seriessum",function(aj,ah,ag,af){var ai=0;
af.each(function(ak){if(typeof ak!="number"){throw new I("VALUE");
}ai+=ak*Math.pow(aj,ah);
ah+=ag;
});
return ai;
}).args([["x","number"],["y","number"],["m","number"],["a","matrix"]]);
N("min",function(af){return Math.min.apply(Math,af);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
N("max",function(af){return Math.max.apply(Math,af);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
N("counta",function(af){return af.length;
}).args([["values",["#collect","anyvalue"]]]);
N("count",function(af){return af.length;
}).args([["numbers",["#collect","number"]]]);
N("countunique",function(ah){var af=0,ag=[];
ah.forEach(function(ai){if(ag.indexOf(ai)<0){af++;
ag.push(ai);
}});
return af;
}).args([["values",["#collect","anyvalue"]]]);
N("countblank",function(af){var ah=0;
function ag(aj){if(aj==null||aj===""){ah++;
}}function ai(aj){for(var ak=0;
ak<aj.length;
++ak){var al=aj[ak];
if(al instanceof S){al.each(ag,true);
}else{ag(al);
}}}ai(af);
return ah;
}).args([["+",["args",["or","matrix","anyvalue"]]]]);
N("iseven",function(af){return af%2===0;
}).args([["*number","number"]]);
N("isodd",function(af){return af%2!==0;
}).args([["*number","number"]]);
N("n",function(af){if(typeof af=="boolean"){return af?1:0;
}if(typeof af=="number"){return af;
}return 0;
}).args([["*value","anyvalue"]]);
N("na",function(){return new I("N/A");
}).args([]);
function Q(af,ai){var ag=[],aj=0,ak=af[0];
while(aj<af.length){ag.push({matrix:af[aj++],pred:V(af[aj++])});
}ROW:for(var al=0;
al<ak.height;
++al){COL:for(var ah=0;
ah<ak.width;
++ah){for(aj=0;
aj<ag.length;
++aj){var am=ag[aj].matrix.get(al,ah);
if(!ag[aj].pred(am==null||am===""?0:am)){continue COL;
}}ai(al,ah);
}}}var C=[["m1","matrix"],["c1","anyvalue"],[["m2",["and","matrix",["assert","$m1.width == $m2.width"],["assert","$m1.height == $m2.height"]]],["c2","anyvalue"]]];
N("countifs",function(ah,af,ai){var ag=0;
ai.unshift(ah,af);
Q(ai,function(){ag++;
});
return ag;
}).args(C);
var F=[["range","matrix"]].concat(C);
N("sumifs",function(ai,ah,ag,af){af.unshift(ai,T,ah,ag);
var aj=0;
Q(af,function(al,ak){var am=ai.get(al,ak);
if(am){aj+=am;
}});
return aj;
}).args(F);
N("averageifs",function(aj,ai,ag,af){af.unshift(aj,T,ai,ag);
var ak=0,ah=0;
Q(af,function(am,al){var an=aj.get(am,al);
if(an==null||an===""){an=0;
}ak+=an;
ah++;
});
return ah?ak/ah:new I("DIV/0");
}).args(F);
N("countif",function(ah,ag){ag=V(ag);
var af=0;
ah.each(function(ai){if(ag(ai)){af++;
}});
return af;
}).args([["range","matrix"],["*criteria","anyvalue"]]);
var E=[["range","matrix"],["*criteria","anyvalue"],["sumRange",["or",["and","matrix",["assert","$sumRange.width == $range.width"],["assert","$sumRange.height == $range.height"]],["null","$range"]]]];
N("sumif",function(ag,af,ai){var ah=0;
af=V(af);
ag.each(function(am,ak,aj){if(af(am)){var al=ai.get(ak,aj);
if(T(al)){ah+=al||0;
}}});
return ah;
}).args(E);
N("averageif",function(ah,ag,aj){var ai=0,af=0;
ag=V(ag);
ah.each(function(an,al,ak){if(ag(an)){var am=aj.get(al,ak);
if(T(am)){ai+=am||0;
af++;
}}});
return af?ai/af:new I("DIV/0");
}).args(E);
(function(af){af("large",function(ah,ag){return ah.sort(O)[ag];
});
af("small",function(ah,ag){return ah.sort(G)[ag];
});
}(function(ag,af){N(ag,function(ai,aj){var ak=[];
var ah=ai.each(function(al){if(al instanceof I){return al;
}if(typeof al=="number"){ak.push(al);
}});
if(ah){return ah;
}if(aj>ak.length){return new I("NUM");
}return af(ak,aj-1);
}).args([["array","matrix"],["*nth","number++"]]);
}));
function k(af){return af.reduce(function(ah,ag){return ah+ag;
},0)/af.length;
}function A(ah,ag,af){if(af==null){af=k(ah);
}return ah.reduce(function(aj,ai){return aj+Math.pow(ai-af,2);
},0)/ag;
}function y(ag,af){return Math.sqrt(A(ag,af));
}N("stdev.s",function(af){return y(af,af.length-1);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
N("stdev.p",function(af){return y(af,af.length);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
N("var.s",function(af){return A(af,af.length-1);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
N("var.p",function(af){return A(af,af.length);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
N("median",function(ag){var af=ag.length;
ag.sort(G);
if(af%2){return ag[af>>1];
}return(ag[af>>1]+ag[af>>1+1])/2;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
N("mode.sngl",function(ak){ak.sort(G);
var al=null,af=0,ah=1,ai=null;
for(var ag=0;
ag<ak.length;
++ag){var aj=ak[ag];
if(aj!=al){af=1;
al=aj;
}else{af++;
}if(af>ah){ah=af;
ai=aj;
}}return ai==null?new I("N/A"):ai;
}).args([["numbers",["collect","number"]]]);
N("mode.mult",function(ah){var aj=Object.create(null),ag=2,ai=[];
ah.forEach(function(ak){var al=aj[ak]||0;
aj[ak]=++al;
if(al==ag){ai.push(ak);
}else{if(al>ag){ag=al;
ai=[ak];
}}});
var af=new S(this);
ai.forEach(function(al,ak){af.set(ak,0,al);
});
return af;
}).args([["numbers",["collect","number"]]]);
N("geomean",function(ag){var af=ag.length;
var ah=ag.reduce(function(aj,ai){if(ai<0){throw new I("NUM");
}return aj*ai;
},1);
return Math.pow(ah,1/af);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]);
N("harmean",function(ag){var af=ag.length;
var ah=ag.reduce(function(aj,ai){if(!ai){throw new I("DIV/0");
}return aj+1/ai;
},0);
return af/ah;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]);
N("trimmean",function(ai,aj){var ah=ai.length;
ai.sort(G);
var af=Math.floor(ah*aj);
if(af%2){--af;
}af/=2;
var ak=0;
for(var ag=af;
ag<ah-af;
++ag){ak+=ai[ag];
}return ak/(ah-af*2);
}).args([["numbers",["collect","number",1]],["percent",["and","number",["[between)",0,1]]],["?",["assert","$numbers.length > 0","NUM"]]]);
N("frequency",function(ah,af){ah.sort(G);
af.sort(G);
var ak=-Infinity;
var ai=0;
function ag(al){var am=0;
while(ai<ah.length&&ah[ai]>ak&&ah[ai]<=al){++am;
++ai;
}return am;
}var aj=new S(this);
af.forEach(function(an,al){var am=ag(an);
ak=an;
aj.set(al,0,am);
});
aj.set(aj.height,0,ah.length-ai);
return aj;
}).args([["data",["collect","number",1]],["bins",["collect","number",1]]]);
N("rank.eq",function(ai,ag,af){ag.sort(af?G:O);
var ah=ag.indexOf(ai);
return ah<0?new I("N/A"):ah+1;
}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]);
M("rank","rank.eq");
N("rank.avg",function(aj,ah,af){ah.sort(af?G:O);
var ai=ah.indexOf(aj);
if(ai<0){return new I("N/A");
}for(var ag=ai;
ah[ag]==aj;
++ag){}return(ai+ag+1)/2;
}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]);
N("kurt",function(ah){var ag=ah.length;
var af=k(ah);
var ak=A(ah,ag-1,af);
var ai=Math.sqrt(ak);
var aj=ah.reduce(function(am,al){return am+Math.pow((al-af)/ai,4);
},0);
return ag*(ag+1)/((ag-1)*(ag-2)*(ag-3))*aj-3*Math.pow(ag-1,2)/((ag-2)*(ag-3));
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 4","NUM"]]]);
function w(ak,am,af){var aj=0,ai=0,ah=null,al=null,ag=false;
ak.forEach(function(an){if(an<am){aj++;
ah=ah==null?an:Math.max(ah,an);
}else{if(an>am){ai++;
al=al==null?an:Math.min(al,an);
}else{ag=true;
}}});
if(!aj&&!ai){return new I("N/A");
}if(ag){if(af){return(aj+1)/(ak.length+1);
}return aj/(aj+ai);
}return((al-am)*w(ak,ah,af)+(am-ah)*w(ak,al,af))/(al-ah);
}var D=[["array",["collect","number",1]],["x","number"],["significance",["or",["null",3],"integer++"]],["?",["assert","$array.length > 0","NUM"]]];
N("percentrank.inc",function(af,ai,ah){var ag=w(af,ai,0);
ag=ag.toFixed(ah+1);
return parseFloat(ag.substr(0,ag.length-1));
}).args(D);
N("percentrank.exc",function(af,ai,ah){var ag=w(af,ai,1);
ag=ag.toFixed(ah+1);
return parseFloat(ag.substr(0,ag.length-1));
}).args(D);
M("percentrank","percentrank.inc");
function o(al,am,ah){var ak=0;
var af=k(al);
var ag=k(am);
var aj=al.length;
for(var ai=0;
ai<aj;
++ai){ak+=(al[ai]-af)*(am[ai]-ag);
}return ak/ah;
}N("covariance.p",function(af,ag){return o(af,ag,af.length);
}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length == $array2.length","N/A"]],["?",["assert","$array1.length > 0","DIV/0"]]]);
N("covariance.s",function(af,ag){return o(af,ag,af.length-1);
}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length == $array2.length","N/A"]],["?",["assert","$array1.length > 1","DIV/0"]]]);
M("covar","covariance.p");
var q=ad.memoize(function(ah){for(var ag=2,af=1;
ag<=ah;
++ag){af*=ag;
}return af;
});
N("fact",q).args([["*n","integer+"]]);
N("factdouble",function(ah){for(var ag=2+(ah&1),af=1;
ag<=ah;
ag+=2){af*=ag;
}return af;
}).args([["*n","integer+"]]);
N("multinomial",function(ag){var af=1,ah=0;
ag.forEach(function(ai){if(ai<0){throw new I("NUM");
}ah+=ai;
af*=q(ai);
});
return q(ah)/af;
}).args([["numbers",["collect","number"]]]);
var m=ad.memoize(function(ai,ah){for(var af=ah+1,ag=1,aj=1,ak=1;
ag<=ai-ah;
++af,++ag){aj*=af;
ak*=ag;
}return aj/ak;
});
N("combin",m).args([["*n","integer++"],["*k",["and","integer",["[between]",0,"$n"]]]]);
N("combina",function(ag,af){return m(ag+af-1,ag-1);
}).args([["*n","integer++"],["*k",["and","integer",["[between]",1,"$n"]]]]);
N("average",function(af){var ag=af.reduce(function(ai,ah){return ai+ah;
},0);
return ag/af.length;
}).args([["numbers",["collect",["and","number",["not","boolean"]]]],["?",["assert","$numbers.length > 0","DIV/0"]]]);
N("averagea",function(ah){var ag=0,af=0;
ah.forEach(function(ai){if(typeof ai!="string"){ag+=ai;
}++af;
});
return af?ag/af:new I("DIV/0");
}).args([["values",["collect","anyvalue"]]]);
function t(ai,aj){ai.sort(G);
var ah=ai.length;
var ag=aj|0,af=aj-ag;
if(ag===0){return ai[0];
}if(ag>=ah){return ai[ah-1];
}--ag;
return ai[ag]+af*(ai[ag+1]-ai[ag]);
}function v(af,ag){var ah=ag*(af.length-1)+1;
return t(af,ah);
}function u(af,ag){var ah=ag*(af.length+1);
return t(af,ah);
}N("percentile.inc",v).args([["numbers",["collect","number",1]],["p",["and","number",["[between]",0,1]]]]);
N("percentile.exc",u).args([["numbers",["collect","number",1]],["p",["and","number",["(between)",0,1]]]]);
N("quartile.inc",function(af,ag){return v(af,ag/4);
}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]);
N("quartile.exc",function(af,ag){return u(af,ag/4);
}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]);
M("quartile","quartile.inc");
M("percentile","percentile.inc");
var B=["AVERAGE","COUNT","COUNTA","MAX","MIN","PRODUCT","STDEV.S","STDEV.P","SUM","VAR.S","VAR.P","MEDIAN","MODE.SNGL","LARGE","SMALL","PERCENTILE.INC","QUARTILE.INC","PERCENTILE.EXC","QUARTILE.EXC"];
function P(al,af,ak){var am=[];
var ai=1;
var ah=2;
var aj=4;
(function ag(an){if(an instanceof X){al.getRefCells(an,true).forEach(function(ap){var ar=ap.value;
if(ak&ai&&ap.hidden){return;
}if(ap.formula){var aq=ap.formula.print(ap.row,ap.col);
if(/^\s*(?:aggregate|subtotal)\s*\(/i.test(aq)){if(!(ak&aj)){return;
}}if("value" in ap.formula){ar=ap.formula.value;
}}if(ak&ah&&ar instanceof I){return;
}if(typeof ar=="number"||ar instanceof I){am.push(ar);
}});
}else{if(Array.isArray(an)){for(var ao=0;
ao<an.length;
++ao){ag(an[ao]);
}}else{if(an instanceof S){an.each(ag);
}else{if(typeof an=="number"){am.push(an);
}else{if(an instanceof I&&!(ak&ah)){am.push(an);
}}}}}}(af));
return am;
}N("aggregate",function(ag,ah,ai,af){var aj=this;
aj.resolveCells(af,function(){var al;
if(ah>12){al=P(aj,af[0],ai);
var ak=af[1];
if(ak instanceof J){ak=aj.getRefData(ak);
}if(typeof ak!="number"){return ag(new I("VALUE"));
}}else{al=P(aj,af,ai);
}aj.func(B[ah-1],ag,al);
});
}).argsAsync([["funcId",["values",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],["options",["or",["null",0],["values",0,1,2,3,4,5,6,7]]],["args","rest"]]);
N("subtotal",function(ag,ah){var ak=this;
var aj=ah>100;
if(aj){ah-=100;
}var af=[];
for(var ai=2;
ai<arguments.length;
++ai){af.push(arguments[ai]);
}ak.resolveCells(af,function(){var al=P(ak,af,aj?1:0);
ak.func(B[ah-1],ag,al);
});
}).argsAsync([["funcId",["values",1,2,3,4,5,6,7,8,9,10,11,101,102,103,104,105,106,107,108,109,110,111]],["+",["ref",["or","ref","#matrix"]]]]);
N("avedev",function(ag){var af=ag.reduce(function(ai,ah){return ai+ah;
},0)/ag.length;
return ag.reduce(function(ai,ah){return ai+Math.abs(ah-af);
},0)/ag.length;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
function l(ak,ah,ai,af){if(!af){return m(ah,ak)*Math.pow(ai,ak)*Math.pow(1-ai,ah-ak);
}else{var aj=0;
for(var ag=0;
ag<=ak;
++ag){aj+=m(ah,ag)*Math.pow(ai,ag)*Math.pow(1-ai,ah-ag);
}return aj;
}}N("binom.dist",l).args([["successes","integer+"],["trials",["and","integer",["assert","$trials >= $successes"]]],["probability",["and","number",["[between]",0,1]]],["cumulative","logical"]]);
M("binomdist","binom.dist");
N("binom.inv",function(ag,ah,af){for(var ai=0;
ai<=ag;
++ai){if(l(ai,ag,ah,true)>=af){return ai;
}}return new I("N/A");
}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["alpha",["and","number",["[between]",0,1]]]]);
M("critbinom","binom.inv");
N("binom.dist.range",function(ag,ah,ai,aj){var ak=0;
for(var af=ai;
af<=aj;
++af){ak+=m(ag,af)*Math.pow(ah,af)*Math.pow(1-ah,ag-af);
}return ak;
}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["successes_min",["and","integer",["[between]",0,"$trials"]]],["successes_max",["or",["and","integer",["[between]","$successes_min","$trials"]],["null","$successes_min"]]]]);
N("negbinom.dist",function(aj,ag,ah,af){if(af){var ai=0;
while(aj>=0){ai+=m(aj+ag-1,aj)*Math.pow(ah,ag)*Math.pow(1-ah,aj);
aj--;
}return ai;
}return m(aj+ag-1,aj)*Math.pow(ah,ag)*Math.pow(1-ah,aj);
}).args([["number_f","integer+"],["number_s","integer+"],["probability_s",["and","number",["[between]",0,1]]],["cumulative","logical"]]);
M("negbinomdist","negbinom.dist");
N("address",function(aj,ai,ag,af,ak){var ah=new J(aj-1,ai-1,ag-1);
if(ak){ah.setSheet(ak,true);
}return af?ah.print(0,0):ah.print();
}).args([["row","integer++"],["col","integer++"],["abs",["or",["null",1],["values",1,2,3,4]]],["a1",["or",["null",true],"logical"]],["sheet",["or","null","string"]]]);
N("areas",function(ah){var af=0;
(function ag(ai){if(ai instanceof J||ai instanceof W){af++;
}else{if(ai instanceof ab){ai.refs.forEach(ag);
}}}(ah));
return af;
}).args([["ref","ref"]]);
N("choose",function(ag,af){if(ag>af.length){return new I("N/A");
}else{return af[ag-1];
}}).args([["*index","integer"],["+",["value","anything"]]]);
N("column",function(af){if(!af){return this.formula.col+1;
}if(af instanceof J){return af.col+1;
}return this.asMatrix(af).mapCol(function(ag){return ag+af.topLeft.col+1;
});
}).args([["ref",["or","area","null"]]]);
N("columns",function(af){return af instanceof X?af.width():af.width;
}).args([["ref",["or","area","#matrix"]]]);
N("formulatext",function(ag){var af=this.getRefCells(ag)[0];
if(!af.formula){return new I("N/A");
}return af.formula.print(af.row,af.col);
}).args([["ref","ref"]]);
N("hlookup",function(aj,ag,ai,af){var ah=null;
ag.eachCol(function(ak){var al=ag.get(0,ak);
if(af){if(al>aj){return true;
}ah=ak;
}else{if(al===aj){ah=ak;
return true;
}}});
if(ah==null){return new I("N/A");
}return ag.get(ai-1,ah);
}).args([["value","anyvalue"],["range","matrix"],["row","integer++"],["approx",["or","logical",["null",true]]]]);
N("index",function(ag,ah,af){if(ah==null&&af==null){return new I("N/A");
}if(ag.width>1&&ag.height>1){if(ah!=null&&af!=null){return ag.get(ah-1,af-1);
}if(ah==null){return ag.mapRow(function(ai){return ag.get(ai,af-1);
});
}if(af==null){return ag.mapCol(function(ai){return ag.get(ah-1,ai);
});
}}if(ag.width==1){return ag.get(ah-1,0);
}if(ag.height==1){return ag.get(0,af-1);
}return new I("REF");
}).args([["range","matrix"],["row",["or","integer++","null"]],["col",["or","integer++","null"]]]);
N("indirect",function(ai){try{var ah=this.formula;
var ag=H.parseFormula(ah.sheet,ah.row,ah.col,ai);
if(!(ag.ast instanceof X)){throw 1;
}return ag.ast.absolute(ah.row,ah.col);
}catch(af){return new I("REF");
}}).args([["thing","string"]]);
N("match",function(aj,ah,ai){var ag=1,af;
if(ai===0){af=V(aj);
}else{if(ai===-1){af=V("<="+aj);
}else{if(ai===1){af=V(">="+aj);
}}}if(ah.each(function(ak){if(ak!=null&&af(ak)){if(ai!==0&&aj!=ak){--ag;
}return true;
}ag++;
},true)&&ag>0){return ag;
}else{return new I("N/A");
}}).args([["value","anyvalue"],["range","matrix"],["type",["or",["values",-1,0,1],["null",1]]]]);
N("offset",function(ah,ai,af,ag,ak){var aj=(ah instanceof J?ah:ah.topLeft).clone();
aj.row+=ai;
aj.col+=af;
if(aj.row<0||aj.col<0){return new I("VALUE");
}if(ag>1||ak>1){return new W(aj,new J(aj.row+ag-1,aj.col+ak-1)).setSheet(ah.sheet,ah.hasSheet());
}return aj;
}).args([["ref","area"],["*rows","integer"],["*cols","integer"],["*height",["or","integer++",["null","$ref.height()"]]],["*width",["or","integer++",["null","$ref.width()"]]]]);
N("row",function(af){if(!af){return this.formula.row+1;
}if(af instanceof J){return af.row+1;
}return this.asMatrix(af).mapRow(function(ag){return ag+af.topLeft.row+1;
});
}).args([["ref",["or","area","null"]]]);
N("rows",function(af){return af instanceof X?af.height():af.height;
}).args([["ref",["or","area","#matrix"]]]);
N("vlookup",function(aj,ah,ag,af){var ai=null;
ah.eachRow(function(al){var ak=ah.get(al,0);
if(af){if(ak>aj){return true;
}ai=al;
}else{if(ak===aj){ai=al;
return true;
}}});
if(ai==null){return new I("N/A");
}return ah.get(ai,ag-1);
}).args([["value","anyvalue"],["range","matrix"],["col","integer++"],["approx",["or","logical",["null",true]]]]);
N("date",function(ah,ag,af){return U(ah,ag-1,af);
}).args([["*year","integer"],["*month","integer"],["*date","integer"]]);
N("day",function(af){return ac(af).date;
}).args([["*date","date"]]);
N("month",function(af){return ac(af).month+1;
}).args([["*date","date"]]);
N("year",function(af){return ac(af).year;
}).args([["*date","date"]]);
N("weekday",function(af){return ac(af).day+1;
}).args([["*date","date"]]);
N("weeknum",function(af,aj){var ah=U(ac(af).year,0,1);
var ai=ac(ah);
var ag;
if(aj==21){ag=3-(ai.day+6)%7;
if(ag<0){ag+=7;
}ah+=ag;
ai.date+=ag;
ai.day=4;
aj=1;
}else{if(aj==1){aj=0;
}else{if(aj==2){aj=1;
}else{aj=(aj-10)%7;
}}}ag=ai.day-aj;
if(ag<0){ag+=7;
}ah-=ag;
return Math.ceil((af+1-ah)/7);
}).args([["*date","date"],["*type",["or",["null",1],["values",1,2,11,12,13,14,15,16,17,21]]]]);
function ae(ag){var af=ac(U(ag,0,1));
if(af.day==4||af.day==3&&Y.isLeapYear(ag)){return 53;
}return 52;
}N("isoweeknum",function R(ag){var af=ac(ag);
var ah=af.day||7;
var ai=Math.floor((af.ord-ah+10)/7);
if(ai<1){return ae(af.year-1);
}else{if(ai==53&&ai>ae(af.year)){return 1;
}}return ai;
}).args([["*date","date"]]);
N("now",function(){return Y.dateToSerial(new Date());
}).args([]);
N("today",function(){return Y.dateToSerial(new Date())|0;
}).args([]);
N("time",function(af,ag,ah){return Y.packTime(af,ag,ah,0);
}).args([["*hours","integer"],["*minutes","integer"],["*seconds","integer"]]);
N("hour",function(af){return Y.unpackTime(af).hours;
}).args([["*time","datetime"]]);
N("minute",function(af){return Y.unpackTime(af).minutes;
}).args([["*time","datetime"]]);
N("second",function(af){return Y.unpackTime(af).seconds;
}).args([["*time","datetime"]]);
N("edate",function(af,ai){var ag=ac(af);
var ah=ag.month+ai;
var aj=ag.year+Math.floor(ah/12);
ah%=12;
if(ah<0){ah+=12;
}ag=Math.min(ag.date,K(aj,ah));
return U(aj,ah,ag);
}).args([["*start_date","date"],["*months","integer"]]);
N("eomonth",function(af,ai){var ag=ac(af);
var ah=ag.month+ai;
var aj=ag.year+Math.floor(ah/12);
ah%=12;
if(ah<0){ah+=12;
}ag=K(aj,ah);
return U(aj,ah,ag);
}).args([["*start_date","date"],["*months","integer"]]);
N("workday",function(af,aj,ah){var ai=aj>0?1:-1;
aj=Math.abs(aj);
var ag=ac(af).day;
while(aj>0){af+=ai;
ag=(ag+ai)%7;
if(ag>0&&ag<6&&ah.indexOf(af)<0){--aj;
}}return af;
}).args([["start_date","date"],["days","integer"],["holidays",["collect","date"]]]);
N("networkdays",function(ag,ai,aj){if(ag>ai){var ak=ag;
ag=ai;
ai=ak;
}var af=0;
var ah=ac(ag).day;
while(ag<=ai){if(ah>0&&ah<6&&aj.indexOf(ag)<0){af++;
}ag++;
ah=(ah+1)%7;
}return af;
}).args([["start_date","date"],["end_date","date"],["holidays",["collect","date"]]]);
N("days",function(ag,af){return af-ag;
}).args([["*start_date","date"],["*end_date","date"]]);
function p(aj,ah,ai){var af=ac(aj);
var ag=ac(ah);
if(ai){if(af.date==31){af.date=30;
}if(ag.date==31){ag.date=30;
}}else{if(af.month==1&&ag.month==1&&af.date==K(af.year,1)&&ag.date==K(ag.year,1)){ag.date=30;
}if(af.date==K(af.year,af.month)){af.date=30;
if(ag.date==31){ag.date=30;
}}else{if(af.date==30&&ag.date==31){ag.date=30;
}}}return 360*(ag.year-af.year)+30*(ag.month-af.month)+(ag.date-af.date);
}Y._days_360=p;
N("days360",p).args([["*start_date","date"],["*end_date","date"],["*method",["or","logical",["null","false"]]]]);
N("yearfrac",function(ah,af,ag){switch(ag){case 0:return p(ah,af,false)/360;
case 1:return(af-ah)/L(ac(ah).year);
case 2:return(af-ah)/360;
case 3:return(af-ah)/365;
case 4:return p(ah,af,true)/360;
}}).args([["*start_date","date"],["*end_date","date"],["*method",["or",["null",0],["values",0,1,2,3,4]]]]);
N("datevalue",function(ag){var af=Y.parseDate(ag);
if(af){return Y.dateToSerial(af);
}return new I("VALUE");
}).args([["*text","string"]]);
N("timevalue",function(ak){var ah=ak.toLowerCase().match(/(\d+):(\d+)(:(\d+)(\.(\d+))?)?\s*(am?|pm?)?/);
if(ah){var ag=parseFloat(ah[1]);
var ai=parseFloat(ah[2]);
var aj=ah[3]?parseFloat(ah[4]):0;
var af=ah[7];
if(af&&(ag>12||ag<1)){return new I("VALUE");
}if(/^p/.test(af)){ag+=12;
}return Y.packTime(ag,ai,aj,0);
}return new I("VALUE");
}).args([["*text","string"]]);
N("mdeterm",function(ag){var af=ag.each(function(ah){if(typeof ah!="number"){return new I("VALUE");
}},true);
return af||ag.determinant();
}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]);
N("transpose",function(af){return af.transpose();
}).args([["range","matrix"]]);
N("mmult",function(af,ag){return af.multiply(ag);
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.height == $a.width"]]]]);
N("munit",function(af){return new S(this).unit(af);
}).args([["n","integer+"]]);
N("minverse",function(ag){var af=ag.each(function(ah){if(typeof ah!="number"){return new I("VALUE");
}},true);
return af||ag.inverse()||new I("VALUE");
}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]);
N("rand",function(){return Math.random();
}).args([]);
N("randbetween",function(ag,af){return ag+Math.floor((af-ag+1)*Math.random());
}).args([["min","integer"],["max",["and","integer",["assert","$max >= $min"]]]]);
N("true",function(){return true;
}).args([]);
N("false",function(){return true;
}).args([]);
N("roman",function(af){return ad.arabicToRoman(af).toUpperCase();
}).args([["*number","integer"]]);
N("arabic",function(ag){var af=ad.romanToArabic(ag);
return af==null?new I("VALUE"):af;
}).args([["*roman","string"]]);
N("base",function(ag,ah,af){var ai=ag.toString(ah).toUpperCase();
while(ai.length<af){ai="0"+ai;
}return ai;
}).args([["*number","integer"],["*radix",["and","integer",["[between]",2,36]]],["*minLen",["or","integer+",["null",0]]]]);
N("decimal",function(ai,ah){ai=ai.toUpperCase();
var aj=0;
for(var ag=0;
ag<ai.length;
++ag){var af=ai.charCodeAt(ag);
if(af>=48&&af<=57){af-=48;
}else{if(af>=65&&af<55+ah){af-=55;
}else{return new I("VALUE");
}}aj=aj*ah+af;
}return aj;
}).args([["*text","string"],["*radix",["and","integer",["[between]",2,36]]]]);
N("char",function(af){return String.fromCharCode(af);
}).args([["*code","integer+"]]);
var Z=/[\0-\x1F\x7F-\x9F\xAD\u0378\u0379\u037F-\u0383\u038B\u038D\u03A2\u0528-\u0530\u0557\u0558\u0560\u0588\u058B-\u058E\u0590\u05C8-\u05CF\u05EB-\u05EF\u05F5-\u0605\u061C\u061D\u06DD\u070E\u070F\u074B\u074C\u07B2-\u07BF\u07FB-\u07FF\u082E\u082F\u083F\u085C\u085D\u085F-\u089F\u08A1\u08AD-\u08E3\u08FF\u0978\u0980\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09FC-\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF2-\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B78-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BFB-\u0C00\u0C04\u0C0D\u0C11\u0C29\u0C34\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5A-\u0C5F\u0C64\u0C65\u0C70-\u0C77\u0C80\u0C81\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0D01\u0D04\u0D0D\u0D11\u0D3B\u0D3C\u0D45\u0D49\u0D4F-\u0D56\u0D58-\u0D5F\u0D64\u0D65\u0D76-\u0D78\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF5-\u0E00\u0E3B-\u0E3E\u0E5C-\u0E80\u0E83\u0E85\u0E86\u0E89\u0E8B\u0E8C\u0E8E-\u0E93\u0E98\u0EA0\u0EA4\u0EA6\u0EA8\u0EA9\u0EAC\u0EBA\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F48\u0F6D-\u0F70\u0F98\u0FBD\u0FCD\u0FDB-\u0FFF\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u137D-\u137F\u139A-\u139F\u13F5-\u13FF\u169D-\u169F\u16F1-\u16FF\u170D\u1715-\u171F\u1737-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17DE\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180F\u181A-\u181F\u1878-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191D-\u191F\u192C-\u192F\u193C-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A1C\u1A1D\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1AFF\u1B4C-\u1B4F\u1B7D-\u1B7F\u1BF4-\u1BFB\u1C38-\u1C3A\u1C4A-\u1C4C\u1C80-\u1CBF\u1CC8-\u1CCF\u1CF7-\u1CFF\u1DE7-\u1DFB\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u206F\u2072\u2073\u208F\u209D-\u209F\u20BB-\u20CF\u20F1-\u20FF\u218A-\u218F\u23F4-\u23FF\u2427-\u243F\u244B-\u245F\u2700\u2B4D-\u2B4F\u2B5A-\u2BFF\u2C2F\u2C5F\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E3C-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u2FFC-\u2FFF\u3040\u3097\u3098\u3100-\u3104\u312E-\u3130\u318F\u31BB-\u31BF\u31E4-\u31EF\u321F\u32FF\u4DB6-\u4DBF\u9FCD-\u9FFF\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA698-\uA69E\uA6F8-\uA6FF\uA78F\uA794-\uA79F\uA7AB-\uA7F7\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA87F\uA8C5-\uA8CD\uA8DA-\uA8DF\uA8FC-\uA8FF\uA954-\uA95E\uA97D-\uA97F\uA9CE\uA9DA-\uA9DD\uA9E0-\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A\uAA5B\uAA7C-\uAA7F\uAAC3-\uAADA\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F-\uABBF\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC2-\uFBD2\uFD40-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFE\uFDFF\uFE1A-\uFE1F\uFE27-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]/g;
N("clean",function(af){return af.replace(Z,"");
}).args([["*text","string"]]);
N("code",function(af){return af.charAt(0);
}).args([["*text","string"]]);
M("unichar","char");
M("unicode","code");
N("concatenate",function(){var ag="";
for(var af=0;
af<arguments.length;
++af){ag+=arguments[af];
}return ag;
}).args([["+",["*text","string"]]]);
N("dollar",function(ai,ag){var ah="$#,##0.DECIMALS;($#,##0.DECIMALS)";
var af="";
while(ag-->0){af+="0";
}ah=ah.replace(/DECIMALS/g,af);
return aa.formatting.text(ai,ah);
}).args([["*number","number"],["*decimals",["or","integer++",["null",2]]]]);
N("exact",function(af,ag){return af===ag;
}).args([["*text1","string"],["*text2","string"]]);
N("find",function(ai,ah,ag){var af=ah.indexOf(ai,ag-1);
return af<0?new I("VALUE"):af+1;
}).args([["*substring","string"],["*string","string"],["*start",["or","integer++",["null",1]]]]);
N("fixed",function(aj,ag,ai){var ah=ai?"0.DECIMALS":"#,##0.DECIMALS";
var af="";
while(ag-->0){af+="0";
}ah=ah.replace(/DECIMALS/g,af);
return aa.formatting.text(aj,ah);
}).args([["*number","number"],["*decimals",["or","integer++",["null",2]]],["*noCommas",["or","boolean",["null",false]]]]);
N("left",function(ag,af){return ag.substr(0,af);
}).args([["*text","string"],["*length",["or","integer+",["null",1]]]]);
N("right",function(ag,af){return ag.substr(-af);
}).args([["*text","string"],["*length",["or","integer+",["null",1]]]]);
N("len",function(af){return af.length;
}).args([["*text","string"]]);
N("lower",function(af){return af.toLowerCase();
}).args([["*text","string"]]);
N("upper",function(af){return af.toUpperCase();
}).args([["*text","string"]]);
N("ltrim",function(af){return af.replace(/^\s+/,"");
}).args([["*text","string"]]);
N("rtrim",function(af){return af.replace(/\s+$/,"");
}).args([["*text","string"]]);
N("trim",function(af){return af.replace(/^\s+|\s+$/,"");
}).args([["*text","string"]]);
N("mid",function(ah,ag,af){return ah.substr(ag-1,af);
}).args([["*text","string"],["*start","integer++"],["*length","integer+"]]);
N("proper",function(af){return af.toLowerCase().replace(/\b./g,function(ag){return ag.toUpperCase();
});
}).args([["*text","string"]]);
N("replace",function(ai,ah,af,ag){return ai.substr(0,--ah)+ag+ai.substr(ah+af);
}).args([["*text","string"],["*start","integer++"],["*length","integer+"],["*newText","string"]]);
N("rept",function(ah,af){var ag="";
while(af-->0){ag+=ah;
}return ag;
}).args([["*text","string"],["*number","integer+"]]);
N("search",function(ai,ah,ag){var af=ah.toLowerCase().indexOf(ai.toLowerCase(),ag-1);
return af<0?new I("VALUE"):af+1;
}).args([["*substring","string"],["*string","string"],["*start",["or","integer++",["null",1]]]]);
N("substitute",function(ak,ah,af,ag){if(ah===af){return ak;
}var ai=-1;
function aj(){ak=ak.substring(0,ai)+af+ak.substring(ai+ah.length);
}while((ai=ak.indexOf(ah,ai+1))>=0){if(ag==null){aj();
}else{if(--ag===0){aj();
break;
}}}return ak;
}).args([["*text","string"],["*oldText","string"],["*newText","string"],["*nth",["or","integer++","null"]]]);
N("t",function(af){return typeof af=="string"?af:"";
}).args([["*value","anyvalue"]]);
N("text",function(ag,af){return aa.formatting.text(ag,af);
}).args([["*value","anyvalue"],["*format","string"]]);
N("value",function(af){if(typeof af=="number"){return af;
}if(typeof af=="boolean"){return +af;
}af=(af+"").replace(/[$,]/g,"");
af=parseFloat(af);
return isNaN(af)?new I("VALUE"):af;
}).args([["*value","anyvalue"]]);
N("iferror",function(af,ag){return af instanceof I?ag:af;
}).args([["*value","forced!"],["*value_if_error","anyvalue"]]);
var V=function(){var an=Object.create(null);
function am(ao,aq){if(typeof aq=="string"){var ap=parseFloat(aq);
if(!isNaN(ap)){aq=ap;
}}return function(ar){var at=aq;
if(typeof ar=="string"&&typeof at=="string"){ar=ar.toLowerCase();
at=at.toLowerCase();
}return ao(ar,at);
};
}function al(ao){if(typeof ao=="string"){return ao.toLowerCase();
}return ao;
}function ai(ao,ap){return al(ao)<al(ap);
}function aj(ao,ap){return al(ao)<=al(ap);
}function ag(ao,ap){return al(ao)>al(ap);
}function ah(ao,ap){return al(ao)>=al(ap);
}function ak(ao,ap){return al(ao)!=al(ap);
}function af(ao,ap){if(ap instanceof RegExp){return ap.test(ao);
}return al(ao)==al(ap);
}return function(ao){if(typeof ao=="function"){return ao;
}var ap;
if(ap=/^=(.*)$/.exec(ao)){return am(af,ap[1]);
}if(ap=/^<>(.*)$/.exec(ao)){return am(ak,ap[1]);
}if(ap=/^<=(.*)$/.exec(ao)){return am(aj,ap[1]);
}if(ap=/^<(.*)$/.exec(ao)){return am(ai,ap[1]);
}if(ap=/^>=(.*)$/.exec(ao)){return am(ah,ap[1]);
}if(ap=/^>(.*)$/.exec(ao)){return am(ag,ap[1]);
}if(/[?*]/.exec(ao)){var aq=an[ao];
if(!aq){aq=ao.replace(/(~\?|~\*|[\]({\+\.\|\^\$\\})\[]|[?*])/g,function(ar){switch(ar){case"~?":return"\\?";
case"~*":return"\\*";
case"?":return".";
case"*":return".*";
default:return"\\"+ar;
}});
aq=an[ao]=new RegExp("^"+aq+"$","i");
}return am(af,aq);
}return am(af,ao);
};
}();
function T(af){return typeof af=="number"||typeof af=="boolean"||af==null||af==="";
}function G(af,ag){return af===ag?0:af<ag?-1:1;
}function O(af,ag){return af===ag?0:af<ag?1:-1;
}},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/runtime.functions.2",["spreadsheet/runtime"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var bb=kendo.spreadsheet;
var E=bb.calc;
var a8=E.runtime;
var aa=a8.defineFunction;
var F=a8.CalcError;
var aU=a8.packDate;
var bl=a8.unpackDate;
var aG=a8.isLeapYear;
var W=a8.daysInMonth;
var m=a8._days_360;
aa("ERF",function(bp,bq){if(bq==null){return ae(bp);
}return ae(bq)-ae(bp);
}).args([["lower_limit","number"],["upper_limit",["or","number","null"]]]);
aa("ERFC",af).args([["x","number"]]);
aa("GAMMALN",az).args([["x","number++"]]);
aa("GAMMA",av).args([["x","number"]]);
aa("GAMMA.DIST",aw).args([["x","number+"],["alpha","number++"],["beta","number++"],["cumulative","logical"]]);
aa("GAMMA.INV",ay).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"]]);
aa("NORM.S.DIST",aQ).args([["z","number"],["cumulative","logical"]]);
aa("NORM.S.INV",aR).args([["p",["and","number",["[between]",0,1]]]]);
aa("NORM.DIST",aO).args([["x","number"],["mean","number"],["stddev","number++"],["cumulative","logical"]]);
aa("NORM.INV",aP).args([["p",["and","number",["[between]",0,1]]],["mean","number"],["stddev","number++"]]);
aa("BETADIST",z).args([["x","number"],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["assert","$x >= $A","NUM"]],["?",["assert","$x <= $B","NUM"]],["?",["assert","$A < $B","NUM"]]]);
aa("BETA.DIST",w).args([["x","number"],["alpha","number++"],["beta","number++"],["cumulative","logical"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["assert","$x >= $A","NUM"]],["?",["assert","$x <= $B","NUM"]],["?",["assert","$A < $B","NUM"]]]);
aa("BETA.INV",x).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]]]);
aa("CHISQ.DIST",G).args([["x","number+"],["deg_freedom","integer++"],["cumulative","logical"]]);
aa("CHISQ.DIST.RT",I).args([["x","number+"],["deg_freedom","integer++"]]);
aa("CHISQ.INV",H).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]);
aa("CHISQ.INV.RT",J).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]);
aa("CHISQ.TEST",function(bp,bq){return K(bp.data,bq.data);
}).args([["actual_range","matrix"],["expected_range","matrix"],["?",["assert","$actual_range.width == $expected_range.width"]],["?",["assert","$actual_range.height == $expected_range.height"]]]);
aa("EXPON.DIST",ag).args([["x","number+"],["lambda","number++"],["cumulative","logical"]]);
aa("POISSON.DIST",aY).args([["x","integer+"],["mean","number+"],["cumulative","logical"]]);
aa("F.DIST",ai).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"],["cumulative","logical"]]);
aa("F.DIST.RT",aj).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
aa("F.INV",ak).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
aa("F.INV.RT",al).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
aa("F.TEST",aq).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length >= 2","DIV/0"]],["?",["assert","$array2.length >= 2","DIV/0"]]]);
aa("FISHER",am).args([["x",["and","number",["(between)",-1,1]]]]);
aa("FISHERINV",an).args([["y","number"]]);
aa("T.DIST",be).args([["x","number"],["deg_freedom","integer++"],["cumulative","logical"]]);
aa("T.DIST.RT",bi).args([["x","number"],["deg_freedom","integer++"]]);
aa("T.DIST.2T",bf).args([["x","number+"],["deg_freedom","integer++"]]);
aa("T.INV",bh).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]);
aa("T.INV.2T",bg).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]);
aa("T.TEST",bj).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["tails",["and","integer",["values",1,2]]],["type",["and","integer",["values",1,2,3]]],["?",["assert","$type != 1 || $array1.length == $array2.length","N/A"]],["?",["assert","$array1.length >= 2","DIV/0"]],["?",["assert","$array2.length >= 2","DIV/0"]]]);
aa("CONFIDENCE.T",M).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++",["assert","$size != 1","DIV/0"]]]]);
aa("CONFIDENCE.NORM",L).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++"]]]);
aa("GAUSS",aA).args([["z","number"]]);
aa("PHI",aW).args([["x","number"]]);
aa("LOGNORM.DIST",aK).args([["x","number++"],["mean","number"],["standard_dev","number++"],["cumulative","logical"]]);
aa("LOGNORM.INV",aL).args([["probability",["and","number",["(between)",0,1]]],["mean","number"],["standard_dev","number++"]]);
aa("PROB",a2).args([["x_range",["collect","number",1]],["prob_range",["collect","number",1]],["lower_limit","number"],["upper_limit",["or","number",["null","$lower_limit"]]],["?",["assert","$prob_range.length == $x_range.length","N/A"]]]);
aa("SLOPE",ba).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]);
aa("INTERCEPT",aC).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]);
aa("PEARSON",aV).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array2.length == $array1.length","N/A"]],["?",["assert","$array2.length > 0 && $array1.length > 0","N/A"]]]);
aa("RSQ",a7).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]],["?",["assert","$known_x.length != 1 && $known_y.length != 1","N/A"]]]);
aa("STEYX",bc).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length >= 3 && $known_y.length >= 3","DIV/0"]]]);
aa("FORECAST",ao).args([["x","number"],["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]);
aa("LINEST",aI).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["const",["or","logical",["null",true]]],["stats",["or","logical",["null",false]]]]);
aa("LOGEST",aJ).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["const",["or","logical",["null",true]]],["stats",["or","logical",["null",false]]]]);
aa("TREND",bk).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["new_x",["or","matrix","null"]],["const",["or","logical",["null",true]]]]);
aa("GROWTH",aB).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["new_x",["or","matrix","null"]],["const",["or","logical",["null",true]]]]);
aa("FV",ar).args([["rate","number"],["nper","number"],["pmt",["or","number",["null",0]]],["pv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$pmt || $pv"]]]);
aa("PV",a3).args([["rate","number"],["nper","number"],["pmt",["or","number",["null",0]]],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$pmt || $fv"]]]);
aa("PMT",aX).args([["rate","number"],["nper","number"],["pmt","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]);
aa("NPER",aS).args([["rate","number"],["pmt","number"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]);
aa("RATE",a4).args([["nper","number"],["pmt",["or","number",["null",0]]],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["guess",["or","number++",["null",0.01]]],["?",["assert","$pmt || $fv"]]]);
aa("IPMT",aE).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$per >= 1 && $per <= $nper"]]]);
aa("PPMT",aZ).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$per >= 1 && $per <= $nper"]]]);
aa("CUMPRINC",V).args([["rate","number++"],["nper","number++"],["pv","number++"],["start_period","number++"],["end_period","number++"],["type",["or",["values",0,1],["null",0]]],["?",["assert","$end_period >= $start_period","NUM"]]]);
aa("CUMIPMT",U).args([["rate","number++"],["nper","number++"],["pv","number++"],["start_period","number++"],["end_period","number++"],["type",["or",["values",0,1],["null",0]]],["?",["assert","$end_period >= $start_period","NUM"]]]);
aa("NPV",aT).args([["rate","number"],["values",["collect","number"]],["?",["assert","$values.length > 0","N/A"]]]);
aa("IRR",aF).args([["values",["collect","number",1]],["guess",["or","number",["null",0.1]]]]);
aa("EFFECT",ac).args([["nominal_rate","number++"],["npery","integer++"]]);
aa("NOMINAL",aN).args([["effect_rate","number++"],["npery","integer++"]]);
aa("XNPV",bo).args([["rate","number"],["values",["collect","number",1]],["dates",["collect","date",1]],["?",["assert","$values.length == $dates.length","NUM"]]]);
aa("XIRR",bn).args([["values",["collect","number",1]],["dates",["collect","date",1]],["guess",["or","number",["null",0.1]]],["?",["assert","$values.length == $dates.length","NUM"]]]);
aa("ISPMT",aH).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["?",["assert","$per >= 1 && $per <= $nper"]]]);
aa("DB",Y).args([["cost","number"],["salvage","number"],["life","number++"],["period","number++"],["month",["or","number",["null",12]]]]);
aa("DDB",Z).args([["cost","number"],["salvage","number"],["life","number++"],["period","number++"],["factor",["or","number",["null",2]]]]);
aa("SLN",a9).args([["cost","number"],["salvage","number"],["life","number++"]]);
aa("SYD",bd).args([["cost","number"],["salvage","number"],["life","number++"],["per","number++"]]);
aa("VDB",bm).args([["cost","number+"],["salvage","number+"],["life","number++"],["start_period","number+"],["end_period","number+"],["factor",["or","number+",["null",2]]],["no_switch",["or","logical",["null",false]]],["?",["assert","$end_period >= $start_period","NUM"]]]);
var T=[["settlement","date"],["maturity","date"],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]];
aa("COUPDAYBS",N).args(T);
aa("COUPDAYS",O).args(T);
aa("COUPDAYSNC",P).args(T);
aa("COUPPCD",S).args(T);
aa("COUPNCD",Q).args(T);
aa("COUPNUM",R).args(T);
aa("ACCRINTM",u).args([["issue","date"],["settlement","date"],["rate","number++"],["par",["or",["null",1000],"number++"]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$issue < $settlement","NUM"]]]);
aa("ACCRINT",t).args([["issue","date"],["first_interest","date"],["settlement","date"],["rate","number++"],["par",["or",["null",1000],"number++"]],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["calc_method",["or","logical",["null",true]]],["?",["assert","$issue < $settlement","NUM"]]]);
aa("DISC",ab).args([["settlement","date"],["maturity","date"],["pr","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
aa("INTRATE",aD).args([["settlement","date"],["maturity","date"],["investment","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
aa("RECEIVED",a5).args([["settlement","date"],["maturity","date"],["investment","number++"],["discount","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
aa("PRICE",a0).args([["settlement","date"],["maturity","date"],["rate","number++"],["yld","number++"],["redemption","number++"],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
aa("PRICEDISC",a1).args([["settlement","date"],["maturity","date"],["discount","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
var aM=300,ad=2.2204e-16,ap=1e-30,ah=Math.abs;
function ae(bt){if(ah(bt)>=3.3){return 1-af(bt);
}var bs=bt>0?1:-1;
if(bs==-1){bt=-bt;
}var bq=0,bp=1;
for(var br=1;
br<100;
br++){bq+=bp;
bp*=2*bt*bt/(2*br+1);
}return bs*2/Math.sqrt(Math.PI)*bt*Math.exp(-bt*bt)*bq;
}function af(bs){if(ah(bs)<3.3){return 1-ae(bs);
}var br=1;
if(bs<0){br=-1;
bs=-bs;
}var bp=bs;
for(var bq=8;
bq>=1;
bq-=0.5){bp=bs+bq/bp;
}bp=1/(bs+bp);
return br==1?Math.exp(-bs*bs)/Math.sqrt(Math.PI)*bp:2-Math.exp(-bs*bs)/Math.sqrt(Math.PI)*bp;
}function az(bt){var bp=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,0.001208650973866179,-5.395239384953e-06];
var bu=bt,bs=bt+5.5,br=bp[0];
bs-=(bt+0.5)*Math.log(bs);
for(var bq=1;
bq<=6;
bq++){bu+=1;
br+=bp[bq]/bu;
}return -bs+Math.log(Math.sqrt(2*Math.PI)*br/bt);
}function av(bq){if(bq>0){return Math.exp(az(bq));
}var bp=Math.PI,br=-bq;
return -bp/(br*av(br)*Math.sin(bp*br));
}function A(bp,bq){return az(bp)+az(bq)-az(bp+bq);
}function v(bp,bq){return Math.exp(A(bp,bq));
}function ax(bp,bq){return bq<bp+1?au(bp,bq):1-at(bp,bq);
}function au(bp,bv){var bu=1/bp,br=bu,bq=bp;
var bs=az(bp),bt;
for(bt=1;
bt<=aM;
bt++){bq++;
br*=bv/bq;
bu+=br;
if(ah(br)<ah(bu)*ad){break;
}}return bu*Math.exp(-bv+bp*Math.log(bv)-bs);
}function at(bp,by){var bv=ap,bs=bv,bt=0,bq=1,br=by+1-bp;
var bw=az(bp);
for(var bx=1;
bx<=aM;
bx++){bt=br+bq*bt;
if(ah(bt)<ap){bt=ap;
}bs=br+bq/bs;
if(ah(bs)<ap){bs=ap;
}bt=1/bt;
var bu=bs*bt;
bv*=bu;
if(ah(bu-1)<ad){break;
}br+=2;
bq=-bx*(bx-bp);
}return bv*Math.exp(-by-bw+bp*Math.log(by));
}function aw(bs,bp,bq,br){if(!br){return Math.pow(bs/bq,bp-1)*Math.exp(-bs/bq)/(bq*av(bp));
}return ax(bp,bs/bq);
}function ay(bv,bp,br){if(bv===0){return 0;
}if(bv==1){return Infinity;
}var bt=0,bu=10,bx=0,bq=bp*br;
if(bq>1){bu*=bq;
}for(var bs=0;
bs<aM;
bs++){bx=0.5*(bt+bu);
var bw=aw(bx,bp,br,true);
if(ah(bv-bw)<1e-16){break;
}if(bw>bv){bu=bx;
}else{bt=bx;
}}return bx;
}function aQ(bq,bp){if(!bp){return Math.exp(-bq*bq/2)/Math.sqrt(2*Math.PI);
}return 0.5+0.5*ae(bq/Math.sqrt(2));
}function aR(bt){var bp=[-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],bq=[-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572],br=[-0.007784894002430293,-0.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],bs=[0.007784695709041462,0.3224671290700398,2.445134137142996,3.754408661907416];
var bv=0.02425,bu=1-bv;
var bw,bx;
if(bt<bv){bw=Math.sqrt(-2*Math.log(bt));
return(((((br[0]*bw+br[1])*bw+br[2])*bw+br[3])*bw+br[4])*bw+br[5])/((((bs[0]*bw+bs[1])*bw+bs[2])*bw+bs[3])*bw+1);
}if(bu<bt){bw=Math.sqrt(-2*Math.log(1-bt));
return -(((((br[0]*bw+br[1])*bw+br[2])*bw+br[3])*bw+br[4])*bw+br[5])/((((bs[0]*bw+bs[1])*bw+bs[2])*bw+bs[3])*bw+1);
}bw=bt-0.5;
bx=bw*bw;
return(((((bp[0]*bx+bp[1])*bx+bp[2])*bx+bp[3])*bx+bp[4])*bx+bp[5])*bw/(((((bq[0]*bx+bq[1])*bx+bq[2])*bx+bq[3])*bx+bq[4])*bx+1);
}function aO(bs,bq,br,bp){if(!bp){return Math.exp(-(bs-bq)*(bs-bq)/(2*br*br))/(br*Math.sqrt(2*Math.PI));
}return aQ((bs-bq)/br,true);
}function aP(bq,bp,br){return bp+br*aR(bq);
}function D(br,bp,bq){return Math.exp((bp-1)*Math.log(br)+(bq-1)*Math.log(1-br)-A(bp,bq));
}function B(bs,bp,bq){var br=Math.exp(bp*Math.log(bs)+bq*Math.log(1-bs)-A(bp,bq));
return bs<(bp+1)/(bp+bq+2)?br*y(bp,bq,bs)/bp:1-br*y(bq,bp,1-bs)/bq;
}function y(bp,br,bB){var bw,bx;
var bq,bs,bt,bu,bv,by,bz,bA;
by=bp+br;
bA=bp+1;
bz=bp-1;
bs=1;
bt=1-by*bB/bA;
if(ah(bt)<ap){bt=ap;
}bt=1/bt;
bv=bt;
for(bw=1;
bw<=aM;
bw++){bx=2*bw;
bq=bw*(br-bw)*bB/((bz+bx)*(bp+bx));
bt=1+bq*bt;
if(ah(bt)<ap){bt=ap;
}bs=1+bq/bs;
if(ah(bs)<ap){bs=ap;
}bt=1/bt;
bv*=bt*bs;
bq=-(bp+bw)*(by+bw)*bB/((bp+bx)*(bA+bx));
bt=1+bq*bt;
if(ah(bt)<ap){bt=ap;
}bs=1+bq/bs;
if(ah(bs)<ap){bs=ap;
}bt=1/bt;
bu=bt*bs;
bv*=bu;
if(ah(bu-1)<ad){break;
}}return bv;
}function C(bu,bp,bq){var bs=0,bt=1,bw=0;
for(var br=0;
br<aM;
br++){bw=0.5*(bs+bt);
var bv=B(bw,bp,bq);
if(ah(bu-bv)<ad){break;
}if(bv>bu){bt=bw;
}else{bs=bw;
}}return bw;
}function z(bt,bp,bq,br,bs){return B((bt-br)/(bs-br),bp,bq);
}function w(bu,bp,bq,br,bs,bt){if(br){return B((bu-bs)/(bt-bs),bp,bq);
}return D((bu-bs)/(bt-bs),bp,bq)/(bt-bs);
}function x(bt,bp,bq,br,bs){return br+(bs-br)*C(bt,bp,bq);
}function G(br,bq,bp){return aw(br,bq/2,2,bp);
}function I(bq,bp){return 1-G(bq,bp,true);
}function H(bq,bp){return ay(bq,bp/2,2);
}function J(bq,bp){return H(1-bq,bp);
}function K(bw,bs){var bx=bw.length,bp=bw[0].length;
var by=0,bt,bu;
for(bt=0;
bt<bx;
bt++){for(bu=0;
bu<bp;
bu++){var br=bs[bt][bu];
var bq=bw[bt][bu]-br;
bq*=bq;
by+=bq/br;
}}var bv=(bx-1)*(bp-1);
return I(by,bv);
}function ag(br,bq,bp){if(bp){return 1-Math.exp(-bq*br);
}return bq*Math.exp(-bq*br);
}function aY(br,bt,bp){if(bp){return 1-G(2*bt,2*(br+1),true);
}var bs=0;
for(var bq=2;
bq<=br;
bq++){bs+=Math.log(bq);
}return Math.exp(br*Math.log(bt)-bt-bs);
}function ai(bt,br,bq,bp){if(bp){return B(br*bt/(bq+br*bt),br/2,bq/2);
}var bs=br/bq;
br/=2;
bq/=2;
return bs/v(br,bq)*Math.pow(bs*bt,br-1)/Math.pow(1+bs*bt,br+bq);
}function aj(br,bq,bp){return 1-ai(br,bq,bp,true);
}function al(br,bq,bp){return bp/bq*(1/x(br,bp/2,bq/2,0,1)-1);
}function ak(br,bq,bp){return bp/bq*(1/x(1-br,bp/2,bq/2,0,1)-1);
}function r(bp){var br=0,bs=bp.length;
for(var bq=0;
bq<bs;
bq++){br+=bp[bq];
}return br/bs;
}function s(bp,bs){var bu=0,bt=bp.length;
for(var br=0;
br<bt;
br++){var bq=bp[br]-bs;
bu+=bq*bq;
}return bu/(bt-1);
}function aq(bp,bq){var br=bp.length-1,bs=bq.length-1;
var bt=s(bp,r(bp)),bu=s(bq,r(bq));
if(!bt||!bu){throw new F("DIV/0");
}return 2*ai(bt/bu,br,bs,true);
}function am(bp){return 0.5*Math.log((1+bp)/(1-bp));
}function an(bq){var bp=Math.exp(2*bq);
return(bp-1)/(bp+1);
}function be(br,bq,bp){if(bp){return 1-0.5*B(bq/(br*br+bq),bq/2,0.5);
}return 1/(Math.sqrt(bq)*v(0.5,bq/2))*Math.pow(1+br*br/bq,-(bq+1)/2);
}function bi(bq,bp){return 1-be(bq,bp,true);
}function bf(bq,bp){if(bq<0){bq=-bq;
}return 2*bi(bq,bp);
}function bh(bq,bp){var br=C(2*Math.min(bq,1-bq),bp/2,0.5);
br=Math.sqrt(bp*(1-br)/br);
return bq>0.5?br:-br;
}function bg(bq,bp){return bh(1-bq/2,bp);
}function bj(bt,bu,bE,bF){var bz=bt.length,bA=bu.length;
var bD,bs;
if(bF==1){var bp=0,bq=0;
for(var bv=0;
bv<bz;
bv++){var br=bt[bv]-bu[bv];
bp+=br;
bq+=br*br;
}var by=bp/bz;
bD=by/Math.sqrt((bq-bp*by)/(bz*(bz-1)));
return bE==1?bi(bD,bz-1):bf(bD,bz-1);
}var bw=r(bt),bx=r(bu),bJ=s(bt,bw),bK=s(bu,bx);
if(bF==3){var bH=bJ/bz,bI=bK/bA,bG=bH+bI;
var bB=bH/bG,bC=bI/bG;
bs=1/(bB*bB/(bz-1)+bC*bC/(bA-1));
bD=ah(bw-bx)/Math.sqrt(bG);
return bE==1?bi(bD,bs):bf(bD,bs);
}else{bs=bz+bA-2;
bD=ah(bw-bx)*Math.sqrt(bs*bz*bA/((bz+bA)*((bz-1)*bJ+(bA-1)*bK)));
return bE==1?bi(bD,bs):bf(bD,bs);
}}function M(bp,br,bq){return -bh(bp/2,bq-1)*br/Math.sqrt(bq);
}function L(bp,br,bq){return -aR(bp/2)*br/Math.sqrt(bq);
}function aA(bp){return aQ(bp,true)-0.5;
}function aW(bp){return aQ(bp);
}function aK(bt,bq,br,bp){if(bp){return 0.5+0.5*ae((Math.log(bt)-bq)/(br*Math.sqrt(2)));
}var bs=Math.log(bt)-bq;
return Math.exp(-bs*bs/(2*br*br))/(bt*br*Math.sqrt(2*Math.PI));
}function aL(bq,bp,br){return Math.exp(aP(bq,bp,br));
}function a2(bx,bs,bq,bv){var br=bx.length;
var bu=0,bp;
for(bp=0;
bp<br;
bp++){if(bs[bp]<=0||bs[bp]>1){throw new F("NUM");
}bu+=bs[bp];
}if(bu!=1){throw new F("NUM");
}var bt=0;
for(bp=0;
bp<br;
bp++){var bw=bx[bp];
if(bw>=bq&&bw<=bv){bt+=bs[bp];
}}return bt;
}function ba(bx,bw){var bs=r(bw),bt=r(bx),bp=0,bq=0;
for(var br=0,bu=bx.length;
br<bu;
br++){var bv=bw[br]-bs;
bp+=bv*(bx[br]-bt);
bq+=bv*bv;
}return bp/bq;
}function aC(bx,bw){var bs=r(bw),bt=r(bx);
var bp=0,bq=0;
for(var br=0,bu=bx.length;
br<bu;
br++){var bv=bw[br]-bs;
bp+=bv*(bx[br]-bt);
bq+=bv*bv;
}return bt-bp*bs/bq;
}function aV(by,bz){var bq=r(by),br=r(bz);
var bt=0,bu=0,bv=0;
for(var bp=0,bs=by.length;
bp<bs;
bp++){var bw=by[bp]-bq,bx=bz[bp]-br;
bt+=bw*bx;
bu+=bw*bw;
bv+=bx*bx;
}return bt/Math.sqrt(bu*bv);
}function a7(bq,br){var bp=aV(bq,br);
return bp*bp;
}function bc(bz,by){var bs=by.length;
var bq=r(by),br=r(bz);
var bt=0,bu=0,bv=0;
for(var bp=0;
bp<bs;
bp++){var bw=by[bp]-bq,bx=bz[bp]-br;
bt+=bx*bx;
bu+=bw*bx;
bv+=bw*bw;
}return Math.sqrt((bt-bu*bu/bv)/(bs-2));
}function ao(bz,bB,bA){var bs=r(bA),bt=r(bB);
var bv=0,bw=0;
for(var br=0,bu=bA.length;
br<bu;
br++){var bx=bA[br]-bs,by=bB[br]-bt;
bv+=bx*by;
bw+=bx*bx;
}if(bw===0){throw new F("N/A");
}var bq=bv/bw,bp=bt-bq*bs;
return bp+bq*bz;
}function q(bq){var br=bq.height,bs=0;
for(var bp=0;
bp<br;
bp++){bs+=bq.data[bp][0];
}return bs/br;
}function p(bq,br){var bs=bq.height,bt=0;
for(var bp=0;
bp<bs;
bp++){var bu=bq.data[bp][0]-br;
bt+=bu*bu;
}return bt;
}function aI(bJ,bH,bu,bG){var bt=0;
if(!bH){bH=bJ.map(function(){return ++bt;
});
}if(bu){bH=bH.clone();
bH.eachRow(function(bM){bH.data[bM].unshift(1);
});
++bH.width;
}var bI=bH.transpose();
var bp=bI.multiply(bH).inverse().multiply(bI).multiply(bJ);
var bv=[];
for(bt=bp.height-1;
bt>=0;
bt--){bv.push(bp.data[bt][0]);
}if(!bu){bv.push(0);
}if(!bG){return this.asMatrix([bv]);
}var bL=bH.multiply(bp);
var bK=bJ.adds(bL,true);
var bB=!bu?0:q(bL);
var bE=p(bL,bB);
var bA=!bu?0:q(bK);
var bF=p(bK,bA);
var bz=[];
bz.push(bE,bF);
var bC=bE/(bE+bF);
var bq=bJ.height-bH.width;
var br=Math.sqrt(bF/bq);
var bx=[];
bx.push(bC,br);
var bs=!bu?bC/bH.width/((1-bC)/bq):bE/(bH.width-1)/(bF/bq);
var by=[];
by.push(bs,bq);
var bD=bI.multiply(bH).inverse();
var bw=[];
for(bt=bD.height-1;
bt>=0;
bt--){bw.push(Math.sqrt(bD.data[bt][bt]*bF/bq));
}return this.asMatrix([bv,bw,bx,by,bz]);
}function aJ(bs,br,bp,bq){return aI.call(this,bs.map(Math.log),br,bp,bq).map(Math.exp);
}function bk(bv,bt,bs,br){var bq=0;
if(!bt){bt=bv.map(function(){return ++bq;
});
}if(br){bt=bt.clone();
bt.eachRow(function(bw){bt.data[bw].unshift(1);
});
++bt.width;
}var bu=bt.transpose();
var bp=bu.multiply(bt).inverse().multiply(bu).multiply(bv);
if(!bs){bs=bt;
}else{if(br){bs=bs.clone();
bs.eachRow(function(bw){bs.data[bw].unshift(1);
});
++bs.width;
}}return bs.multiply(bp);
}function aB(bs,br,bq,bp){return bk.call(this,bs.map(Math.log),br,bq,bp).map(Math.exp);
}function a6(bv,bw,by,br){var bz=by||20,bs=br||1e-07;
var bA=bw;
for(var bx=1;
bx<=bz;
bx++){var bu=bv(bA),bt=bu[0],bp=bu[1];
var bq=bt/bp;
bA-=bq;
if(Math.abs(bq)<bs){return bA;
}}return new F("NUM");
}function ar(bu,br,bs,bt,bv){var bp=Math.pow(1+bu,br);
var bq=bu?(bp-1)/bu:br;
return -(bt*bp+bs*bq*(1+bu*bv));
}function a3(bt,br,bs,bp,bu){if(!bt){return -bp-bs*br;
}var bq=Math.pow(1+bt,br);
return -(bp+bs*(bq-1)/bt*(1+bt*bu))/bq;
}function aX(bt,br,bs,bp,bu){if(!bt){return -(bp+bs)/br;
}var bq=Math.pow(1+bt,br);
return -bt*(bp+bs*bq)/((1+bt*bu)*(bq-1));
}function aS(bt,br,bs,bp,bu){if(!bt){return -(bp+bs)/br;
}var bq=br*(1+bt*bu);
return Math.log((bq-bp*bt)/(bq+bs*bt))/Math.log(1+bt);
}function a4(br,bs,bt,bp,bu,bq){function bv(by){var bx=Math.pow(1+by,br-1),bw=bx*(1+by);
return[bt*bw+bs*(1/by+bu)*(bw-1)+bp,br*bt*bx+bs*(-(bw-1)/(by*by)+(1/by+bu)*br*bx)];
}return a6(bv,bq);
}function aE(bv,bs,br,bu,bp,bw){if(bw==1&&bs==1){return 0;
}var bt=aX(bv,br,bu,bp,bw);
var bq=ar(bv,bs-1,bt,bu,bw)*bv;
return bw?bq/(1+bv):bq;
}function aZ(bu,br,bq,bt,bp,bv){var bs=aX(bu,bq,bt,bp,bv);
return bs-aE(bu,br,bq,bt,bp,bv);
}function V(bt,br,bs,bw,bp,bA){if(bA==1){bw--;
bp--;
}var by=Math.pow(1+bt,br),bz=Math.pow(1+bt,bw-1),bx=Math.pow(1+bt,bp);
var bq=bt*bs*by/(by-1);
var bv=bz*bs-(bz-1)/bt*bq;
var bu=bx*bs-(bx-1)/bt*bq;
return bu-bv;
}function U(bu,bs,bt,bv,bq,bw){var bp=0;
for(var br=bv;
br<=bq;
br++){bp+=aE(bu,br,bs,bt,0,bw);
}return bp;
}function aT(bt,bp){var bs=0;
for(var bq=0,br=bp.length;
bq<br;
bq++){bs+=bp[bq]*Math.pow(1+bt,-bq-1);
}return bs;
}function aF(bp,bq){function br(bw){var bu=0,bv=0;
for(var bs=0,bt=bp.length;
bs<bt;
bs++){bu+=bp[bs]*Math.pow(1+bw,-bs-1);
bv+=-bs*bp[bs]*Math.pow(1+bw,-bs-2);
}return[bu,bv];
}return a6(br,bq);
}function ac(bp,bq){return Math.pow(1+bp/bq,bq)-1;
}function aN(bp,bq){return bq*(Math.pow(bp+1,1/bq)-1);
}function bo(bt,bu,bp){var bs=0;
for(var bq=0,br=bu.length;
bq<br;
bq++){bs+=bu[bq]*Math.pow(1+bt,(bp[0]-bp[bq])/365);
}return bs;
}function bn(br,bp,bq){function bs(by){var bw=br[0],bx=0;
for(var bu=1,bv=br.length;
bu<bv;
bu++){var bt=(bp[0]-bp[bu])/365;
bw+=br[bu]*Math.pow(1+by,bt);
bx+=bt*br[bu]*Math.pow(1+by,bt-1);
}return[bw,bx];
}return a6(bs,bq);
}function aH(bs,bq,bp,br){var bt=-br*bs;
return bt*(1-bq/bp);
}function Y(bp,bw,bs,bu,bt){var bv=1-Math.pow(bw/bp,1/bs);
bv=Math.floor(bv*1000+0.5)/1000;
var bq=bp*bv*bt/12;
if(bu==1){return bq;
}for(var br=1;
br<bs;
br++){if(br==bu-1){return(bp-bq)*bv;
}bq+=(bp-bq)*bv;
}return(bp-bq)*bv*(12-bt)/12;
}function Z(bp,bw,bt,bu,bs){var br=bs/bt;
var bv=-bp*(Math.pow(1-br,bu-1)-1);
var bq=(bp-bv)*br;
bq=Math.min(bq,Math.max(0,bp-bv-bw));
return bq;
}function a9(bp,br,bq){return(bp-br)/bq;
}function bd(bp,bs,bq,br){return(bp-bs)*(bq-br+1)*2/(bq*(bq+1));
}function bm(br,bC,by,bD,bs,bt,bA){var bw=bt>=by?1:bt/by;
function bp(bK,bJ){var bG,bI,bH;
if(bw==1){bI=bJ==1?bK:0;
}else{bI=bK*Math.pow(1-bw,bJ-1);
}bH=bK*Math.pow(1-bw,bJ);
bG=bH<bC?bI-bC:bI-bH;
return bG<0?0:bG;
}function bq(bG,bL,bN){var bO=bG-bC;
var bJ=Math.ceil(bN);
var bP,bK=0,bQ=0,bM=false;
for(var bI=1;
bI<=bJ;
bI++){if(!bM){var bH=bp(bG,bI);
bK=bO/(bL-bI+1);
if(bK>bH){bP=bK;
bM=true;
}else{bP=bH;
bO-=bH;
}}else{bP=bK;
}if(bI==bJ){bP*=bN+1-bJ;
}bQ+=bP;
}return bQ;
}var bx=Math.floor(bD),bv=Math.ceil(bs);
var bF=0;
if(bA){for(var bu=bx+1;
bu<=bv;
bu++){var bE=bp(br,bu);
if(bu==bx+1){bE*=Math.min(bs,bx+1)-bD;
}else{if(bu==bv){bE*=bs+1-bv;
}}bF+=bE;
}}else{var bz=by;
if(bD!=Math.floor(bD)){if(bt>1){if(bD>=by/2){var bB=bD-by/2;
bD=by/2;
bs-=bB;
bz+=1;
}}}br-=bq(br,bz,bD);
bF=bq(br,by-bD,bs-bD);
}return bF;
}function o(bp,bs){var bq=bl(bp);
var br=bq.month+bs;
var bt=bq.year+Math.floor(br/12);
br%=12;
if(br<0){br+=12;
}bq=Math.min(bq.date,W(bt,br));
return aU(bt,br,bq);
}function n(bq,br,bp){if(bp==1||bp==2||bp==3){return br-bq;
}return m(bq,br,bp);
}function k(bx,br,bq){var bw=bl(bx),bp=bl(br);
var bu=bp.year-bw.year;
if(bu>0){bu=(bu-1)*bq;
}var bv,bt,bs=12/bq;
do{bu++;
bv=o(br,-bu*bs);
}while(bx<bv);
bu--;
bt=o(br,-bu*bs);
return[bv,bt];
}function l(bq,bx,br){var bw=bl(bx),bp=bl(bq);
var bu=bw.year-bp.year;
if(bu>0){bu=(bu-1)*br;
}var bv=bq,bt,bs=12/br;
while(bx>bv){bt=bv;
bu++;
bv=o(bq,bu*bs);
}return[bt,bv];
}function N(bt,br,bq,bp){var bs=k(bt,br,bq)[0];
return n(bs,bt,bp);
}function O(bt,bs,br,bp){if(bp==1){var bq=k(bt,bs,br);
return n(bq[0],bq[1],1);
}if(bp==3){return 365/br;
}return 360/br;
}function P(bt,br,bq,bp){var bs=k(bt,br,bq)[1];
return n(bt,bs,bp);
}function S(br,bq,bp){return k(br,bq,bp)[0];
}function Q(br,bq,bp){return k(br,bq,bp)[1];
}function R(bu,br,bp){var bt=bl(bu),bq=bl(br);
var bs=12*(bq.year-bt.year)+bq.month-bt.month;
return 1+(bs*bp/12|0);
}function X(bq,bp){if(bp==3){return 365;
}if(bp==1){return aG(bq)?366:365;
}return 360;
}function u(bq,br,bt,bs,bp){var bu=X(bl(br).year,bp);
return bt*bs*n(bq,br,bp)/bu;
}function t(by,bw,bG,bF,bC,bx,bs,bu){var bq=0,bv=bC*bF/bx;
var bt,bD,bz,bE,bA,bB;
var br=bs%2===0?360:365;
function bp(bH,bI){return(bI-bH)*bx/br|0;
}if(bG<=bw){bt=k(bG,bw,bx);
bD=bt[0];
bz=bt[1];
if(bD<=by){return bv*n(by,bG,bs)/n(bD,bz,bs);
}bt=k(by,bD,bx);
bE=bt[0];
bA=bt[1];
bB=bp(bA,bG);
return bv*(bB+n(by,bA,bs)/n(bE,bA,bs)+(bG<bz?n(bD,bG,bs)/n(bD,bz,bs):0));
}else{bt=l(bw,bG,bx);
bD=bt[0];
bz=bt[1];
bB=bp(bw,bG);
if(bz==bG){bq=bv*bB;
}else{bq=bv*(bB+n(bD,bG,bs)/n(bD,bz,bs));
}if(!bu){return bq;
}bt=k(by,bw,bx);
bD=bt[0];
bz=bt[1];
bB=bp(by,bw);
bq+=bv*(bB+n(by,bz,bs)/n(bD,bz,bs));
return bq;
}}function ab(bu,br,bs,bt,bq){var bp=bq%2===0?360:aG(bl(bu).year)?366:365;
return(bt-bs)/bt*bp/n(bu,br,bq);
}function aD(bu,bs,br,bt,bq){var bp=bq%2===0?360:aG(bl(bu).year)?366:365;
return(bt-br)/br*bp/n(bu,bs,bq);
}function a5(bu,bt,bs,br,bq){var bp=bq%2===0?360:aG(bl(bu).year)?366:365;
return bs/(1-br*n(bu,bt,bq)/bp);
}function a0(bC,bw,bA,bF,bB,bv,bp){var bx=1+((bw-bC)*bv/(bp%2===0?360:365)|0);
var bs=k(bC,bw,bv),bz=bs[0],by=bs[1];
var br=n(bz,bC,bp),bD=n(bC,by,bp),bq=n(bz,by,bp);
var bt=100*bA/bv,bE=bF/bv,bu=bD/bq;
if(bx==1){return(bB+bt)/(1+bu*bE)-br/bq*bt;
}return bB/Math.pow(1+bE,bx-1+bu)+bt*Math.pow(1+bE,1-bx-bu)*(Math.pow(1+bE,bx)-1)/bE-br/bq*bt;
}function a1(bv,bt,bq,bu,bp){var br=n(bv,bt,bp),bs=X(bl(bt).year,bp);
return bu-bq*bu*br/bs;
}},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/borderpalette",["kendo.core","kendo.colorpicker","kendo.popup"],l);
}(function(){(function(p){if(p.support.browser.msie&&p.support.browser.version<9){return;
}var k=p.jQuery;
var m=["allBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","outsideBorders","leftBorder","topBorder","rightBorder","bottomBorder","noBorders"];
var l=p.spreadsheet.messages.borderPalette={allBorders:"All borders",insideBorders:"Inside borders",insideHorizontalBorders:"Inside horizontal borders",insideVerticalBorders:"Inside vertical borders",outsideBorders:"Outside borders",leftBorder:"Left border",topBorder:"Top border",rightBorder:"Right border",bottomBorder:"Bottom border",noBorders:"No border",reset:"Reset color",customColor:"Custom color...",apply:"Apply",cancel:"Cancel"};
var o=p.ui.Widget.extend({init:function(q,r){p.ui.Widget.call(this,q,r);
this.element=q;
this.color=r.color;
this._resetButton();
this._colorPalette();
this._customColorPalette();
this._customColorButton();
this.resetButton.on("click",this.resetColor.bind(this));
this.customColorButton.on("click",this.customColor.bind(this));
},options:{name:"ColorChooser"},events:["change"],destroy:function(){p.unbind(this.dialog.element.find(".k-action-buttons"));
this.dialog.destroy();
this.colorPalette.destroy();
this.resetButton.off("click");
this.customColorButton.off("click");
},value:function(q){if(q!==j){this.color=q;
this.customColorButton.find(".k-icon").css("background-color",this.color);
this.colorPalette.value(null);
this.flatColorPicker.value(this.color);
}else{return this.color;
}},_change:function(q){this.color=q;
this.trigger("change",{value:q});
},_colorPalette:function(){var r=k("<div />",{"class":"k-spreadsheet-color-palette"});
var q=this.colorPalette=k("<div />").kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],value:this.color,change:function(s){this.customColorButton.find(".k-icon").css("background-color","transparent");
this.flatColorPicker.value(null);
this._change(s.value);
}.bind(this)}).data("kendoColorPalette");
r.append(q.wrapper).appendTo(this.element);
},_customColorPalette:function(){var r=k("<div />",{"class":"k-spreadsheet-window",html:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>"+l.apply+"</button><button class='k-button' data-bind='click: close'>"+l.cancel+"</button></div>"});
var q=this.dialog=r.appendTo(document.body).kendoWindow({animation:false,scrollable:false,resizable:false,maximizable:false,modal:true,visible:false,width:268,open:function(){this.center();
}}).data("kendoWindow");
q.one("activate",function(){this.element.find("[data-role=flatcolorpicker]").data("kendoFlatColorPicker")._hueSlider.resize();
});
var s=this.flatColorPicker=q.element.children().first().kendoFlatColorPicker().data("kendoFlatColorPicker");
var t=p.observable({apply:function(){this.customColorButton.find(".k-icon").css("background-color",s.value());
this.colorPalette.value(null);
this._change(s.value());
q.close();
}.bind(this),close:function(){s.value(null);
q.close();
}});
p.bind(q.element.find(".k-action-buttons"),t);
},_resetButton:function(){this.resetButton=k("<a class='k-button k-reset-color' href='#'><span class='k-icon k-font-icon k-i-reset-color'></span>"+l.reset+"</a>").appendTo(this.element);
},_customColorButton:function(){this.customColorButton=k("<a class='k-button k-custom-color' href='#'><span class='k-icon'></span>"+l.customColor+"</a>").appendTo(this.element);
},resetColor:function(){this.colorPalette.value(null);
this.flatColorPicker.value(null);
this._change(null);
},customColor:function(){this.dialog.open();
}});
var n=p.ui.Widget.extend({init:function(q,r){p.ui.Widget.call(this,q,r);
this.element=q;
this.color="#000";
this.element.addClass("k-spreadsheet-border-palette");
this._borderTypePalette();
this._borderColorPalette();
this.element.on("click",".k-spreadsheet-border-type-palette .k-button",this._click.bind(this));
},options:{name:"BorderPalette"},events:["change"],destroy:function(){this.colorChooser.destroy();
this.element.off("click");
},_borderTypePalette:function(){var s=l;
var q=m.map(function(t){return'<a title="'+s[t]+'" href="#" data-border-type="'+t+'" class="k-button k-button-icon"><span class="k-sprite k-font-icon k-icon k-i-'+p.toHyphens(t)+'"></span></a>';
}).join("");
var r=k("<div />",{"class":"k-spreadsheet-border-type-palette",html:q});
r.appendTo(this.element);
},_borderColorPalette:function(){var q=k("<div />",{"class":"k-spreadsheet-border-color-palette"});
q.appendTo(this.element);
this.colorChooser=new o(q,{color:this.color,change:this._colorChange.bind(this)});
},_click:function(q){this.type=k(q.currentTarget).data("borderType");
this.trigger("change",{type:this.type,color:this.color});
},_colorChange:function(q){this.color=q.value;
if(this.type){this.trigger("change",{type:this.type,color:this.color});
}}});
p.spreadsheet.ColorChooser=o;
p.spreadsheet.BorderPalette=n;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/toolbar",["kendo.toolbar","kendo.colorpicker","kendo.combobox","kendo.dropdownlist","kendo.popup","spreadsheet/borderpalette"],l);
}(function(){(function(I){if(I.support.browser.msie&&I.support.browser.version<9){return;
}var k=I.jQuery;
var S=I.ui.ToolBar;
var L=I.spreadsheet.messages.toolbar={addColumnLeft:"Add column left",addColumnRight:"Add column right",addRowAbove:"Add row above",addRowBelow:"Add row below",alignment:"Alignment",alignmentButtons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"},backgroundColor:"Background",bold:"Bold",borders:"Borders",colorPicker:{reset:"Reset color",customColor:"Custom color..."},copy:"Copy",cut:"Cut",deleteColumn:"Delete column",deleteRow:"Delete row",filter:"Filter",fontFamily:"Font",fontSize:"Font size",format:"Custom format...",formatTypes:{automatic:"Automatic",number:"Number",percent:"Percent",financial:"Financial",currency:"Currency",date:"Date",time:"Time",dateTime:"Date time",duration:"Duration",moreFormats:"More formats..."},formatDecreaseDecimal:"Decrease decimal",formatIncreaseDecimal:"Increase decimal",freeze:"Freeze panes",freezeButtons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"},italic:"Italic",merge:"Merge cells",mergeButtons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"},open:"Open...",paste:"Paste",quickAccess:{redo:"Redo",undo:"Undo"},exportAs:"Export...",sortAsc:"Sort ascending",sortDesc:"Sort descending",sortButtons:{sortSheetAsc:"Sort sheet A to Z",sortSheetDesc:"Sort sheet Z to A",sortRangeAsc:"Sort range A to Z",sortRangeDesc:"Sort range Z to A"},textColor:"Text Color",textWrap:"Wrap text",underline:"Underline",validation:"Data validation..."};
var u={home:["open","exportAs",["cut","copy","paste"],["bold","italic","underline"],"backgroundColor","textColor","borders","fontSize","fontFamily","alignment","textWrap",["formatDecreaseDecimal","formatIncreaseDecimal"],"format","merge","freeze","filter"],insert:[["addColumnLeft","addColumnRight","addRowBelow","addRowAbove"],["deleteColumn","deleteRow"]],data:["sort","filter","validation"]};
var T={open:{type:"open",overflow:"never",iconClass:"xlsa"},exportAs:{type:"exportAsDialog",dialogName:"exportAs",overflow:"never",text:"",iconClass:"xlsa"},bold:{type:"button",command:"PropertyChangeCommand",property:"bold",value:true,iconClass:"bold",togglable:true},italic:{type:"button",command:"PropertyChangeCommand",property:"italic",value:true,iconClass:"italic",togglable:true},underline:{type:"button",command:"PropertyChangeCommand",property:"underline",value:true,iconClass:"underline",togglable:true},formatDecreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:-1,iconClass:"decrease-decimal"},formatIncreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:+1,iconClass:"increase-decimal"},textWrap:{type:"button",command:"TextWrapCommand",property:"wrap",value:true,iconClass:"text-wrap",togglable:true},cut:{type:"button",command:"ToolbarCutCommand",iconClass:"cut"},copy:{type:"button",command:"ToolbarCopyCommand",iconClass:"copy"},paste:{type:"button",command:"ToolbarPasteCommand",iconClass:"paste"},separator:{type:"separator"},alignment:{type:"alignment",iconClass:"justify-left"},backgroundColor:{type:"colorPicker",property:"background",iconClass:"background"},textColor:{type:"colorPicker",property:"color",iconClass:"text"},fontFamily:{type:"fontFamily",property:"fontFamily",iconClass:"text"},fontSize:{type:"fontSize",property:"fontSize",iconClass:"font-size"},format:{type:"format",property:"format",iconClass:"format-number"},filter:{type:"filter",property:"hasFilter",iconClass:"filter"},merge:{type:"merge",iconClass:"merge-cells"},freeze:{type:"freeze",iconClass:"freeze-panes"},borders:{type:"borders",iconClass:"all-borders"},formatCells:{type:"dialog",dialogName:"formatCells",overflow:"never"},addColumnLeft:{type:"button",command:"AddColumnCommand",value:"left",iconClass:"add-column-left"},addColumnRight:{type:"button",command:"AddColumnCommand",value:"right",iconClass:"add-column-right"},addRowBelow:{type:"button",command:"AddRowCommand",value:"below",iconClass:"add-row-below"},addRowAbove:{type:"button",command:"AddRowCommand",value:"above",iconClass:"add-row-above"},deleteColumn:{type:"button",command:"DeleteColumnCommand",iconClass:"delete-column"},deleteRow:{type:"button",command:"DeleteRowCommand",iconClass:"delete-row"},sort:{type:"sort",iconClass:"sort-desc"},validation:{type:"dialog",dialogName:"validation",iconClass:"exception",overflow:"never"}};
var R=S.extend({init:function(U,W){W.items=this._expandTools(W.tools||R.prototype.options.tools[W.toolbarName]);
S.fn.init.call(this,U,W);
var V=this._click.bind(this);
this.element.addClass("k-spreadsheet-toolbar");
this._addSeparators(this.element);
this.bind({click:V,toggle:V});
},_addSeparators:function(U){var V=U.children(".k-widget, a.k-button, .k-button-group");
V.before("<span class='k-separator' />");
},_expandTools:function(V){function U(Z){var W=k.isPlainObject(Z)?Z:T[Z]||{};
var X="k-icon k-font-icon k-i-"+W.iconClass;
var aa=W.type;
var ab={splitButton:{spriteCssClass:X},button:{showText:"overflow"},colorPicker:{toolIcon:X}};
var Y=k.extend({name:W.name||Z,text:L[W.name||Z],spriteCssClass:X,attributes:{title:L[W.name||Z]}},ab[aa],W);
if(aa=="splitButton"){Y.menuButtons=Y.menuButtons.map(U);
}Y.attributes["data-tool"]=Z;
if(W.property){Y.attributes["data-property"]=W.property;
}return Y;
}return V.reduce(function(X,W){if(k.isArray(W)){X.push({type:"buttonGroup",buttons:W.map(U)});
}else{X.push(U.call(this,W));
}return X;
},[]);
},_click:function(W){var Y=W.target.attr("data-tool");
var X=T[Y]||{};
var V=X.command;
if(!V){return;
}var U={command:V,options:{property:X.property||null,value:X.value||null}};
if(typeof U.options.value==="boolean"){U.options.value=W.checked?true:null;
}this.action(U);
},events:["click","toggle","open","close","overflowOpen","overflowClose","action","dialog"],options:{name:"SpreadsheetToolBar",resizable:true,tools:u},action:function(U){this.trigger("action",U);
},dialog:function(U){this.trigger("dialog",U);
},refresh:function(U){var X=U;
var aa=this._tools();
function Y(ag,ai){var ah=ag.toolbar;
var ad=ag.overflow;
var ae=ah&&ah.options.togglable||ad&&ad.options.togglable;
if(!ae){return;
}var af=false;
if(typeof ai==="boolean"){af=ai;
}else{if(typeof ai==="string"){af=ah.options.value===ai;
}}ah.toggle(af);
if(ad){ad.toggle(af);
}}function ab(ae,ag){var af=ae.toolbar;
var ad=ae.overflow;
if(af&&af.update){af.update(ag);
}if(ad&&ad.update){ad.update(ag);
}}for(var V=0;
V<aa.length;
V++){var W=aa[V].property;
var Z=aa[V].tool;
var ac=I.isFunction(X[W])?X[W]():X;
if(Z.type==="button"){Y(Z,ac);
}else{ab(Z,ac);
}}},_tools:function(){return this.element.find("[data-property]").toArray().reduce(function(W,U){U=k(U);
var V=U.attr("data-property");
W.push({property:V,tool:this._getItem(U)});
return W;
}.bind(this),[]);
},destroy:function(){this.element.find("[data-command],.k-button").each(function(){var U=k(this);
var V=U.data("instance");
if(V&&V.destroy){V.destroy();
}});
S.fn.destroy.call(this);
}});
I.spreadsheet.ToolBar=R;
var v=I.toolbar.Item.extend({init:function(V,W){var U=k("<select />").kendoDropDownList({height:"auto"}).data("kendoDropDownList");
this.dropDownList=U;
this.element=U.wrapper;
this.options=V;
this.toolbar=W;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
U.bind("open",this._open.bind(this));
U.bind("change",this._change.bind(this));
this.element.width(V.width).attr({"data-command":"PropertyChangeCommand","data-property":V.property});
},_open:function(){var U=this.dropDownList;
var V=U.list;
var W;
V.css({whiteSpace:"nowrap",width:"auto"});
W=V.width();
if(W){W+=20;
}else{W=U._listWidth;
}V.css("width",W+I.support.scrollbar());
U._listWidth=W;
},_change:function(V){var W=V.sender;
var Y=W.value();
var U=W.dataItem();
var X=U?U.popup:j;
if(X){this.toolbar.dialog({name:X});
}else{this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:Y=="null"?null:Y}});
}},value:function(U){if(U!==j){this.dropDownList.value(U);
}else{return this.dropDownList.value();
}}});
var O=I.toolbar.Item.extend({init:function(U,V){this.element=k("<a href='#' class='k-button k-button-icon'><span class='"+U.spriteCssClass+"'></span><span class='k-icon k-i-arrow-s'></span></a>");
this.element.on("click",this.open.bind(this)).attr("data-command",U.command);
this.options=U;
this.toolbar=V;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
this._popup();
},destroy:function(){this.popup.destroy();
},open:function(){this.popup.toggle();
},_popup:function(){var U=this.element;
this.popup=k("<div class='k-spreadsheet-popup' />").appendTo(U).kendoPopup({anchor:U}).data("kendoPopup");
}});
I.toolbar.registerComponent("dialog",I.toolbar.ToolBarButton.extend({init:function(U,V){I.toolbar.ToolBarButton.fn.init.call(this,U,V);
this._dialogName=U.dialogName;
this.element.bind("click",this.open.bind(this)).data("instance",this);
},open:function(){this.toolbar.dialog({name:this._dialogName});
}}));
I.toolbar.registerComponent("exportAsDialog",I.toolbar.Item.extend({init:function(U,V){this._dialogName=U.dialogName;
this.toolbar=V;
this.element=k("<button class='k-button k-button-icon' title='"+U.attributes.title+"'><span class='k-icon k-font-icon k-i-xls' /></button>").data("instance",this);
this.element.bind("click",this.open.bind(this)).data("instance",this);
},open:function(){this.toolbar.dialog({name:this._dialogName});
}}));
var N=I.toolbar.OverflowButton.extend({init:function(V,W){I.toolbar.OverflowButton.fn.init.call(this,V,W);
this.element.on("click",this._click.bind(this));
this.message=this.options.text;
var U=this.element.data("button");
this.element.data(this.options.type,U);
},_click:k.noop});
var p=O.extend({init:function(U,V){O.fn.init.call(this,U,V);
this.popup.element.addClass("k-spreadsheet-colorpicker");
this.colorChooser=new I.spreadsheet.ColorChooser(this.popup.element,{change:this._colorChange.bind(this)});
this.element.attr({"data-property":U.property});
this.element.data({type:"colorPicker",colorPicker:this,instance:this});
},destroy:function(){this.colorChooser.destroy();
O.fn.destroy.call(this);
},update:function(U){this.value(U);
},value:function(U){this.colorChooser.value(U);
},_colorChange:function(U){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:U.sender.value()}});
this.popup.close();
}});
var q=N.extend({init:function(U,V){U.iconName="text";
N.fn.init.call(this,U,V);
},_click:function(){this.toolbar.dialog({name:"colorPicker",options:{title:this.options.property,property:this.options.property}});
}});
I.toolbar.registerComponent("colorPicker",p,q);
var z=[8,9,10,11,12,13,14,16,18,20,22,24,26,28,36,48,72];
var s=12;
var C=I.toolbar.Item.extend({init:function(V,W){var U=k("<input />").kendoComboBox({change:this._valueChange.bind(this),dataSource:V.fontSizes||z,value:s}).data("kendoComboBox");
this.comboBox=U;
this.element=U.wrapper;
this.options=V;
this.toolbar=W;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
this.element.width(V.width).attr({"data-command":"PropertyChangeCommand","data-property":V.property});
this.element.data({type:"fontSize",fontSize:this});
},_valueChange:function(U){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:I.parseInt(U.sender.value())}});
},update:function(U){this.value(I.parseInt(U)||s);
},value:function(U){if(U!==j){this.comboBox.value(U);
}else{return this.comboBox.value();
}}});
var D=N.extend({_click:function(){this.toolbar.dialog({name:"fontSize",options:{sizes:z,defaultSize:s}});
},update:function(U){this._value=U||s;
this.element.find(".k-text").text(this.message+" ("+this._value+") ...");
}});
I.toolbar.registerComponent("fontSize",C,D);
var y=["Arial","Courier New","Georgia","Times New Roman","Trebuchet MS","Verdana"];
var r="Arial";
var A=v.extend({init:function(V,W){v.fn.init.call(this,V,W);
var U=this.dropDownList;
U.setDataSource(V.fontFamilies||y);
U.value(r);
this.element.data({type:"fontFamily",fontFamily:this});
},update:function(U){this.value(U||r);
}});
var B=N.extend({_click:function(){this.toolbar.dialog({name:"fontFamily",options:{fonts:y,defaultFont:r}});
},update:function(U){this._value=U||r;
this.element.find(".k-text").text(this.message+" ("+this._value+") ...");
}});
I.toolbar.registerComponent("fontFamily",A,B);
var t=I.spreadsheet.formats={automatic:null,number:"#,0.00",percent:"0.00%",financial:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',currency:"$#,##0.00;[Red]$#,##0.00",date:"m/d/yyyy",time:"h:mm:ss AM/PM",dateTime:"m/d/yyyy h:mm",duration:"[h]:mm:ss"};
var E=v.extend({_revertTitle:function(U){U.sender.value("");
U.sender.wrapper.width("auto");
},init:function(W,X){v.fn.init.call(this,W,X);
var U=this.dropDownList;
var V="<span class='k-icon k-font-icon k-i-"+W.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>";
U.bind("change",this._revertTitle.bind(this));
U.bind("dataBound",this._revertTitle.bind(this));
U.setOptions({dataValueField:"format",dataTextField:"name",dataValuePrimitive:true,valueTemplate:V,template:"# if (data.sample) { #<span class='k-spreadsheet-sample'>#: data.sample #</span># } ##: data.name #"});
U.text(V);
U.setDataSource([{format:t.automatic,name:L.formatTypes.automatic},{format:t.number,name:L.formatTypes.number,sample:"1,499.99"},{format:t.percent,name:L.formatTypes.percent,sample:"14.50%"},{format:t.financial,name:L.formatTypes.financial,sample:"(1,000.12)"},{format:t.currency,name:L.formatTypes.currency,sample:"$1,499.99"},{format:t.date,name:L.formatTypes.date,sample:"4/21/2012"},{format:t.time,name:L.formatTypes.time,sample:"5:49:00 PM"},{format:t.dateTime,name:L.formatTypes.dateTime,sample:"4/21/2012 5:49:00"},{format:t.duration,name:L.formatTypes.duration,sample:"168:05:00"},{popup:"formatCells",name:L.formatTypes.moreFormats}]);
this.element.data({type:"format",format:this});
}});
var F=N.extend({_click:function(){this.toolbar.dialog({name:"formatCells"});
}});
I.toolbar.registerComponent("format",E,F);
var o=O.extend({init:function(U,V){O.fn.init.call(this,U,V);
this._borderPalette();
this.element.data({type:"borders",instance:this});
},destroy:function(){this.borderPalette.destroy();
O.fn.destroy.call(this);
},_borderPalette:function(){var U=k("<div />").appendTo(this.popup.element);
this.borderPalette=new I.spreadsheet.BorderPalette(U,{change:this._action.bind(this)});
},_action:function(U){this.toolbar.action({command:"BorderChangeCommand",options:{border:U.type,style:{size:1,color:U.color}}});
}});
var n=N.extend({_click:function(){this.toolbar.dialog({name:"borders"});
}});
I.toolbar.registerComponent("borders",o,n);
var m=O.extend({init:function(U,V){O.fn.init.call(this,U,V);
this.element.attr({"data-property":"alignment"});
this._commandPalette();
this.popup.element.on("click",".k-button",function(W){this._action(k(W.currentTarget));
}.bind(this));
this.element.data({type:"alignment",alignment:this,instance:this});
},buttons:[{property:"textAlign",value:"left",iconClass:"justify-left",text:L.alignmentButtons.justtifyLeft},{property:"textAlign",value:"center",iconClass:"justify-center",text:L.alignmentButtons.justifyCenter},{property:"textAlign",value:"right",iconClass:"justify-right",text:L.alignmentButtons.justifyRight},{property:"textAlign",value:"justify",iconClass:"justify-full",text:L.alignmentButtons.justifyFull},{property:"verticalAlign",value:"top",iconClass:"align-top",text:L.alignmentButtons.alignTop},{property:"verticalAlign",value:"center",iconClass:"align-middle",text:L.alignmentButtons.alignMiddle},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom",text:L.alignmentButtons.alignBottom}],destroy:function(){this.popup.element.off();
O.fn.destroy.call(this);
},update:function(U){var V=U.textAlign();
var W=U.verticalAlign();
this.popup.element.find(".k-button").removeClass("k-state-active");
if(V){this.popup.element.find(".k-button[data-value="+V+"]").addClass("k-state-active");
}if(W){this.popup.element.find(".k-button[data-value="+W+"]").addClass("k-state-active");
}},_commandPalette:function(){var U=this.buttons;
var V=k("<div />").appendTo(this.popup.element);
U.forEach(function(Y,X){var W="<a title='"+Y.text+"' data-property='"+Y.property+"' data-value='"+Y.value+"' class='k-button k-button-icon'><span class='k-icon k-font-icon k-i-"+Y.iconClass+"'></span></a>";
if(X!==0&&U[X-1].property!==Y.property){V.append(k("<span class='k-separator' />"));
}V.append(W);
});
},_action:function(U){var V=U.attr("data-property");
var W=U.attr("data-value");
this.toolbar.action({command:"PropertyChangeCommand",options:{property:V,value:W}});
}});
var l=N.extend({_click:function(){this.toolbar.dialog({name:"alignment"});
}});
I.toolbar.registerComponent("alignment",m,l);
var K=O.extend({init:function(U,V){O.fn.init.call(this,U,V);
this._commandPalette();
this.popup.element.on("click",".k-button",function(W){this._action(k(W.currentTarget));
}.bind(this));
this.element.data({type:"merge",merge:this,instance:this});
},buttons:[{value:"cells",iconClass:"merge-cells",text:L.mergeButtons.mergeCells},{value:"horizontally",iconClass:"merge-horizontally",text:L.mergeButtons.mergeHorizontally},{value:"vertically",iconClass:"merge-vertically",text:L.mergeButtons.mergeVertically},{value:"unmerge",iconClass:"normal-layout",text:L.mergeButtons.unmerge}],destroy:function(){this.popup.element.off();
O.fn.destroy.call(this);
},_commandPalette:function(){var U=k("<div />").appendTo(this.popup.element);
this.buttons.forEach(function(W){var V="<a title='"+W.text+"' data-value='"+W.value+"' class='k-button k-button-icontext'><span class='k-icon k-font-icon k-i-"+W.iconClass+"'></span>"+W.text+"</a>";
U.append(V);
});
},_action:function(U){var V=U.attr("data-value");
this.toolbar.action({command:"MergeCellCommand",options:{value:V}});
}});
var J=N.extend({_click:function(){this.toolbar.dialog({name:"merge"});
}});
I.toolbar.registerComponent("merge",K,J);
var H=O.extend({init:function(U,V){O.fn.init.call(this,U,V);
this._commandPalette();
this.popup.element.on("click",".k-button",function(W){this._action(k(W.currentTarget));
}.bind(this));
this.element.data({type:"freeze",freeze:this,instance:this});
},buttons:[{value:"panes",iconClass:"freeze-panes",text:L.freezeButtons.freezePanes},{value:"rows",iconClass:"freeze-row",text:L.freezeButtons.freezeRows},{value:"columns",iconClass:"freeze-col",text:L.freezeButtons.freezeColumns},{value:"unfreeze",iconClass:"normal-layout",text:L.freezeButtons.unfreeze}],destroy:function(){this.popup.element.off();
O.fn.destroy.call(this);
},_commandPalette:function(){var U=k("<div />").appendTo(this.popup.element);
this.buttons.forEach(function(W){var V="<a title='"+W.text+"' data-value='"+W.value+"' class='k-button k-button-icontext'><span class='k-icon k-font-icon k-i-"+W.iconClass+"'></span>"+W.text+"</a>";
U.append(V);
});
},_action:function(U){var V=U.attr("data-value");
this.toolbar.action({command:"FreezePanesCommand",options:{value:V}});
}});
var G=N.extend({_click:function(){this.toolbar.dialog({name:"freeze"});
}});
I.toolbar.registerComponent("freeze",H,G);
var P=v.extend({_revertTitle:function(U){U.sender.value("");
U.sender.wrapper.width("auto");
},init:function(V,W){v.fn.init.call(this,V,W);
var U=this.dropDownList;
U.bind("change",this._revertTitle.bind(this));
U.bind("dataBound",this._revertTitle.bind(this));
U.setOptions({valueTemplate:"<span class='k-icon k-font-icon k-i-"+V.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>",template:"<span class='k-icon k-font-icon k-i-#= iconClass #' style='line-height: 1em; width: 1.35em;'></span>#=text#",dataTextField:"text",dataValueField:"value"});
U.setDataSource([{value:"asc",sheet:false,text:L.sortButtons.sortRangeAsc,iconClass:"sort-asc"},{value:"desc",sheet:false,text:L.sortButtons.sortRangeDesc,iconClass:"sort-desc"}]);
U.select(0);
this.element.data({type:"sort",sort:this});
},_change:function(V){var W=V.sender;
var U=W.dataItem();
if(U){this.toolbar.action({command:"SortCommand",options:{value:U.value,sheet:U.sheet}});
}},value:k.noop});
var Q=N.extend({_click:function(){this.toolbar.dialog({name:"sort"});
}});
I.toolbar.registerComponent("sort",P,Q);
var w=I.toolbar.ToolBarButton.extend({init:function(U,V){U.showText="overflow";
I.toolbar.ToolBarButton.fn.init.call(this,U,V);
this.element.on("click",this._click.bind(this));
this.element.data({type:"filter",filter:this});
},_click:function(){this.toolbar.action({command:"FilterCommand"});
},update:function(U){this.toggle(U);
}});
var x=N.extend({init:function(U,V){N.fn.init.call(this,U,V);
this.element.data({type:"filter",filter:this});
},_click:function(){this.toolbar.action({command:"FilterCommand"});
},update:function(U){this.toggle(U);
}});
I.toolbar.registerComponent("filter",w,x);
var M=I.toolbar.Item.extend({init:function(U,V){this.toolbar=V;
this.element=k("<div class='k-button k-upload-button k-button-icon'><span class='k-icon k-font-icon k-i-folder-open' /></div>").data("instance",this);
k("<input type='file' autocomplete='off' accept='.xlsx'/>").attr("title",U.attributes.title).bind("change",this._change.bind(this)).appendTo(k("<form>").appendTo(this.element));
},_change:function(U){this.toolbar.action({command:"OpenCommand",options:{file:U.target.files[0]}});
U.target.parentNode.reset();
}});
I.toolbar.registerComponent("open",M);
I.spreadsheet.TabStrip=I.ui.TabStrip.extend({init:function(U,V){I.ui.TabStrip.fn.init.call(this,U,V);
U.addClass("k-spreadsheet-tabstrip");
this._quickAccessButtons();
this.quickAccessToolBar.on("click",".k-button",function(Y){var X=k(Y.currentTarget).attr("title").toLowerCase();
this.trigger("action",{action:X});
}.bind(this));
this.toolbars={};
var W=V.dataSource;
this.contentElements.each(function(Y,X){this._toolbar(k(X),W[Y].id,V.toolbarOptions[W[Y].id]);
}.bind(this));
this.one("activate",function(){this.toolbars[this.options.dataSource[0].id].resize();
});
},events:I.ui.TabStrip.fn.events.concat(["action","dialog"]),destroy:function(){this.quickAccessToolBar.off("click");
I.ui.TabStrip.fn.destroy.call(this);
for(var U in this.toolbars){this.toolbars[U].destroy();
}},action:function(U){this.trigger("action",U);
},dialog:function(U){this.trigger("dialog",U);
},refreshTools:function(V){var W=this.toolbars;
for(var U in W){if(W.hasOwnProperty(U)){W[U].refresh(V);
}}},_quickAccessButtons:function(){var U=[{title:L.quickAccess.undo,iconClass:"undo-large",action:"undo"},{title:L.quickAccess.redo,iconClass:"redo-large",action:"redo"}];
var V=I.template("<a href='\\#' title='#= title #' data-action='#= action #' class='k-button k-button-icon'><span class='k-icon k-font-icon k-i-#=iconClass#'></span></a>");
this.quickAccessToolBar=k("<div />",{"class":"k-spreadsheet-quick-access-toolbar",html:I.render(V,U)}).insertBefore(this.wrapper);
this.quickAccessToolBar.on("click",".k-button",function(X){X.preventDefault();
var W=k(X.currentTarget).attr("title").toLowerCase();
this.action({action:W});
}.bind(this));
this.quickAccessAdjust();
},quickAccessAdjust:function(){this.tabGroup.css("padding-left",this.quickAccessToolBar.outerWidth());
},_toolbar:function(U,W,Y){var V;
var X;
if(this.toolbars[W]){this.toolbars[W].destroy();
U.children(".k-toolbar").remove();
}if(Y){V=U.html("<div />").children("div");
X={tools:typeof Y==="boolean"?j:Y,toolbarName:W,action:this.action.bind(this),dialog:this.dialog.bind(this)};
this.toolbars[W]=new I.spreadsheet.ToolBar(V,X);
}}});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/dialogs",["kendo.core","kendo.binder","kendo.validator"],l);
}(function(){(function(x){if(x.support.browser.msie&&x.support.browser.version<9){return;
}var k=x.jQuery;
var C=x.data.ObservableObject;
var A=x.spreadsheet.messages.dialogs={apply:"Apply",save:"Save",cancel:"Cancel",remove:"Remove",okText:"OK",formatCellsDialog:{title:"Format",categories:{number:"Number",currency:"Currency",date:"Date"}},fontFamilyDialog:{title:"Font"},fontSizeDialog:{title:"Font size"},bordersDialog:{title:"Borders"},alignmentDialog:{title:"Alignment",buttons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"}},mergeDialog:{title:"Merge cells",buttons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"}},freezeDialog:{title:"Freeze panes",buttons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"}},validationDialog:{title:"Data Validation",hintMessage:"Please enter a valid {0} value {1}.",hintTitle:"Validation {0}",criteria:{any:"Any value",number:"Number",text:"Text",date:"Date",custom:"Custom Formula",list:"List"},comparers:{greaterThan:"greater than",lessThan:"less than",between:"between",notBetween:"not between",equalTo:"equal to",notEqualTo:"not equal to",greaterThanOrEqualTo:"greater than or equal to",lessThanOrEqualTo:"less than or equal to"},comparerMessages:{greaterThan:"greater than {0}",lessThan:"less than {0}",between:"between {0} and {1}",notBetween:"not between {0} and {1}",equalTo:"equal to {0}",notEqualTo:"not equal to {0}",greaterThanOrEqualTo:"greater than or equal to {0}",lessThanOrEqualTo:"less than or equal to {0}",custom:"that satisfies the formula: {0}"},labels:{criteria:"Criteria",comparer:"Comparer",min:"Min",max:"Max",value:"Value",start:"Start",end:"End",onInvalidData:"On invalid data",rejectInput:"Reject input",showWarning:"Show warning",showHint:"Show hint",hintTitle:"Hint title",hintMessage:"Hint message",ignoreBlank:"Ignore blank"},placeholders:{typeTitle:"Type title",typeMessage:"Type message"}},exportAsDialog:{title:"Export...",labels:{scale:"Scale",fit:"Fit to page",fileName:"File name",saveAsType:"Save as type",exportArea:"Export",paperSize:"Paper size",margins:"Margins",orientation:"Orientation",print:"Print",guidelines:"Guidelines",center:"Center",horizontally:"Horizontally",vertically:"Vertically"}},modifyMergedDialog:{errorMessage:"Cannot change part of a merged cell."},useKeyboardDialog:{title:"Copying and pasting",errorMessage:"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:",labels:{forCopy:"for copy",forCut:"for cut",forPaste:"for paste"}},unsupportedSelectionDialog:{errorMessage:"That action cannot be performed on multiple selection."}};
var D={};
x.spreadsheet.dialogs={register:function(L,K){D[L]=K;
},create:function(L,M){var K=D[L];
if(K){return new K(M);
}}};
var E=x.spreadsheet.SpreadsheetDialog=x.Observable.extend({init:function(K){x.Observable.fn.init.call(this,K);
this.options=k.extend(true,{},this.options,K);
this.bind(this.events,K);
},events:["close","activate"],dialog:function(){if(!this._dialog){this._dialog=k("<div class='k-spreadsheet-window k-action-window' />").addClass(this.options.className||"").append(this.options.template).appendTo(document.body).kendoWindow({scrollable:false,resizable:false,maximizable:false,modal:true,visible:false,width:this.options.width||320,title:this.options.title,open:function(){this.center();
},close:this._onDialogClose.bind(this),activate:this._onDialogActivate.bind(this),deactivate:this._onDialogDeactivate.bind(this)}).data("kendoWindow");
}return this._dialog;
},_onDialogClose:function(){this.trigger("close");
},_onDialogActivate:function(){this.trigger("activate");
},_onDialogDeactivate:function(){this.trigger("deactivate");
this.destroy();
},destroy:function(){if(this._dialog){this._dialog.destroy();
this._dialog=null;
}},open:function(){this.dialog().open();
},apply:function(){this.close();
},close:function(){this.dialog().close();
}});
function v(L,K){return x.spreadsheet.formatting.text(L,K);
}var u=x.spreadsheet.FormatCellsViewModel=C.extend({init:function(K){C.fn.init.call(this,K);
this.useCategory(this.category);
},useCategory:function(K){var M=K&&K.type||"number";
var L=M=="currency";
this.category=K;
this.set("showCurrencyFilter",L&&this.currencies.length>1);
if(!L){this.set("formats",this.allFormats[M+"Formats"]);
}else{this.currency(this.currencies[0]);
}this.useFirstFormat();
},useFirstFormat:function(){if(this.formats.length){this.set("format",this.formats[0].value);
}},currency:function(K){if(K!==j){this._currency=K;
var M=K.value;
var L=[{currency:M,decimals:true},{currency:M,decimals:true,iso:true},{currency:M,decimals:false}];
L=L.map(function(N){N=u.convert.currency(N);
return{value:N,name:v(1000,N)};
});
this.set("formats",L);
this.useFirstFormat();
}return this._currency||this.currencies[0];
},categoryFilter:function(K){if(K!==j){this.useCategory(K);
}return this.category;
},preview:function(){var K=this.get("format");
var L=this.value||0;
if(K&&K.length){return v(L,K);
}else{return L;
}}});
u.convert={currency:function(M){function N(P,O){return new Array(O+1).join(P);
}var L=M.currency;
var K=L.pattern[1];
if(M.decimals){K=K.replace(/n/g,"n"+L["."]+N("0",L.decimals));
}if(M.iso){K='"'+L.abbr+'" '+K.replace(/\s*\$\s*/g,"");
}else{K=K.replace(/\$/g,L.symbol);
}K=K.replace(/n/g,"?");
return K;
},date:function(K){if(/T|Z/.test(K)){return"";
}return K.toLowerCase().replace(/tt/g,"AM/PM").replace(/'/g,'"');
}};
function F(L,K){var N=[];
var O=[];
for(var M=0;
M<K.length;
M++){if(k.inArray(K[M][L],O)==-1){N.push(K[M]);
O.push(K[M][L]);
}}return N;
}var t=E.extend({init:function(K){E.fn.init.call(this,K);
this._generateFormats();
},options:{title:A.formatCellsDialog.title,className:"k-spreadsheet-format-cells",categories:[{type:"number",name:A.formatCellsDialog.categories.number},{type:"currency",name:A.formatCellsDialog.categories.currency},{type:"date",name:A.formatCellsDialog.categories.date}],template:"<div class='k-root-tabs' data-role='tabstrip' data-text-field='name' data-bind='source: categories, value: categoryFilter' data-animation='false' /><div class='k-spreadsheet-preview' data-bind='text: preview' /><script type='text/x-kendo-template' id='format-item-template'>#: data.name #</script><select data-role='dropdownlist' class='k-format-filter' data-text-field='description' data-value-field='value.name' data-bind='visible: showCurrencyFilter, value: currency, source: currencies' /><ul data-role='staticlist' tabindex='0' class='k-list k-reset' data-template='format-item-template' data-value-primitive='true' data-value-field='value' data-bind='source: formats, value: format' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>"+A.apply+"</button><button class='k-button' data-bind='click: close'>"+A.cancel+"</button></div>"},_generateFormats:function(){var L=this.options;
if(!L.currencies){L.currencies=t.currenciesFrom(x.cultures);
}if(!L.numberFormats){L.numberFormats=[{value:"#.00%",name:"100.00%"},{value:"#%",name:"100%"},{value:"#.00",name:"1024.00"},{value:"#,###.00",name:"1,024.00"}];
}if(!L.dateFormats){var K=x.cultures.current.calendars.standard.patterns;
L.dateFormats=F("value",k.map(K,function(M){M=u.convert.date(M);
if(!M){return;
}return{value:M,name:v(34567.7678,M)};
}));
}},open:function(O){var N=this.options;
var P=O.value();
var K=N.categories.slice(0);
var M;
this.viewModel=new u({currencies:N.currencies.slice(0),allFormats:{numberFormats:N.numberFormats.slice(0),dateFormats:N.dateFormats.slice(0)},categories:K,format:O.format(),category:P instanceof Date?K[2]:K[0],apply:this.apply.bind(this),close:this.close.bind(this),value:P});
E.fn.open.call(this);
M=this.dialog().element;
x.bind(M,this.viewModel);
var L=M.find("select.k-format-filter").data("kendoDropDownList");
if(N.currencies.length>10){L.setOptions({filter:"contains"});
}M.find(x.roleSelector("staticlist")).parent().addClass("k-list-wrapper");
},apply:function(){var K=this.viewModel.format;
E.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"format",value:K}});
}});
t.currenciesFrom=function(K){return F("description",k.map(K,function(L,O){if(!/-/.test(O)){return;
}var M=L.numberFormat.currency;
var N=x.format("{0} ({1}, {2})",M.name,M.abbr,M.symbol);
return{description:N,value:M};
}));
};
x.spreadsheet.dialogs.register("formatCells",t);
x.spreadsheet.dialogs.FormatCellsDialog=t;
var z=E.extend({options:{className:"k-spreadsheet-message",title:"",text:"",template:"<div class='k-spreadsheet-message-content' data-bind='text: text' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: close, text: okText' /></div>"},open:function(){E.fn.open.call(this);
x.bind(this.dialog().element,{text:this.options.text,okText:A.okText,close:this.close.bind(this)});
}});
x.spreadsheet.dialogs.register("message",z);
var r=E.extend({init:function(K){E.fn.init.call(this,K);
this._list();
},options:{title:A.fontFamilyDialog.title,template:"<ul class='k-list k-reset'></ul>"},_list:function(){var M=this.dialog().element.find("ul");
var L=this.options.fonts;
var K=this.options.defaultFont;
this.list=new x.ui.StaticList(M,{dataSource:new x.data.DataSource({data:L}),template:"#:data#",value:K,change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(K){E.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontFamily",value:K.sender.value()[0]}});
}});
x.spreadsheet.dialogs.register("fontFamily",r);
var s=E.extend({init:function(K){E.fn.init.call(this,K);
this._list();
},options:{title:A.fontSizeDialog.title,template:"<ul class='k-list k-reset'></ul>"},_list:function(){var M=this.dialog().element.find("ul");
var L=this.options.sizes;
var K=this.options.defaultSize;
this.list=new x.ui.StaticList(M,{dataSource:new x.data.DataSource({data:L}),template:"#:data#",value:K,change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(K){E.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontSize",value:x.parseInt(K.sender.value()[0])}});
}});
x.spreadsheet.dialogs.register("fontSize",s);
var m=E.extend({init:function(K){E.fn.init.call(this,K);
this.element=this.dialog().element;
this._borderPalette();
this.viewModel=x.observable({apply:this.apply.bind(this),close:this.close.bind(this)});
x.bind(this.element.find(".k-action-buttons"),this.viewModel);
},options:{title:A.bordersDialog.title,width:177,template:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>"+A.apply+"</button><button class='k-button' data-bind='click: close'>"+A.cancel+"</button></div>"},apply:function(){E.fn.apply.call(this);
var K=this.value();
this.trigger("action",{command:"BorderChangeCommand",options:{border:K.type,style:{size:1,color:K.color}}});
},_borderPalette:function(){var K=this.dialog().element.find("div:first");
this.borderPalette=new x.spreadsheet.BorderPalette(K,{change:this.value.bind(this)});
},value:function(K){if(K===j){return this._state;
}else{this._state=K;
}}});
x.spreadsheet.dialogs.register("borders",m);
var n=E.extend({init:function(K){E.fn.init.call(this,K);
this.element=this.dialog().element;
this.property=K.property;
this.options.title=K.title;
this.viewModel=x.observable({apply:this.apply.bind(this),close:this.close.bind(this)});
x.bind(this.element.find(".k-action-buttons"),this.viewModel);
},options:{template:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>"+A.apply+"</button><button class='k-button' data-bind='click: close'>"+A.cancel+"</button></div>"},apply:function(){E.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:this.property,value:this.value()}});
},value:function(K){if(K===j){return this._value;
}else{this._value=K.value;
}}});
var o=n.extend({init:function(K){K.width=177;
n.fn.init.call(this,K);
this._colorPalette();
},_colorPalette:function(){var K=this.dialog().element.find("div:first");
this.colorPalette=K.kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],change:this.value.bind(this)}).data("kendoColorPalette");
}});
x.spreadsheet.dialogs.register("colorPicker",o);
var p=n.extend({init:function(K){K.width=268;
n.fn.init.call(this,K);
this.dialog().setOptions({animation:false});
this.dialog().one("activate",this._colorPicker.bind(this));
},_colorPicker:function(){var K=this.dialog().element.find("div:first");
this.colorPicker=K.kendoFlatColorPicker({change:this.value.bind(this)}).data("kendoFlatColorPicker");
}});
x.spreadsheet.dialogs.register("customColor",p);
var l=E.extend({init:function(K){E.fn.init.call(this,K);
this._list();
},options:{title:"Alignment",template:"<ul class='k-list k-reset'></ul>",buttons:[{property:"textAlign",value:"left",iconClass:"justify-left",text:A.alignmentDialog.buttons.justtifyLeft},{property:"textAlign",value:"center",iconClass:"justify-center",text:A.alignmentDialog.buttons.justifyCenter},{property:"textAlign",value:"right",iconClass:"justify-right",text:A.alignmentDialog.buttons.justifyRight},{property:"textAlign",value:"justify",iconClass:"justify-full",text:A.alignmentDialog.buttons.justifyFull},{property:"verticalAlign",value:"top",iconClass:"align-top",text:A.alignmentDialog.buttons.alignTop},{property:"verticalAlign",value:"center",iconClass:"align-middle",text:A.alignmentDialog.buttons.alignMiddle},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom",text:A.alignmentDialog.buttons.alignBottom}]},_list:function(){var K=this.dialog().element.find("ul");
this.list=new x.ui.StaticList(K,{dataSource:new x.data.DataSource({data:this.options.buttons}),template:"<a title='#=text#' data-property='#=property#' data-value='#=value#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(L){var K=L.sender.value()[0];
E.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:K.property,value:K.value}});
}});
x.spreadsheet.dialogs.register("alignment",l);
var y=E.extend({init:function(K){E.fn.init.call(this,K);
this._list();
},options:{title:A.mergeDialog.title,template:"<ul class='k-list k-reset'></ul>",buttons:[{value:"cells",iconClass:"merge-cells",text:A.mergeDialog.buttons.mergeCells},{value:"horizontally",iconClass:"merge-horizontally",text:A.mergeDialog.buttons.mergeHorizontally},{value:"vertically",iconClass:"merge-vertically",text:A.mergeDialog.buttons.mergeVertically},{value:"unmerge",iconClass:"normal-layout",text:A.mergeDialog.buttons.unmerge}]},_list:function(){var K=this.dialog().element.find("ul");
this.list=new x.ui.StaticList(K,{dataSource:new x.data.DataSource({data:this.options.buttons}),template:"<a title='#=text#' data-value='#=value#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(L){var K=L.sender.value()[0];
E.fn.apply.call(this);
this.trigger("action",{command:"MergeCellCommand",options:{value:K.value}});
}});
x.spreadsheet.dialogs.register("merge",y);
var w=E.extend({init:function(K){E.fn.init.call(this,K);
this._list();
},options:{title:A.freezeDialog.title,template:"<ul class='k-list k-reset'></ul>",buttons:[{value:"panes",iconClass:"freeze-panes",text:A.freezeDialog.buttons.freezePanes},{value:"rows",iconClass:"freeze-row",text:A.freezeDialog.buttons.freezeRows},{value:"columns",iconClass:"freeze-col",text:A.freezeDialog.buttons.freezeColumns},{value:"unfreeze",iconClass:"normal-layout",text:A.freezeDialog.buttons.unfreeze}]},_list:function(){var K=this.dialog().element.find("ul");
this.list=new x.ui.StaticList(K,{dataSource:new x.data.DataSource({data:this.options.buttons}),template:"<a title='#=text#' data-value='#=value#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(L){var K=L.sender.value()[0];
E.fn.apply.call(this);
this.trigger("action",{command:"FreezePanesCommand",options:{value:K.value}});
}});
x.spreadsheet.dialogs.register("freeze",w);
var J=x.spreadsheet.ValidationCellsViewModel=C.extend({init:function(K){C.fn.init.call(this,K);
this.bind("change",function(L){if(L.field==="criterion"){this.reset();
if(this.criterion==="custom"||this.criterion==="list"){this.setHintMessageTemplate();
}}if(L.field==="comparer"){this.setHintMessageTemplate();
}if((L.field=="hintMessage"||L.field=="hintTitle")&&!this._mute){this.shouldBuild=false;
}if((L.field=="from"||L.field=="to"||L.field=="hintMessageTemplate"||L.field=="type")&&this.shouldBuild){this.buildMessages();
}}.bind(this));
this.reset();
},buildMessages:function(){this._mute=true;
this.set("hintTitle",this.hintTitleTemplate?x.format(this.hintTitleTemplate,this.type):"");
this.set("hintMessage",this.hintMessageTemplate?x.format(this.hintMessageTemplate,this.from,this.to):"");
this._mute=false;
},reset:function(){this.setComparers();
this.set("comparer",this.comparers[0].type);
this.set("from",null);
this.set("to",null);
this.set("useCustomMessages",false);
this.shouldBuild=true;
this.hintTitleTemplate=this.defaultHintTitle;
this.buildMessages();
},setComparers:function(){var K=this.defaultComparers;
var L=[];
if(this.criterion==="text"){var N=["equalTo","notEqualTo"];
for(var M=0;
M<K.length;
M++){if(N[0]==K[M].type){L.push(K[M]);
N.shift();
}}}else{L=K.slice();
}this.set("comparers",L);
},setHintMessageTemplate:function(){if(this.criterion!=="custom"&&this.criterion!=="list"){this.set("hintMessageTemplate",x.format(this.defaultHintMessage,this.criterion,this.comparerMessages[this.comparer]));
}else{this.set("hintMessageTemplate","");
this.set("hintMessage","");
}},isAny:function(){return this.get("criterion")==="any";
},isNumber:function(){return this.get("criterion")==="number";
},showToForNumber:function(){return this.showTo()&&this.isNumber();
},showToForDate:function(){return this.showTo()&&this.isDate();
},isText:function(){return this.get("criterion")==="text";
},isDate:function(){return this.get("criterion")==="date";
},isList:function(){return this.get("criterion")==="list";
},isCustom:function(){return this.get("criterion")==="custom";
},showRemove:function(){return this.get("hasValidation");
},showTo:function(){return this.get("comparer")=="between"||this.get("comparer")=="notBetween";
},update:function(K){this.set("hasValidation",!!K);
if(K){this.fromValidationObject(K);
}},fromValidationObject:function(K){this.set("criterion",K.dataType);
this.set("comparer",K.comparerType);
this.set("from",K.from);
this.set("to",K.to);
this.set("type",K.type);
this.set("ignoreBlank",K.allowNulls);
if(K.messageTemplate||K.titleTemplate){this.hintMessageTemplate=K.messageTemplate;
this.hintMessage=K.messageTemplate;
this.hintTitleTemplate=K.titleTemplate;
this.hintTitle=K.titleTemplate;
this.useCustomMessages=true;
this.buildMessages();
}else{this.useCustomMessages=false;
}},toValidationObject:function(){if(this.criterion==="any"){return null;
}var K={type:this.type,dataType:this.criterion,comparerType:this.comparer,from:this.from,to:this.to,allowNulls:this.ignoreBlank};
if(this.useCustomMessages){K.messageTemplate=this.shouldBuild?this.hintMessageTemplate:this.hintMessage;
K.titleTemplate=this.hintTitle;
}return K;
}});
var I=E.extend({init:function(K){E.fn.init.call(this,K);
},options:{width:420,title:A.validationDialog.title,criterion:"any",type:"reject",ignoreBlank:true,hintMessage:A.validationDialog.hintMessage,hintTitle:A.validationDialog.hintTitle,useCustomMessages:false,criteria:[{type:"any",name:"Any value"},{type:"number",name:"Number"},{type:"text",name:"Text"},{type:"date",name:"Date"},{type:"custom",name:"Custom Formula"},{type:"list",name:"List"}],comparers:[{type:"greaterThan",name:A.validationDialog.comparers.greaterThan},{type:"lessThan",name:A.validationDialog.comparers.lessThan},{type:"between",name:A.validationDialog.comparers.between},{type:"notBetween",name:A.validationDialog.comparers.notBetween},{type:"equalTo",name:A.validationDialog.comparers.equalTo},{type:"notEqualTo",name:A.validationDialog.comparers.notEqualTo},{type:"greaterThanOrEqualTo",name:A.validationDialog.comparers.greaterThanOrEqualTo},{type:"lessThanOrEqualTo",name:A.validationDialog.comparers.lessThanOrEqualTo}],comparerMessages:A.validationDialog.comparerMessages,errorTemplate:'<div class="k-widget k-tooltip k-tooltip-validation" style="margin:0.5em"><span class="k-icon k-warning"> </span>#=message#<div class="k-callout k-callout-n"></div></div>',template:'<div class="k-edit-form-container"><div class="k-edit-label"><label>'+A.validationDialog.labels.criteria+':</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: criterion, source: criteria" /></div><div data-bind="visible: isNumber"><div class="k-edit-label"><label>'+A.validationDialog.labels.comparer+':</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: comparer, source: comparers" /></div><div class="k-edit-label"><label>'+A.validationDialog.labels.min+':</label></div><div class="k-edit-field"><input name="'+A.validationDialog.labels.min+'" placeholder="e.g. 10" class="k-textbox" data-bind="value: from, enabled: isNumber" required="required" /></div><div data-bind="visible: showTo"><div class="k-edit-label"><label>'+A.validationDialog.labels.max+':</label></div><div class="k-edit-field"><input name="'+A.validationDialog.labels.max+'" placeholder="e.g. 100" class="k-textbox" data-bind="value: to, enabled: showToForNumber" required="required" /></div></div></div><div data-bind="visible: isText"><div class="k-edit-label"><label>'+A.validationDialog.labels.comparer+':</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: comparer, source: comparers" /></div><div class="k-edit-label"><label>'+A.validationDialog.labels.value+':</label></div><div class="k-edit-field"><input name="'+A.validationDialog.labels.value+'" class="k-textbox" data-bind="value: from, enabled: isText" required="required" /></div></div><div data-bind="visible: isDate"><div class="k-edit-label"><label>'+A.validationDialog.labels.comparer+':</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: comparer, source: comparers" /></div><div class="k-edit-label"><label>'+A.validationDialog.labels.start+':</label></div><div class="k-edit-field"><input name="'+A.validationDialog.labels.start+'" class="k-textbox" data-bind="value: from, enabled: isDate" required="required" /></div><div data-bind="visible: showTo"><div class="k-edit-label"><label>'+A.validationDialog.labels.end+':</label></div><div class="k-edit-field"><input name="'+A.validationDialog.labels.end+'" class="k-textbox" data-bind="value: to, enabled: showToForDate" required="required" /></div></div></div><div data-bind="visible: isCustom"><div class="k-edit-label"><label>'+A.validationDialog.labels.value+':</label></div><div class="k-edit-field"><input name="'+A.validationDialog.labels.value+'" class="k-textbox" data-bind="value: from, enabled: isCustom" required="required" /></div></div><div data-bind="visible: isList"><div class="k-edit-label"><label>'+A.validationDialog.labels.value+':</label></div><div class="k-edit-field"><input name="'+A.validationDialog.labels.value+'" class="k-textbox" data-bind="value: from, enabled: isList" required="required" /></div></div><div data-bind="invisible: isAny"><div class="k-edit-label"><label>'+A.validationDialog.labels.ignoreBlank+':</label></div><div class="k-edit-field"><input type="checkbox" name="ignoreBlank" id="ignoreBlank" class="k-checkbox" data-bind="checked: ignoreBlank"/><label class="k-checkbox-label" for="ignoreBlank"></label></div></div><div data-bind="invisible: isAny"><div class="k-action-buttons"></div><div class="k-edit-label"><label>'+A.validationDialog.labels.onInvalidData+':</label></div><div class="k-edit-field"><input type="radio" id="validationTypeReject" name="validationType" value="reject" data-bind="checked: type" class="k-radio" /><label for="validationTypeReject" class="k-radio-label">'+A.validationDialog.labels.rejectInput+'</label> <input type="radio" id="validationTypeWarning" name="validationType" value="warning" data-bind="checked: type" class="k-radio" /><label for="validationTypeWarning" class="k-radio-label">'+A.validationDialog.labels.showWarning+'</label></div></div><div data-bind="invisible: isAny"><div class="k-edit-label"><label>'+A.validationDialog.labels.showHint+':</label></div><div class="k-edit-field"><input type="checkbox" name="useCustomMessages" id="useCustomMessages" class="k-checkbox" data-bind="checked: useCustomMessages" /><label class="k-checkbox-label" for="useCustomMessages"></label></div><div data-bind="visible: useCustomMessages"><div class="k-edit-label"><label>'+A.validationDialog.labels.hintTitle+':</label></div><div class="k-edit-field"><input class="k-textbox" placeholder="'+A.validationDialog.placeholders.typeTitle+'" data-bind="value: hintTitle" /></div><div class="k-edit-label"><label>'+A.validationDialog.labels.hintMessage+':</label></div><div class="k-edit-field"><input class="k-textbox" placeholder="'+A.validationDialog.placeholders.typeMessage+'" data-bind="value: hintMessage" /></div></div></div><div class="k-action-buttons"><button class="k-button" data-bind="visible: showRemove, click: remove">'+A.remove+'</button><button class="k-button k-primary" data-bind="click: apply">'+A.apply+'</button><button class="k-button" data-bind="click: close">'+A.cancel+"</button></div></div>"},open:function(M){var L=this.options;
var K;
this.viewModel=new J({type:L.type,defaultHintMessage:L.hintMessage,defaultHintTitle:L.hintTitle,defaultComparers:L.comparers.slice(0),comparerMessages:L.comparerMessages,criteria:L.criteria.slice(0),criterion:L.criterion,ignoreBlank:L.ignoreBlank,apply:this.apply.bind(this),close:this.close.bind(this),remove:this.remove.bind(this)});
this.viewModel.update(M.validation());
E.fn.open.call(this);
K=this.dialog().element;
if(this.validatable){this.validatable.destroy();
}x.bind(K,this.viewModel);
this.validatable=new x.ui.Validator(K.find(".k-edit-form-container"),{validateOnBlur:false,errorTemplate:this.options.errorTemplate||j});
},apply:function(){if(this.validatable.validate()){E.fn.apply.call(this);
this.trigger("action",{command:"EditValidationCommand",options:{value:this.viewModel.toValidationObject()}});
}},remove:function(){this.viewModel.set("criterion","any");
this.apply();
}});
x.spreadsheet.dialogs.register("validation",I);
x.spreadsheet.dialogs.ValidationDialog=I;
var q=E.extend({init:function(K){E.fn.init.call(this,K);
this.viewModel=x.observable({title:this.options.title,name:this.options.name,extension:this.options.extension,fileFormats:this.options.fileFormats,excel:K.excelExport,pdf:{proxyURL:K.pdfExport.proxyURL,forceProxy:K.pdfExport.forceProxy,title:K.pdfExport.title,author:K.pdfExport.author,subject:K.pdfExport.subject,keywords:K.pdfExport.keywords,creator:K.pdfExport.creator,date:K.pdfExport.date,fitWidth:this.options.pdf.fitWidth,area:this.options.pdf.area,areas:this.options.pdf.areas,paperSize:this.options.pdf.paperSize,paperSizes:this.options.pdf.paperSizes,margin:this.options.pdf.margin,margins:this.options.pdf.margins,landscape:this.options.pdf.landscape,guidelines:this.options.pdf.guidelines,hCenter:this.options.pdf.hCenter,vCenter:this.options.pdf.vCenter},apply:this.apply.bind(this),close:this.close.bind(this)});
this.viewModel.bind("change",function(L){if(L.field==="extension"){this.set("showPdfOptions",this.extension===".pdf"?true:false);
}});
x.bind(this.dialog().element,this.viewModel);
},options:{title:A.exportAsDialog.title,name:"Workbook",extension:".xlsx",fileFormats:[{description:"Excel Workbook (.xlsx)",extension:".xlsx"},{description:"Portable Document Format(.pdf)",extension:".pdf"}],pdf:{fitWidth:true,area:"workbook",areas:[{area:"workbook",text:"Entire Workbook"},{area:"sheet",text:"Active Sheet"},{area:"selection",text:"Selection"}],paperSize:"a4",paperSizes:[{value:"a2",text:"A2 (420 mm \xD7 594 mm)     "},{value:"a3",text:"A3 (297 mm x 420 mm)     "},{value:"a4",text:"A4 (210 mm x 297 mm)     "},{value:"a5",text:"A5 (148 mm x 210 mm)     "},{value:"b3",text:"B3 (353 mm \xD7 500 mm)     "},{value:"b4",text:"B4 (250 mm x 353 mm)     "},{value:"b5",text:"B5 (176 mm x 250 mm)     "},{value:"folio",text:'Folio (8.5" x 13")       '},{value:"legal",text:'Legal (8.5" x 14")       '},{value:"letter",text:'Letter (8.5" x 11")      '},{value:"tabloid",text:'Tabloid (11" x 17")      '},{value:"executive",text:'Executive (7.25" x 10.5")'}],margin:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},margins:[{value:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},text:"Normal"},{value:{bottom:"0.75in",left:"0.25in",right:"0.25in",top:"0.75in"},text:"Narrow"},{value:{bottom:"1in",left:"1in",right:"1in",top:"1in"},text:"Wide"}],landscape:true,guidelines:true,hCenter:true,vCenter:true},width:520,template:"<div class='k-edit-label'><label>"+A.exportAsDialog.labels.fileName+":</label></div><div class='k-edit-field'><input class='k-textbox' data-bind='value: name' /></div><div ><div class='k-edit-label'><label>"+A.exportAsDialog.labels.saveAsType+":</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-text-field='description' data-value-field='extension' data-bind='value: extension, source: fileFormats' /></div></div><div class='export-config' data-bind='visible: showPdfOptions'><div class='k-edit-label'><label>"+A.exportAsDialog.labels.exportArea+":</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-text-field='text' data-value-field='area' data-bind='value: pdf.area, source: pdf.areas' /></div><div class='k-edit-label'><label>"+A.exportAsDialog.labels.paperSize+":</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-text-field='text' data-value-field='value' data-bind='value: pdf.paperSize, source: pdf.paperSizes' /></div><div class='k-edit-label'><label>"+A.exportAsDialog.labels.margins+":</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-value-primitive='true'data-text-field='text' data-value-field='value' data-bind='value: pdf.margin, source: pdf.margins' /></div><div class='k-edit-label'><label>"+A.exportAsDialog.labels.orientation+":</label></div><div class='k-edit-field'><input type='radio' id='k-orientation-portrait' name='orientation' data-type='boolean' data-bind='checked: pdf.landscape' value='false' /><label class='k-orientation-label k-orientation-portrait-label' for='k-orientation-portrait'></label><input type='radio' id='k-orientation-landscape' name='orientation' data-type='boolean' data-bind='checked: pdf.landscape' value='true' /><label class='k-orientation-label k-orientation-landscape-label' for='k-orientation-landscape'></label></div><div class='k-edit-label'><label>"+A.exportAsDialog.labels.print+":</label></div><div class='k-edit-field'><input class='k-checkbox' id='guidelines' type='checkbox' data-bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>"+A.exportAsDialog.labels.guidelines+"</label></div><div class='k-edit-label'><label>"+A.exportAsDialog.labels.scale+":</label></div><div class='k-edit-field'><input class='k-checkbox' id='fitWidth' type='checkbox' data-bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>"+A.exportAsDialog.labels.fit+"</label></div><div class='k-edit-label'><label>"+A.exportAsDialog.labels.center+":</label></div><div class='k-edit-field'><input class='k-checkbox' id='hCenter' type='checkbox' data-bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>"+A.exportAsDialog.labels.horizontally+"</label><input class='k-checkbox' id='vCenter' type='checkbox' data-bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>"+A.exportAsDialog.labels.vertically+"</label></div><div class='k-page-orientation' data-bind='css: {k-page-landscape: pdf.landscape}'><div class='k-margins-horizontal'></div><div class='k-margins-vertical'></div></div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>"+A.save+"</button><button class='k-button' data-bind='click: close'>"+A.cancel+"</button></div>"},apply:function(){E.fn.apply.call(this);
this.trigger("action",{command:"SaveAsCommand",options:this.viewModel});
}});
x.spreadsheet.dialogs.register("exportAs",q);
var B=z.extend({init:function(K){E.fn.init.call(this,K);
},options:{template:A.modifyMergedDialog.errorMessage+"<div class=\"k-action-buttons\"><button class='k-button k-primary' data-bind='click: close, text: okText' /></div>"}});
x.spreadsheet.dialogs.register("modifyMerged",B);
var H=z.extend({init:function(K){E.fn.init.call(this,K);
},options:{title:A.useKeyboardDialog.title,template:A.useKeyboardDialog.errorMessage+"<div>Ctrl+C "+A.useKeyboardDialog.labels.forCopy+"</div><div>Ctrl+X "+A.useKeyboardDialog.labels.forCut+"</div><div>Ctrl+V "+A.useKeyboardDialog.labels.forPaste+"</div><div class=\"k-action-buttons\"><button class='k-button k-primary' data-bind='click: close, text: okText' /></div>"}});
x.spreadsheet.dialogs.register("useKeyboard",H);
var G=z.extend({init:function(K){E.fn.init.call(this,K);
},options:{template:A.unsupportedSelectionDialog.errorMessage+"<div class=\"k-action-buttons\"><button class='k-button k-primary' data-bind='click: close, text: okText' /></div>"}});
x.spreadsheet.dialogs.register("unsupportedSelection",G);
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/sheetbinder",["kendo.core","kendo.data","spreadsheet/sheet"],l);
}(function(){(function(k){if(k.support.browser.msie&&k.support.browser.version<9){return;
}var l=k.Class.extend({init:function(m){this.options=f.extend({},this.options,m);
this.columns=this._normalizeColumns(this.options.columns);
this._sheet();
this._dataSource();
this._header();
this.dataSource.fetch();
},_sheet:function(){this.sheet=this.options.sheet;
this._sheetChangeHandler=this._sheetChange.bind(this);
this._sheetDeleteRowHandler=this._sheetDeleteRow.bind(this);
this._sheetInsertRowHandler=this._sheetInsertRow.bind(this);
this.sheet.bind("change",this._sheetChangeHandler).bind("deleteRow",this._sheetDeleteRowHandler).bind("insertRow",this._sheetInsertRowHandler);
},_sheetInsertRow:function(m){if(m.index!==j){this.dataSource.insert(Math.max(m.index-1,0),{});
}},_sheetDeleteRow:function(n){if(n.index!==j){var m=this.dataSource;
var o=m.view()[n.index-1];
if(o){m.remove(o);
}}},_header:function(){this.sheet.batch(function(){this.columns.forEach(function(m,n){this.sheet.range(0,n).value(m.title);
}.bind(this));
}.bind(this));
},_sheetChange:function(p){if(p.recalc&&p.ref){var o=this.dataSource;
var n=o.view();
var m=this.columns;
if(!m.length&&n.length){m=Object.keys(n[0].toJSON());
}this._skipRebind=true;
var q=this.sheet.range(p.ref).values();
p.ref.forEach(function(u){u=u.toRangeRef();
var t;
var w=0;
for(var v=u.topLeft.row;
v<=u.bottomRight.row;
v++){t=n[v-1];
if(!t){t=o.insert(v-1,{});
n=o.view();
}var s=0;
for(var r=u.topLeft.col;
r<=u.bottomRight.col&&r<m.length;
r++){t.set(m[r].field,q[w][s++]);
}w++;
}});
this._skipRebind=false;
}},_normalizeColumns:function(m){return m.map(function(n){var o=n.field||n;
return{field:o,title:n.title||o};
});
},_dataSource:function(){var n=this.options;
var m=n.dataSource;
m=Array.isArray(m)?{data:m}:m;
if(this.dataSource&&this._changeHandler){this.dataSource.unbind("change",this._changeHandler);
}else{this._changeHandler=this._change.bind(this);
}this.dataSource=k.data.DataSource.create(m).bind("change",this._changeHandler);
},_change:function(){if(this._skipRebind){return;
}var n=this.dataSource.view();
var m=this.columns;
if(!m.length&&n.length){this.columns=m=this._normalizeColumns(Object.keys(n[0].toJSON()));
this._header();
}var o=m.map(function(p){return k.getter(p.field);
});
this.sheet.batch(function(){for(var q=0,r=n.length;
q<r;
q++){for(var p=0;
p<o.length;
p++){this.sheet.range(q+1,p).value(o[p](n[q]));
}}}.bind(this));
},destroy:function(){this.dataSource.unbind("change",this._changeHandler);
this.sheet.unbind("change",this._sheetChangeHandler).unbind("deleteRow",this._sheetDeleteRowHandler).unbind("insertRow",this._sheetInsertRowHandler);
},options:{columns:[]}});
k.spreadsheet.SheetDataSourceBinder=l;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/filtermenu",["kendo.core","kendo.popup","kendo.treeview","kendo.numerictextbox","kendo.datepicker","kendo.datetimepicker"],l);
}(function(){(function(u){if(u.support.browser.msie&&u.support.browser.version<9){return;
}var k=u.jQuery;
var x=u.ui.Widget;
var l={details:"k-details",button:"k-button",detailsSummary:"k-details-summary",detailsContent:"k-details-content",icon:"k-icon k-font-icon",iconCollapse:"k-i-collapse-se",iconExpand:"k-i-expand-e",iconSearch:"k-i-search",textbox:"k-textbox",wrapper:"k-spreadsheet-filter-menu",filterByCondition:"k-spreadsheet-condition-filter",filterByValue:"k-spreadsheet-value-filter",valuesTreeViewWrapper:"k-spreadsheet-value-treeview-wrapper",actionButtons:"k-action-buttons"};
var m=x.extend({init:function(y,A){x.fn.init.call(this,y,A);
this.element.addClass(p.classNames.details);
this._summary=this.element.find("."+p.classNames.detailsSummary).on("click",this._toggle.bind(this));
var z=A.expanded?p.classNames.iconCollapse:p.classNames.iconExpand;
this._icon=k("<span />",{"class":p.classNames.icon+" "+z}).prependTo(this._summary);
this._container=u.wrap(this._summary.next(),true);
if(!A.expanded){this._container.hide();
}},options:{name:"Details"},events:["toggle"],visible:function(){return this.options.expanded;
},toggle:function(z){var y=u.fx(this._container).expand("vertical");
y.stop()[z?"reverse":"play"]();
this._icon.toggleClass(p.classNames.iconExpand,z).toggleClass(p.classNames.iconCollapse,!z);
this.options.expanded=!z;
},_toggle:function(){var y=this.visible();
this.toggle(y);
this.trigger("toggle",{show:y});
}});
var q=u.spreadsheet.messages.filterMenu={sortAscending:"Sort range A to Z",sortDescending:"Sort range Z to A",filterByValue:"Filter by value",filterByCondition:"Filter by condition",apply:"Apply",search:"Search",addToCurrent:"Add to current selection",clear:"Clear",blanks:"(Blanks)",operatorNone:"None",and:"AND",or:"OR",operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}};
u.data.binders.spreadsheetFilterValue=u.data.Binder.extend({init:function(z,y,A){u.data.Binder.fn.init.call(this,z,y,A);
this._change=k.proxy(this.change,this);
k(this.element).on("change",this._change);
},refresh:function(){var y=this,z=y.bindings.spreadsheetFilterValue.get();
k(y.element).val(z instanceof Date?"":z);
},change:function(){var y=this.element.value;
this.bindings.spreadsheetFilterValue.set(y);
}});
u.data.binders.widget.spreadsheetFilterValue=u.data.Binder.extend({init:function(A,y,z){u.data.Binder.fn.init.call(this,A.element[0],y,z);
this.widget=A;
this._change=k.proxy(this.change,this);
this.widget.first("change",this._change);
},refresh:function(){var y=this.bindings.spreadsheetFilterValue,A=y.get(),z=k(this.widget.element).data("filterType");
if(z==="date"&&A instanceof Date||z==="number"&&!isNaN(A)){this.widget.value(A);
}else{this.widget.value(null);
}},change:function(){var z=this.widget.value(),y=this.bindings.spreadsheetFilterValue;
y.set(z);
}});
var v={filterByValue:"<div class='"+l.detailsSummary+"'>#= messages.filterByValue #</div><div class='"+l.detailsContent+"'><div class='k-textbox k-space-right'><input placeholder='#= messages.search #' data-#=ns#bind='events: { input: filterValues }' /><span class='k-icon k-font-icon k-i-search' /></div><div data-#=ns#bind='visible: hasActiveSearch'><input class='k-checkbox' type='checkbox' data-#=ns#bind='checked: appendToSearch' id='_#=guid#' /><label class='k-checkbox-label' for='_#=guid#'>#= messages.addToCurrent #</label></div><div class='"+l.valuesTreeViewWrapper+"'><div data-#=ns#role='treeview' data-#=ns#checkboxes='{ checkChildren: true }' data-#=ns#bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' /></div></div>",filterByCondition:"<div class='"+l.detailsSummary+"'>#= messages.filterByCondition #</div><div class='"+l.detailsContent+'\'><div><select data-#=ns#role="dropdownlist"data-#=ns#bind="value: operator, source: operators, events: { change: operatorChange } "data-value-primitive="false"data-option-label="#=messages.operatorNone#"data-height="auto"data-text-field="text"data-value-field="unique"></select></div><div data-#=ns#bind="visible: isString"><input data-filter-type="string" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" class="k-textbox" /></div><div data-#=ns#bind="visible: isNumber"><input data-filter-type="number" data-#=ns#role="numerictextbox" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" /></div><div data-#=ns#bind="visible: isDate"><input data-filter-type="date" data-#=ns#role="datepicker" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" /></div></div>',menuItem:"<li data-command='#=command#' data-dir='#=dir#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>#=text#</li>",actionButtons:"<button data-#=ns#bind='click: apply' class='k-button k-primary'>#=messages.apply#</button><button data-#=ns#bind='click: clear' class='k-button'>#=messages.clear#</button>"};
function n(B){var y={};
var A=[];
for(var z=0;
z<B.length;
z++){if(!y[B[z].value]){y[B[z].value]=B[z];
A.push(B[z]);
}else{if(!y[B[z].value].checked&&B[z].checked){y[B[z].value].checked=true;
}}}return A;
}function o(A,F){var B=false;
var z=A instanceof u.data.HierarchicalDataSource&&A.data();
for(var C=0;
C<z.length;
C++){var D=z[C];
var G=D.text.toString().toLowerCase();
var E=F===true||F===""||G.indexOf(F)>=0;
var y=o(D.children,E||F);
B=B||y||E;
D.hidden=!E&&!y;
D.checked=!D.hidden;
}if(z){A.filter({field:"hidden",operator:"neq",value:true});
}return B;
}function w(z){var y=z instanceof u.data.HierarchicalDataSource&&z.data();
for(var A=0;
A<y.length;
A++){var B=y[A];
B.checked=false;
if(B.hasChildren){w(B.children);
}}}var s=u.spreadsheet.FilterMenuViewModel=u.data.ObservableObject.extend({valuesChange:function(C){var B=C?C.sender.dataSource:this.valuesDataSource;
var z=function(G){return G.checked&&G.value;
};
var E=function(G){return G.dataType==="date"?u.spreadsheet.dateToNumber(G.value):G.value;
};
var D=function(I,H,G){return G.lastIndexOf(I)===H;
};
var A=B.data();
var F=A[0].children.data().toJSON();
var y=F.filter(function(G){return G.dataType==="blank";
});
y=y.length?y[0].checked:false;
F=F.filter(z).map(E);
if(this.appendToSearch&&this.valueFilter&&this.valueFilter.values.length){F=F.concat(this.valueFilter.values.toJSON()).sort().filter(D);
}this.set("valueFilter",{values:F,blanks:y});
},valueSelect:function(y){y.preventDefault();
var z=y.sender.dataItem(y.node);
z.set("checked",!z.checked);
},hasActiveSearch:false,appendToSearch:false,filterValues:function(z){var A=typeof z=="string"?z:k(z.target).val().toLowerCase();
var y=this.valuesDataSource;
this.set("hasActiveSearch",!!A);
w(y);
o(y,A);
},reset:function(){this.set("customFilter",{logic:"and",criteria:[{operator:null,value:null}]});
this.set("valueFilter",{values:[]});
},operatorChange:function(z){var y=z.sender.dataItem();
this.set("operatorType",y.type);
this.set("customFilter.criteria[0].operator",y.value);
},isNone:function(){return this.get("operatorType")===j;
},isString:function(){return this.get("operatorType")==="string";
},isNumber:function(){return this.get("operatorType")==="number";
},isDate:function(){return this.get("operatorType")==="date";
}});
function t(A){var y=q.operators;
var B=[];
for(var C in A){if(!A.hasOwnProperty(C)){continue;
}for(var z in A[C]){if(!A[C].hasOwnProperty(z)){continue;
}B.push({text:y[C][z],value:z,unique:C+"_"+z,type:C});
}}return B;
}var r=u.spreadsheet.FilterMenuController={valuesTree:function(z,y){return[{text:"All",expanded:true,checked:true,items:this.values(z.resize({top:1}),y)}];
},values:function(B,y){var D=[];
var A=q;
var z=B.column(y);
var C=B.sheet();
z.forEachCell(function(G,F,E){if(E.value===j){E.dataType="blank";
}else{if(E.format){E.dataType=u.spreadsheet.formatting.type(E.value,E.format);
}else{E.dataType=typeof E.value;
}}if(E.value!==null&&E.format){E.text=u.spreadsheet.formatting.text(E.value,E.format);
}else{E.text=E.value?E.value:A.blanks;
}if(E.dataType==="percent"){E.dataType="number";
}if(E.dataType==="date"){E.value=u.spreadsheet.numberToDate(E.value);
}if(E.hasOwnProperty("wrap")){delete E.wrap;
}E.checked=!C.isHiddenRow(G);
D.push(E);
});
D=n(D);
D.sort(function(E,F){if(E.dataType===F.dataType){return 0;
}if(E.dataType==="blank"||F.dataType==="blank"){return E.dataType==="blank"?-1:1;
}if(E.dataType==="number"||F.dataType==="number"){return E.dataType==="number"?-1:1;
}if(E.dataType==="date"||F.dataType==="date"){return E.dataType==="date"?-1:1;
}return 0;
});
return D;
},filterType:function(A,y){var B=A.sheet();
var z=this.filterForColumn(y,B);
var D;
z=z&&z.filter.toJSON();
if(z&&z.filter=="custom"){var E=z.criteria[0].value;
if(E instanceof Date){D="date";
}else{if(typeof E=="string"){D="string";
}else{if(typeof E=="number"){D="number";
}}}}if(!D){var C=this.values(A.row(1),y)[0];
D=C&&C.dataType;
if(D=="blank"){D=null;
}}return D;
},filterForColumn:function(z,B){var y=B.filter();
var A;
if(y){A=y.columns.filter(function(C){return C.index===z;
})[0];
}return A;
},filter:function(y,D){var z=this.filterForColumn(y,D);
if(!z){return;
}var B=z.filter.toJSON();
var E=B.filter;
delete B.filter;
var C={type:E,options:B};
var A=B.criteria;
if(A&&A.length){C.operator=A[0].operator;
}return C;
}};
var p=x.extend({init:function(y,z){x.call(this,y,z);
this.element.addClass(p.classNames.wrapper);
this.viewModel=new s({active:"value",operator:null,operators:t(this.options.operators),clear:this.clear.bind(this),apply:this.apply.bind(this)});
this._filterInit();
this._popup();
this._sort();
this._filterByCondition();
this._filterByValue();
this._actionButtons();
},options:{name:"FilterMenu",column:0,range:null,operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}},events:["action"],destroy:function(){x.fn.destroy.call(this);
this.menu.destroy();
this.valuesTreeView.destroy();
this.popup.destroy();
},openFor:function(y){this.popup.setOptions({anchor:y});
this.popup.open();
},close:function(){this.popup.close();
},clear:function(){this.action({command:"ClearFilterCommand",options:{column:this.options.column}});
this.viewModel.reset();
this.close();
},apply:function(){this._active();
var z={operatingRange:this.options.range,column:this.options.column};
var A;
var y;
if(this.viewModel.active==="value"){this.viewModel.valuesChange({sender:this.valuesTreeView});
A=this.viewModel.valueFilter.toJSON();
if(A.values&&A.values.length){z.valueFilter=A;
}}else{if(this.viewModel.active==="custom"){y=this.viewModel.customFilter.toJSON();
if(y.criteria.length&&y.criteria[0].value!==null){z.customFilter=y;
}}}if(z.valueFilter||z.customFilter){this.action({command:"ApplyFilterCommand",options:z});
}},action:function(y){this.trigger("action",k.extend({},y));
},_filterInit:function(){var z=this.options.column;
var B=this.options.range;
var C=B.sheet();
var y=r.filter(z,C);
if(y){var A=r.filterType(B,z);
this.viewModel.set("active",y.type);
this.viewModel.set(y.type+"Filter",y.options);
if(y.type=="custom"){this.viewModel.set("operator",A+"_"+y.operator);
this.viewModel.set("operatorType",A);
}}else{this.viewModel.reset();
}},_popup:function(){this.popup=this.element.kendoPopup({copyAnchorStyles:false}).data("kendoPopup");
},_sort:function(){var A=u.template(p.templates.menuItem);
var z=q;
var y=[{command:"sort",dir:"asc",text:z.sortAscending,iconClass:"sort-asc"},{command:"sort",dir:"desc",text:z.sortDescending,iconClass:"sort-desc"}];
var B=k("<ul />",{html:u.render(A,y)}).appendTo(this.element);
this.menu=B.kendoMenu({orientation:"vertical",select:function(D){var C=k(D.item).data("dir");
var F=this.options.range.resize({top:1});
var E={value:C,sheet:false,operatingRange:F,column:this.options.column};
if(F.isSortable()){this.action({command:"SortCommand",options:E});
}else{this.close();
}}.bind(this)}).data("kendoMenu");
},_appendTemplate:function(C,y,A,B){var z=u.template(C);
var D=k("<div class='"+y+"'/>").html(z({messages:q,guid:u.guid(),ns:u.ns}));
this.element.append(D);
if(A){A=new m(D,{expanded:B,toggle:this._detailToggle.bind(this)});
}u.bind(D,this.viewModel);
return D;
},_detailToggle:function(y){this.element.find("[data-role=details]").not(y.sender.element).data("kendoDetails").toggle(!y.show);
},_filterByCondition:function(){var y=this.viewModel.active==="custom";
this._appendTemplate(p.templates.filterByCondition,p.classNames.filterByCondition,true,y);
},_filterByValue:function(){var y=this.viewModel.active==="value";
var A=this._appendTemplate(p.templates.filterByValue,p.classNames.filterByValue,true,y);
this.valuesTreeView=A.find("[data-role=treeview]").data("kendoTreeView");
var z=r.valuesTree(this.options.range,this.options.column);
this.viewModel.set("valuesDataSource",new u.data.HierarchicalDataSource({data:z}));
},_actionButtons:function(){this._appendTemplate(p.templates.actionButtons,p.classNames.actionButtons,false);
},_active:function(){var y=this.element.find("[data-role=details]").filter(function(A,z){return k(z).data("kendoDetails").visible();
});
if(y.hasClass(p.classNames.filterByValue)){this.viewModel.set("active","value");
}else{if(y.hasClass(p.classNames.filterByCondition)){this.viewModel.set("active","custom");
}}}});
u.spreadsheet.FilterMenu=p;
k.extend(true,p,{classNames:l,templates:v});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/editor",["kendo.core"],l);
}(function(){(function(k){if(k.support.browser.msie&&k.support.browser.version<9){return;
}var m=k.Observable.extend({init:function(n){k.Observable.fn.init.call(this);
this.view=n;
this.formulaBar=n.formulaBar;
this.barInput=n.formulaBar.formulaInput;
this.cellInput=n.formulaInput;
this.barInput.syncWith(this.cellInput);
this.cellInput.syncWith(this.barInput);
this.barInput.bind("keyup",this._triggerUpdate.bind(this));
this.cellInput.bind("keyup",this._triggerUpdate.bind(this));
this.barInput.bind("focus",this._focus.bind(this));
this.cellInput.bind("focus",this._focus.bind(this));
},events:["activate","deactivate","change","update"],_focus:function(n){this.lastActive=n.sender==this.barInput?"bar":"cell";
},_triggerUpdate:function(){this.trigger("update",{value:this.value()});
},activeEditor:function(){var o=null;
var n=k._activeElement();
if(this.barElement()[0]===n){o=this.barInput;
}else{if(this.cellElement()[0]===n){o=this.cellInput;
}}return o;
},activate:function(n){this._active=true;
this._rect=n.rect;
this.cellInput.position(n.rect);
this.cellInput.resize(n.rect);
this.cellInput.tooltip(n.tooltip);
this.cellInput.activeCell=this.barInput.activeCell=n.range.topLeft;
this.trigger("activate");
return this;
},deactivate:function(){var n=this.cellInput;
if(!this._active){return;
}if(n.value()!=this._value){if(this.trigger("change",{value:n.value()})){return;
}}this._active=false;
this._rect=null;
n.hide();
this.trigger("deactivate");
},enable:function(n){this.barInput.enable(n);
},barElement:function(){return this.barInput.element;
},cellElement:function(){return this.cellInput.element;
},focusLastActive:function(){this.focus(this.lastActive);
},focus:function(n){n=n||"cell";
if(n==="cell"){this.cellInput.element.focus();
this.cellInput.end();
}else{this.barInput.element.focus();
}},isActive:function(){return this._active;
},isFiltered:function(){return this.barInput.popup.visible()||this.cellInput.popup.visible();
},canInsertRef:function(o){var n=this.activeEditor();
return n&&n.canInsertRef(o);
},highlightedRefs:function(){var n=this.activeEditor();
var o=[];
if(n){o=n.highlightedRefs();
}return o;
},scale:function(){this.cellInput.scale();
},toggleTooltip:function(n){this.cellInput.toggleTooltip(l(this._rect,n));
},value:function(n){if(n===j){return this.barInput.value();
}if(n===null){n="";
}this._value=n;
this.barInput.value(n);
this.cellInput.value(n);
}});
function l(o,n){return o&&(o.top!==n.top||o.left!==n.left);
}k.spreadsheet.SheetEditor=m;
}(kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/autofill",["spreadsheet/runtime","spreadsheet/range"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var w=kendo.spreadsheet;
var u=w.Range;
var v=w.calc.runtime;
var p=v.Formula;
var s="Incompatible ranges in fillFrom";
var t="Cannot determine fill direction";
u.prototype._previewFillFrom=function(Q,E){var D=this,N=D._sheet;
if(typeof Q=="string"){Q=N.range(Q);
}var O=Q._ref.toRangeRef();
var C=D._ref.toRangeRef();
if(O.intersects(C)){if(O.eq(C)){return null;
}C=C.clone();
if(O.topLeft.eq(C.topLeft)){if(O.width()==C.width()){C.topLeft.row+=O.height();
E=0;
}else{if(O.height()==C.height()){C.topLeft.col+=O.width();
E=1;
}else{throw new Error(s);
}}}else{if(O.bottomRight.eq(C.bottomRight)){if(O.width()==C.width()){C.bottomRight.row-=O.height();
E=2;
}else{if(O.height()==C.height()){C.bottomRight.col-=O.width();
E=3;
}else{throw new Error(s);
}}}else{throw new Error(s);
}}return N.range(C)._previewFillFrom(Q,E);
}if(E==null){if(O.topLeft.col==C.topLeft.col){E=O.topLeft.row<C.topLeft.row?0:2;
}else{if(O.topLeft.row==C.topLeft.row){E=O.topLeft.col<C.topLeft.col?1:3;
}else{throw new Error(t);
}}}var H=E&1;
var B=E&2;
if(H&&O.height()!=C.height()||!H&&O.width()!=C.width()){throw new Error(s);
}var A=Q._properties(),L;
if(!H){A=y(A);
L=C.height();
}else{L=C.width();
}var G=new Array(A.length);
for(var I=0;
I<A.length;
++I){var M=A[I];
var F=l(M);
var z=G[I]=new Array(L);
for(var K=0;
K<L;
++K){var J=B?-K-1:M.length+K;
var P=B?M.length-K%M.length-1:K%M.length;
z[B?L-K-1:K]=F(J,P);
}}if(!H){G=y(G);
}return{props:G,direction:E,dest:D};
};
u.prototype.fillFrom=function(A,z){var B=this._previewFillFrom(A,z);
B.dest._properties(B.props);
return B.dest;
};
function r(B){var F=B.length;
var D=(F+1)/2,E=B.reduce(function(K,L){return K+L;
},0)/F;
var G=0,H=0;
for(var C=0;
C<F;
C++){var I=C+1-D,J=B[C]-E;
G+=I*J;
H+=I*I;
}if(!H){return function(K){return B[K%B.length];
};
}var A=G/H,z=E-A*D;
return function(K){return z+A*(K+1);
};
}function l(C){function A(E){var F=E[1]-E[0];
for(var G=2;
G<E.length;
++G){if(E[G]-E[G-1]!=F){return null;
}}return F;
}function B(E){return E.map(function(F){return F.number;
});
}var D=[];
var z=C.map(function(E){return E.formula||E.value;
});
n(z,function(F,H,L,E){var I,M;
if(L=="number"){M=B(E);
if(M.length==1&&(F>0||H<z.length||o(M[0],C[F].format)=="date")){M.push(M[0]+1);
}I=r(M);
}else{if(L=="string"||L=="formula"||L=="boolean"){I=function(P,O){return z[O];
};
}else{if(Array.isArray(L)){if(E.length==1){I=function(O){return L[(E[0].number+O)%L.length];
};
}else{var G=A(B(E));
if(G==null){I=function(O){return E[O%E.length].value;
};
}else{I=function(P){var O=E[0].number+G*P;
return L[O%L.length];
};
}}}else{if(L!="null"){M=B(E);
if(M.length==1){M.push(M[0]+1);
}M=r(M);
I=function(P,O){return z[O].replace(/^(.*\D)\d+/,"$1"+M(P,O));
};
}else{I=function(){return null;
};
}}}}var K={f:I,begin:F,end:H,len:H-F};
for(var J=F;
J<H;
++J){D[J]=K;
}});
return function(G,E){var K=D[E];
var I=G/z.length|0;
var J=G%z.length;
var F=I*K.len+J-K.begin;
var L=K.f(F,E);
var H=k(C[E]);
if(L instanceof p){H.formula=L;
}else{H.value=L;
}return H;
};
}function o(A,z){if(z!=null){return w.formatting.type(A,z);
}}function k(A){var z={};
Object.keys(A||{}).forEach(function(B){z[B]=A[B];
});
return z;
}function n(A,B){var D=null,E=0,z=[],F;
for(var C=0;
C<A.length;
++C){F=q(A[C]);
z.push(F);
if(D!=null&&F.type!==D.type){B(E,C,D.type,z.slice(E,C));
E=C;
}D=F;
}B(E,C,D.type,z.slice(E,C));
}function q(z){if(typeof z=="number"){return{type:"number",number:z};
}if(typeof z=="string"){var A=m(z);
if(A){return A;
}var B=/^(.*\D)(\d+)/.exec(z);
if(B){z=z.replace(/^(.*\D)\d+/,"$1-######");
return{type:z,match:B,number:parseFloat(B[2])};
}return{type:"string"};
}if(typeof z=="boolean"){return{type:"boolean"};
}if(z==null){return{type:"null"};
}if(z instanceof p){return{type:"formula"};
}window.console.error(z);
throw new Error("Cannot fill data");
}function x(){var z=kendo.culture();
return[z.calendars.standard.days.namesAbbr,z.calendars.standard.days.names,z.calendars.standard.months.namesAbbr,z.calendars.standard.months.names];
}function m(E){var F=E.toLowerCase();
var D=x();
for(var B=0;
B<D.length;
++B){var z=D[B];
for(var C=z.length;
--C>=0;
){var A=z[C].toLowerCase();
if(A==F){return{type:z,number:C,value:E};
}}}}function y(z){var A=z.length,E=z[0].length;
var D=[];
for(var B=0;
B<E;
++B){D[B]=[];
for(var C=0;
C<A;
++C){D[B][C]=z[C][B];
}}return D;
}},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("spreadsheet/print",["kendo.pdf","spreadsheet/sheet","spreadsheet/range","spreadsheet/references","spreadsheet/numformat","util/text-metrics"],l);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var B=kendo.spreadsheet;
var k=B.CellRef;
var p=kendo.drawing;
var s=B.formatting;
var t=kendo.geometry;
var v=0.8;
function l(F,H){var E=0;
var G=[];
var I=0.2*H;
var D=H;
F.forEach(function(J){if(H&&E+J>D){if(D-E<I){E=H*Math.ceil(E/H);
}D+=H*Math.ceil(J/H);
}G.push(E);
E+=J;
});
G.push(E);
return G;
}function u(H,F){var D=H._grid;
var E={};
var G={};
H.forEachMergedCell(F,function(I){var J=I.topLeft;
D.forEach(I,function(K){if(J.eq(K)){E[K.print()]=I;
}else{if(F.contains(K)){G[K.print()]=J;
}}});
});
return{primary:E,secondary:G};
}function m(Q,N,K){var F=[];
var O=[];
var G=[];
var J=u(Q,N);
var I=-1,H=-1;
Q.forEach(N,function(ab,V,U){var aa=ab-N.topLeft.row;
var Z=V-N.topLeft.col;
if(!Z){O.push(Q.rowHeight(ab));
}if(!aa){G.push(Q.columnWidth(V));
}if(Q.isHiddenColumn(V)||Q.isHiddenRow(ab)){return;
}var Y=K.forScreen||A(U);
if(!(K.emptyCells||Y)){return;
}var W=new k(ab,V).print();
if(J.secondary[W]){return;
}if(Y){I=Math.max(I,aa);
H=Math.max(H,Z);
}else{U.empty=true;
}var X=J.primary[W];
if(X){delete J.primary[W];
U.merged=true;
U.rowspan=X.height();
U.colspan=X.width();
if(K.forScreen){U.width=Q._columns.sum(X.topLeft.col,X.bottomRight.col);
U.height=Q._rows.sum(X.topLeft.row,X.bottomRight.row);
}}else{U.rowspan=1;
U.colspan=1;
}U.row=aa;
U.col=Z;
F.push(U);
});
O=O.slice(0,I+1);
G=G.slice(0,H+1);
var M=K.pageWidth;
var L=K.pageHeight;
var P=1;
if(K.fitWidth){var R=G.reduce(C,0);
if(R>M){P=M/R;
M/=P;
L/=P;
}}var T=l(O,L||0);
var S=l(G,M||0);
var E=0;
var D=0;
F=F.filter(function(U){if(U.empty&&(U.row>I||U.col>H)){return false;
}U.left=S[U.col];
U.top=T[U.row];
if(U.merged){if(!K.forScreen){U.right=z(S,U.col+U.colspan);
U.bottom=z(T,U.row+U.rowspan);
U.width=U.right-U.left;
U.height=U.bottom-U.top;
}else{U.right=U.left+U.width;
U.bottom=U.top+U.height;
}}else{U.width=G[U.col];
U.height=O[U.row];
U.bottom=U.top+U.height;
U.right=U.left+U.width;
}E=Math.max(E,U.right);
D=Math.max(D,U.bottom);
return true;
});
Object.keys(J.primary).forEach(function(U){var V=J.primary[U];
Q.forEach(V.topLeft.toRangeRef(),function(aa,X,W){var Z=aa-N.topLeft.row;
var Y=X-N.topLeft.col;
W.merged=true;
W.colspan=V.height();
W.rowspan=V.width();
if(Z<0){W.top=-Q._rows.sum(aa,aa-Z-1);
}else{W.top=T[Z];
}if(Y<0){W.left=-Q._columns.sum(X,X-Y-1);
}else{W.left=S[Y];
}W.height=Q._rows.sum(V.topLeft.row,V.bottomRight.row);
W.width=Q._columns.sum(V.topLeft.col,V.bottomRight.col);
W.right=W.left+W.width;
W.bottom=W.top+W.height;
F.push(W);
});
});
return{width:E,height:D,cells:F.sort(y),scale:P,xCoords:S,yCoords:T};
}function C(D,E){return D+E;
}function z(D,E){return E<D.length?D[E]:D[D.length-1];
}function A(D){return D.value!=null||D.merged||D.background!=null||D.borderTop!=null||D.borderRight!=null||D.borderBottom!=null||D.borderLeft!=null;
}function y(D,E){if(D.top<E.top){return -1;
}else{if(D.top==E.top){if(D.left<E.left){return -1;
}else{if(D.left==E.left){return 0;
}else{return 1;
}}}else{return 1;
}}}function q(H,E,K){var I=Math.ceil(H.width/K.pageWidth);
var J=Math.ceil(H.height/K.pageHeight);
var M=K.pageWidth/H.scale;
var L=K.pageHeight/H.scale;
for(var F=0;
F<I;
++F){for(var G=0;
G<J;
++G){D(G,F);
}}function D(Z,Q){var U=Q*M;
var Y=U+M;
var aa=Z*L;
var O=aa+L;
var S=0,T=0;
var P=H.cells.filter(function(ab){if(ab.right<=U||ab.left>=Y||ab.bottom<=aa||ab.top>=O){return false;
}S=Math.max(ab.bottom,S);
T=Math.max(ab.right,T);
return true;
});
if(P.length>0){var W=new p.Group();
E.append(W);
W.clip(p.Path.fromRect(new t.Rect([0,0],[K.pageWidth,K.pageHeight])));
var R=new p.Group();
W.append(R);
var V=t.Matrix.scale(H.scale,H.scale).multiplyCopy(t.Matrix.translate(-U,-aa));
if(K.hCenter||K.vCenter){V=V.multiplyCopy(t.Matrix.translate(K.hCenter?(Y-T)/2:0,K.vCenter?(O-S)/2:0));
}R.transform(V);
if(K.guidelines){var X=null;
H.xCoords.forEach(function(ab){ab=Math.min(ab,T);
if(ab!==X&&ab>=U&&ab<=Y){X=ab;
R.append(new p.Path().moveTo(ab,aa).lineTo(ab,S).close().stroke("#999",v));
}});
var X=null;
H.yCoords.forEach(function(ab){ab=Math.min(ab,S);
if(ab!==X&&ab>=aa&&ab<=O){X=ab;
R.append(new p.Path().moveTo(U,ab).lineTo(T,ab).close().stroke("#999",v));
}});
}var N=new p.Group();
P.forEach(function(ab){o(ab,R,N,K);
});
R.append(N);
}}}function o(E,G,D,J){var I=new p.Group();
G.append(I);
var L=new t.Rect([E.left,E.top],[E.width,E.height]);
if(E.background||E.merged){var K=L;
if(J.guidelines){K=L.clone();
K.origin.x+=v/2;
K.origin.y+=v/2;
K.size.width-=v;
K.size.height-=v;
}I.append(new p.Rect(K).fill(E.background||"#fff").stroke(null));
}if(E.borderLeft){D.append(new p.Path().moveTo(E.left,E.top).lineTo(E.left,E.bottom).close().stroke(E.borderLeft.color,E.borderLeft.size));
}if(E.borderTop){D.append(new p.Path().moveTo(E.left,E.top).lineTo(E.right,E.top).close().stroke(E.borderTop.color,E.borderTop.size));
}if(E.borderRight){D.append(new p.Path().moveTo(E.right,E.top).lineTo(E.right,E.bottom).close().stroke(E.borderRight.color,E.borderRight.size));
}if(E.borderBottom){D.append(new p.Path().moveTo(E.left,E.bottom).lineTo(E.right,E.bottom).close().stroke(E.borderBottom.color,E.borderBottom.size));
}var N=E.value;
if(N!=null){var M=typeof N=="number"?"number":null;
var F=new p.Group();
F.clip(p.Path.fromRect(L));
I.append(F);
var H;
if(E.format){H=s.textAndColor(N,E.format);
N=H.text;
if(H.type){M=H.type;
}}else{N+="";
}if(!E.textAlign){switch(M){case"number":case"date":case"percent":E.textAlign="right";
break;
case"boolean":E.textAlign="center";
break;
}}r(N,H&&H.color||E.color||"#000",E,F);
}}function r(Q,F,E,I){var M=E.left+2;
var N=E.top+2;
var O=E.width-4;
var L=E.height-4;
var H=x(E);
var P={font:H};
var K={font:H,fill:{color:F}};
var J=[],R=0,T=N;
if(E.wrap){w(Q,P,O).forEach(function(V){var W=new p.Text(V.text,[M,T],K);
T+=V.box.height;
J.push({el:W,box:V.box});
});
R=T-N;
}else{var S=new p.Text(Q,[M,T],K);
var D=kendo.util.measureText(Q,P);
J.push({el:S,box:D});
R=D.height;
}var G=new p.Group();
I.append(G);
var U=0;
switch(E.verticalAlign){case"center":U=L-R>>1;
break;
case j:case null:case"bottom":U=L-R;
break;
}if(U<0){U=0;
}J.forEach(function(W){G.append(W.el);
var V=0;
switch(E.textAlign){case"center":V=O-W.box.width>>1;
break;
case"right":V=O-W.box.width;
break;
}if(V<0){V=0;
}if(V||U){W.el.transform(t.Matrix.translate(V,U));
}});
}function w(I,H,J){var E=[];
var D=I.length;
var G=0;
while(G<D){F(G,D,D);
}return E;
function F(N,L,M){var O=I.substring(G,L).trim();
var K=kendo.util.measureText(O,H);
if(K.width<=J){if(L<M-1){F(L,L+M>>1,M);
}else{E.push({text:O,box:K});
G=L;
}}else{if(N<L){F(N,N+L>>1,L);
}}}}function x(D){var E=[];
if(D.italic){E.push("italic");
}if(D.bold){E.push("bold");
}E.push((D.fontSize||12)+"px");
E.push(D.fontFamily||"Arial");
return E.join(" ");
}function n(L,K,G,D){if(G==null&&D==null){D=K;
G={};
K=B.SHEETREF;
}if(D==null){D=G;
if(K instanceof B.Range||K instanceof B.Ref||typeof K=="string"){G={};
}else{G=K;
K=B.SHEETREF;
}}G=kendo.jQuery.extend({paperSize:"A4",landscape:true,margin:"1cm",guidelines:true,emptyCells:true,fitWidth:false,center:false},G);
var E=new p.Group();
var J=kendo.pdf.getPaperOptions(G);
E.options.set("pdf",{author:G.author,creator:G.creator,date:G.date,keywords:G.keywords,margin:J.margin,multiPage:true,paperSize:J.paperSize,subject:G.subject,title:G.title});
var I=J.paperSize[0];
var H=J.paperSize[1];
if(J.margin){I-=J.margin.left+J.margin.right;
H-=J.margin.top+J.margin.bottom;
}G.pageWidth=I;
G.pageHeight=H;
var F=m(L,L._ref(K),G);
q(F,E,G);
D(E);
}B.Sheet.prototype.draw=function(F,E,D){var G=this;
if(G._workbook){G.recalc(G._workbook._context,function(){n(G,F,E,D);
});
}else{n(G,F,E,D);
}};
B.draw={doLayout:m,drawLayout:q,shouldDrawCell:A};
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
(function(l,k){k("kendo.spreadsheet",["util/undoredostack","util/text-metrics","util/parse-xml","kendo.excel","kendo.progressbar","kendo.pdf","spreadsheet/commands","spreadsheet/formulabar","spreadsheet/formulainput","spreadsheet/eventlistener","spreadsheet/rangelist","spreadsheet/propertybag","spreadsheet/references","spreadsheet/navigator","spreadsheet/axismanager","spreadsheet/clipboard","spreadsheet/range","spreadsheet/sheet","spreadsheet/sheetsbar","spreadsheet/excel-reader","spreadsheet/workbook","spreadsheet/formulacontext","spreadsheet/controller","spreadsheet/view","spreadsheet/grid","spreadsheet/axis","spreadsheet/filter","spreadsheet/sorter","spreadsheet/runtime","spreadsheet/calc","spreadsheet/numformat","spreadsheet/runtime.functions","spreadsheet/runtime.functions.2","spreadsheet/toolbar","spreadsheet/dialogs","spreadsheet/sheetbinder","spreadsheet/filtermenu","spreadsheet/editor","spreadsheet/autofill","spreadsheet/print"],l);
}(function(){var k={id:"spreadsheet",name:"Spreadsheet",category:"web",description:"Spreadsheet component",depends:["core","binder","colorpicker","combobox","data","dom","dropdownlist","menu","ooxml","popup","sortable","tabstrip","toolbar","treeview","window","validator","excel","pdf","drawing"]};
(function(p,s){if(p.support.browser.msie&&p.support.browser.version<9){return;
}var l=p.jQuery;
var u=p.ui.Widget;
var v=p.spreadsheet.Workbook;
var o=p.spreadsheet.Controller;
var t=p.spreadsheet.View;
var q=".kendoSpreadsheet";
var m={recalc:true,selection:true,activeCell:true,layout:true,sheetSelection:true,resize:true,editorChange:false,editorClose:false};
var n={wrapper:"k-widget k-spreadsheet"};
var r=p.ui.Widget.extend({init:function(w,x){u.fn.init.call(this,w,x);
this.element.addClass(r.classNames.wrapper);
this._view=new t(this.element,{toolbar:this.options.toolbar,sheetsbar:this.options.sheetsbar});
this._workbook=new v(this.options,this._view);
this._controller=new o(this._view,this._workbook);
this._autoRefresh=true;
this._bindWorkbookEvents();
this._view.workbook(this._workbook);
this.refresh();
this._resizeHandler=function(){this.resize();
}.bind(this);
l(window).on("resize"+q,this._resizeHandler);
},_resize:function(){this.refresh({layout:true});
},_workbookChange:function(w){if(this._autoRefresh){this.refresh(w);
}},activeSheet:function(w){return this._workbook.activeSheet(w);
},moveSheetToIndex:function(x,w){return this._workbook.moveSheetToIndex(x,w);
},insertSheet:function(w){return this._workbook.insertSheet(w);
},sheets:function(){return this._workbook.sheets();
},removeSheet:function(w){return this._workbook.removeSheet(w);
},sheetByName:function(w){return this._workbook.sheetByName(w);
},sheetIndex:function(w){return this._workbook.sheetIndex(w);
},sheetByIndex:function(w){return this._workbook.sheetByIndex(w);
},renameSheet:function(x,w){return this._workbook.renameSheet(x,w);
},refresh:function(w){if(!w){w=m;
}if(!w.editorClose){this._view.sheet(this._workbook.activeSheet());
this._controller.sheet(this._workbook.activeSheet());
this._workbook.refresh(w);
}if(!w.editorChange){this._view.refresh(w);
this._controller.refresh();
this._view.render();
this.trigger("render");
}return this;
},openDialog:function(w,x){return this._view.openDialog(w,x);
},autoRefresh:function(w){if(w!==s){this._autoRefresh=w;
if(w===true){this.refresh();
}return this;
}return this._autoRefresh;
},toJSON:function(){return this._workbook.toJSON();
},fromJSON:function(w){if(w.sheets){this._workbook.destroy();
this._workbook=new v(l.extend({},this.options,w));
this._bindWorkbookEvents();
this._view.workbook(this._workbook);
this._controller.workbook(this._workbook);
this.activeSheet(this.activeSheet());
}else{this.refresh();
}},fromFile:function(w,x){return this._workbook.fromFile(w,x);
},saveAsPDF:function(w){this._workbook.saveAsPDF(l.extend({},this.options.pdf,w,{workbook:this._workbook}));
},saveAsExcel:function(w){this._workbook.saveAsExcel(w);
},draw:function(x,w){this._workbook.draw(x,w);
},_workbookExcelExport:function(w){if(this.trigger("excelExport",w)){w.preventDefault();
}},_workbookExcelImport:function(w){if(this.trigger("excelImport",w)){w.preventDefault();
}else{this._initProgress(w.promise);
}},_initProgress:function(w){var x=l("<div class='k-loading-mask' style='width: 100%; height: 100%; top: 0;'><div class='k-loading-color'/></div>").appendTo(this.element);
var y=l("<div class='k-loading-progress'>").appendTo(x).kendoProgressBar({type:"chunk",chunkCount:10,min:0,max:1,value:0}).data("kendoProgressBar");
w.progress(function(z){y.value(z.progress);
}).always(function(){p.destroy(x);
x.remove();
});
},_workbookPdfExport:function(w){if(this.trigger("pdfExport",w)){w.preventDefault();
}},_bindWorkbookEvents:function(){this._workbook.bind("change",this._workbookChange.bind(this));
this._workbook.bind("excelExport",this._workbookExcelExport.bind(this));
this._workbook.bind("excelImport",this._workbookExcelImport.bind(this));
this._workbook.bind("pdfExport",this._workbookPdfExport.bind(this));
},destroy:function(){p.ui.Widget.fn.destroy.call(this);
this._workbook.destroy();
this._controller.destroy();
this._view.destroy();
if(this._resizeHandler){l(window).off("resize"+q,this._resizeHandler);
}},options:{name:"Spreadsheet",toolbar:true,sheetsbar:true,rows:200,columns:50,rowHeight:20,columnWidth:64,headerHeight:20,headerWidth:32,excel:{proxyURL:"",fileName:"Workbook.xlsx"},pdf:{area:"workbook",fileName:"Workbook.pdf",proxyURL:"",paperSize:"a4",landscape:true,margin:null,title:null,author:null,subject:null,keywords:null,creator:"Kendo UI PDF Generator v."+p.version,date:null}},events:["pdfExport","excelExport","excelImport","render"]});
p.spreadsheet.ALL_REASONS=m;
p.ui.plugin(r);
l.extend(true,r,{classNames:n});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(k,l,m){(m||l)();
}));
window.$=h;
window.jQuery=i;
})($telerik.$,$telerik.$);
window.$=c;
window.jQuery=d;
})($telerik.$,$telerik.$);
